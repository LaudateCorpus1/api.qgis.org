<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QGIS API Documentation: /tmp/buildd/qgis-3.6.0+99unstable/src/core/auth/qgsauthcertutils.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="api_custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QGIS API Documentation
   &#160;<span id="projectnumber">3.6.0-Noosa (5873452)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="dir_fc6e43284f481c1dffff29eff431ce17.html">auth</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">qgsauthcertutils.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="qgsauthcertutils_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">    qgsauthcertutils.cpp</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">    ---------------------</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">    begin                : May 1, 2015</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    copyright            : (C) 2015 by Boundless Spatial, Inc. USA</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">    author               : Larry Shaffer</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">    email                : lshaffer at boundlessgeo dot com</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> ***************************************************************************</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *                                                                         *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   it under the terms of the GNU General Public License as published by  *</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *   (at your option) any later version.                                   *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *                                                                         *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> ***************************************************************************/</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="qgsauthcertutils_8h.html">qgsauthcertutils.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;QColor&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;QDir&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;QFile&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;QObject&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;QSslCertificate&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;QUuid&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="qgsapplication_8h.html">qgsapplication.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="qgsauthmanager_8h.html">qgsauthmanager.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="qgslogger_8h.html">qgslogger.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#ifdef Q_OS_MAC</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;libtasn1.h&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a5cd9c87c780de657dd72ed2886e380e0">   36</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#a5cd9c87c780de657dd72ed2886e380e0">QgsAuthCertUtils::getSslProtocolName</a>( QSsl::SslProtocol protocol )</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">switch</span> ( protocol )</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">case</span> QSsl::SecureProtocols:</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;SecureProtocols&quot;</span> );</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">case</span> QSsl::TlsV1SslV3:</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;TlsV1SslV3&quot;</span> );</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">case</span> QSsl::TlsV1:</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;TlsV1&quot;</span> );</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">case</span> QSsl::SslV3:</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;SslV3&quot;</span> );</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">case</span> QSsl::SslV2:</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;SslV2&quot;</span> );</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordflow">return</span> QString();</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a3c8a249d8342929ac22985e3e844f9c0">   55</a></span>&#160;QMap&lt;QString, QSslCertificate&gt; <a class="code" href="classQgsAuthCertUtils.html#a3c8a249d8342929ac22985e3e844f9c0">QgsAuthCertUtils::mapDigestToCerts</a>( <span class="keyword">const</span> QList&lt;QSslCertificate&gt; &amp;certs )</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  QMap&lt;QString, QSslCertificate&gt; digestmap;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : certs )</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    digestmap.insert( <a class="code" href="classQgsAuthCertUtils.html#a21a2226262fa5b14de308a5a40b750d4">shaHexForCert</a>( cert ), cert );</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">return</span> digestmap;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a152a1d7f76e61d9e9caee9dbe646f107">   65</a></span>&#160;QMap&lt;QString, QList&lt;QSslCertificate&gt; &gt; <a class="code" href="classQgsAuthCertUtils.html#a152a1d7f76e61d9e9caee9dbe646f107">QgsAuthCertUtils::certsGroupedByOrg</a>( <span class="keyword">const</span> QList&lt;QSslCertificate&gt; &amp;certs )</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  QMap&lt; QString, QList&lt;QSslCertificate&gt; &gt; orgcerts;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : certs )</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    QString org( <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( cert, QSslCertificate::Organization ) );</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> ( org.isEmpty() )</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      org = QStringLiteral( <span class="stringliteral">&quot;(Organization not defined)&quot;</span> );</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    QList&lt;QSslCertificate&gt; valist = orgcerts.contains( org ) ? orgcerts.value( org ) : QList&lt;QSslCertificate&gt;();</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    orgcerts.insert( org, valist &lt;&lt; cert );</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">return</span> orgcerts;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#ad50f8df6822e222b43f71cae741b7a85">   79</a></span>&#160;QMap&lt;QString, QgsAuthConfigSslServer&gt; <a class="code" href="classQgsAuthCertUtils.html#ad50f8df6822e222b43f71cae741b7a85">QgsAuthCertUtils::mapDigestToSslConfigs</a>( <span class="keyword">const</span> QList&lt;QgsAuthConfigSslServer&gt; &amp;configs )</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  QMap&lt;QString, QgsAuthConfigSslServer&gt; digestmap;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;config : configs )</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    digestmap.insert( <a class="code" href="classQgsAuthCertUtils.html#a21a2226262fa5b14de308a5a40b750d4">shaHexForCert</a>( config.sslCertificate() ), config );</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">return</span> digestmap;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a7808536527d2af8e162da8c6c382c647">   89</a></span>&#160;QMap&lt;QString, QList&lt;QgsAuthConfigSslServer&gt; &gt; <a class="code" href="classQgsAuthCertUtils.html#a7808536527d2af8e162da8c6c382c647">QgsAuthCertUtils::sslConfigsGroupedByOrg</a>( <span class="keyword">const</span> QList&lt;QgsAuthConfigSslServer&gt; &amp;configs )</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  QMap&lt; QString, QList&lt;QgsAuthConfigSslServer&gt; &gt; orgconfigs;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;config : configs )</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    QString org( <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( config.sslCertificate(), QSslCertificate::Organization ) );</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> ( org.isEmpty() )</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      org = QObject::tr( <span class="stringliteral">&quot;(Organization not defined)&quot;</span> );</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    QList&lt;QgsAuthConfigSslServer&gt; valist = orgconfigs.contains( org ) ? orgconfigs.value( org ) : QList&lt;QgsAuthConfigSslServer&gt;();</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    orgconfigs.insert( org, valist &lt;&lt; config );</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">return</span> orgconfigs;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a084547c0569b050312bff9f72844034f">  104</a></span>&#160;QByteArray <a class="code" href="classQgsAuthCertUtils.html#a084547c0569b050312bff9f72844034f">QgsAuthCertUtils::fileData</a>( <span class="keyword">const</span> QString &amp;path )</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  QByteArray data;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  QFile file( path );</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">if</span> ( !file.exists() )</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Read file error, file not found: %1&quot;</span> ).arg( path ) );</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span> data;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// TODO: add checks for locked file, etc., to ensure it can be read</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  QFile::OpenMode openflags( QIODevice::ReadOnly );</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">bool</span> ret = file.open( openflags );</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">if</span> ( ret )</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    data = file.readAll();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  file.close();</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">return</span> data;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a7a419d79cf4d21caf313a1892c64f74d">  125</a></span>&#160;QList&lt;QSslCertificate&gt; <a class="code" href="classQgsAuthCertUtils.html#a7a419d79cf4d21caf313a1892c64f74d">QgsAuthCertUtils::certsFromFile</a>( <span class="keyword">const</span> QString &amp;certspath )</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  QList&lt;QSslCertificate&gt; certs;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keyword">const</span> QByteArray payload( <a class="code" href="classQgsAuthCertUtils.html#a084547c0569b050312bff9f72844034f">QgsAuthCertUtils::fileData</a>( certspath ) );</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  certs = QSslCertificate::fromData( payload, sniffEncoding( payload ) );</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> ( certs.isEmpty() )</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Parsed cert(s) EMPTY for path: %1&quot;</span> ).arg( certspath ) );</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">return</span> certs;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a9b60d458a0085eb7d3be49e891a28de7">  137</a></span>&#160;QList&lt;QSslCertificate&gt; <a class="code" href="classQgsAuthCertUtils.html#a9b60d458a0085eb7d3be49e891a28de7">QgsAuthCertUtils::casFromFile</a>( <span class="keyword">const</span> QString &amp;certspath )</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  QList&lt;QSslCertificate&gt; cas;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keyword">const</span> QList&lt;QSslCertificate&gt; certs( <a class="code" href="classQgsAuthCertUtils.html#a7a419d79cf4d21caf313a1892c64f74d">certsFromFile</a>( certspath ) );</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : certs )</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classQgsAuthCertUtils.html#a61f6a45ac9651f157bd80bb1fe1e2a4a">certificateIsAuthority</a>( cert ) )</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      cas.append( cert );</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">return</span> cas;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a4aaa3f19c881ed1ee82428b9c2ca6952">  151</a></span>&#160;QList&lt;QSslCertificate&gt; <a class="code" href="classQgsAuthCertUtils.html#a4aaa3f19c881ed1ee82428b9c2ca6952">QgsAuthCertUtils::casMerge</a>( <span class="keyword">const</span> QList&lt;QSslCertificate&gt; &amp;bundle1, <span class="keyword">const</span> QList&lt;QSslCertificate&gt; &amp;bundle2 )</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  QStringList shas;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  QList&lt;QSslCertificate&gt; result( bundle1 );</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keyword">const</span> QList&lt;QSslCertificate&gt; c_bundle1( bundle1 );</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : c_bundle1 )</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    shas.append( <a class="code" href="classQgsAuthCertUtils.html#a21a2226262fa5b14de308a5a40b750d4">shaHexForCert</a>( cert ) );</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keyword">const</span> QList&lt;QSslCertificate&gt; c_bundle2( bundle2 );</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : c_bundle2 )</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span> ( ! shas.contains( <a class="code" href="classQgsAuthCertUtils.html#a21a2226262fa5b14de308a5a40b750d4">shaHexForCert</a>( cert ) ) )</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      result.append( cert );</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a2781a4ccfc51cbb78353405dc838e344">  173</a></span>&#160;QSslCertificate <a class="code" href="classQgsAuthCertUtils.html#a2781a4ccfc51cbb78353405dc838e344">QgsAuthCertUtils::certFromFile</a>( <span class="keyword">const</span> QString &amp;certpath )</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  QSslCertificate cert;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  QList&lt;QSslCertificate&gt; certs( <a class="code" href="classQgsAuthCertUtils.html#a7a419d79cf4d21caf313a1892c64f74d">QgsAuthCertUtils::certsFromFile</a>( certpath ) );</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">if</span> ( !certs.isEmpty() )</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    cert = certs.first();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">if</span> ( cert.isNull() )</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Parsed cert is NULL for path: %1&quot;</span> ).arg( certpath ) );</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">return</span> cert;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a95a831125902ad0426a60ca9c2e0cb59">  188</a></span>&#160;QSslKey <a class="code" href="classQgsAuthCertUtils.html#a95a831125902ad0426a60ca9c2e0cb59">QgsAuthCertUtils::keyFromFile</a>( <span class="keyword">const</span> QString &amp;keypath,</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                       <span class="keyword">const</span> QString &amp;keypass,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                       QString *algtype )</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// The approach here is to try all possible encodings and algorithms</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  QByteArray keydata( <a class="code" href="classQgsAuthCertUtils.html#a084547c0569b050312bff9f72844034f">QgsAuthCertUtils::fileData</a>( keypath ) );</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  QSslKey clientkey;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  QSsl::EncodingFormat keyEncoding( sniffEncoding( keydata ) );</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keyword">const</span> std::vector&lt;QSsl::KeyAlgorithm&gt; algs</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    QSsl::KeyAlgorithm::Rsa,</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    QSsl::KeyAlgorithm::Dsa,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    QSsl::KeyAlgorithm::Ec,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    QSsl::KeyAlgorithm::Opaque</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  };</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;alg : algs )</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    clientkey = QSslKey( keydata,</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                         alg,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                         keyEncoding,</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                         QSsl::PrivateKey,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                         !keypass.isEmpty() ? keypass.toUtf8() : QByteArray() );</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span> ( ! clientkey.isNull() )</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">if</span> ( algtype )</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">switch</span> ( alg )</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="keywordflow">case</span> QSsl::KeyAlgorithm::Rsa:</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            *algtype = QStringLiteral( <span class="stringliteral">&quot;rsa&quot;</span> );</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <span class="keywordflow">case</span> QSsl::KeyAlgorithm::Dsa:</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            *algtype = QStringLiteral( <span class="stringliteral">&quot;dsa&quot;</span> );</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          <span class="keywordflow">case</span> QSsl::KeyAlgorithm::Ec:</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            *algtype = QStringLiteral( <span class="stringliteral">&quot;ec&quot;</span> );</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          <span class="keywordflow">case</span> QSsl::KeyAlgorithm::Opaque:</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            *algtype = QStringLiteral( <span class="stringliteral">&quot;opaque&quot;</span> );</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">return</span> clientkey;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">return</span> QSslKey();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a9c3cbaccac44ffd7883a500ebf7c845b">  239</a></span>&#160;QList&lt;QSslCertificate&gt; <a class="code" href="classQgsAuthCertUtils.html#a9c3cbaccac44ffd7883a500ebf7c845b">QgsAuthCertUtils::certsFromString</a>( <span class="keyword">const</span> QString &amp;pemtext )</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;{</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  QList&lt;QSslCertificate&gt; certs;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  certs = QSslCertificate::fromData( pemtext.toLatin1(), QSsl::Pem );</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">if</span> ( certs.isEmpty() )</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Parsed cert(s) EMPTY&quot;</span> ) );</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">return</span> certs;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a80db11dd909408dac031a3e6db84cca9">  250</a></span>&#160;QList&lt;QSslCertificate&gt; <a class="code" href="classQgsAuthCertUtils.html#a80db11dd909408dac031a3e6db84cca9">QgsAuthCertUtils::casRemoveSelfSigned</a>( <span class="keyword">const</span> QList&lt;QSslCertificate&gt; &amp;caList )</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  QList&lt;QSslCertificate&gt; certs;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : caList )</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> ( ! cert.isSelfSigned( ) )</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      certs.append( cert );</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">return</span> certs;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a6006a28b31c4ae2f2f58a8727dea79d4">  263</a></span>&#160;QStringList <a class="code" href="classQgsAuthCertUtils.html#a6006a28b31c4ae2f2f58a8727dea79d4">QgsAuthCertUtils::certKeyBundleToPem</a>( <span class="keyword">const</span> QString &amp;certpath,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">const</span> QString &amp;keypath,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keyword">const</span> QString &amp;keypass,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">bool</span> reencrypt )</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  QString certpem;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  QSslCertificate clientcert = <a class="code" href="classQgsAuthCertUtils.html#a2781a4ccfc51cbb78353405dc838e344">QgsAuthCertUtils::certFromFile</a>( certpath );</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span> ( !clientcert.isNull() )</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    certpem = QString( clientcert.toPem() );</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  QString keypem;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  QString algtype;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  QSslKey clientkey = <a class="code" href="classQgsAuthCertUtils.html#a95a831125902ad0426a60ca9c2e0cb59">QgsAuthCertUtils::keyFromFile</a>( keypath, keypass, &amp;algtype );</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// reapply passphrase if protection is requested and passphrase exists</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">if</span> ( !clientkey.isNull() )</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    keypem = QString( clientkey.toPem( ( reencrypt &amp;&amp; !keypass.isEmpty() ) ? keypass.toUtf8() : QByteArray() ) );</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">return</span> QStringList() &lt;&lt; certpem &lt;&lt; keypem &lt;&lt; algtype;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#acf87e6e1bf6812600bf2e7041a7cb96e">  288</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classQgsAuthCertUtils.html#acf87e6e1bf6812600bf2e7041a7cb96e">QgsAuthCertUtils::pemIsPkcs8</a>( <span class="keyword">const</span> QString &amp;keyPemTxt )</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  QString pkcs8Header = QStringLiteral( <span class="stringliteral">&quot;-----BEGIN PRIVATE KEY-----&quot;</span> );</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  QString pkcs8Footer = QStringLiteral( <span class="stringliteral">&quot;-----END PRIVATE KEY-----&quot;</span> );</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">return</span> keyPemTxt.contains( pkcs8Header ) &amp;&amp; keyPemTxt.contains( pkcs8Footer );</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#ifdef Q_OS_MAC</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;QByteArray QgsAuthCertUtils::pkcs8PrivateKey( QByteArray &amp;pkcs8Der )</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  QByteArray pkcs1;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">if</span> ( pkcs8Der.isEmpty() )</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, passed DER is empty&quot;</span> ) );</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">return</span> pkcs1;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// Dump as unarmored PEM format, e.g. missing &#39;-----BEGIN|END...&#39; wrapper</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">//QgsDebugMsg ( QStringLiteral( &quot;pkcs8Der: %1&quot; ).arg( QString( pkcs8Der.toBase64() ) ) );</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  QFileInfo asnDefsRsrc( <a class="code" href="classQgsApplication.html#a54c2585a8214bc2031f0e11e6b88445a">QgsApplication::pkgDataPath</a>() + QStringLiteral( <span class="stringliteral">&quot;/resources/pkcs8.asn&quot;</span> ) );</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">if</span> ( ! asnDefsRsrc.exists() )</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, pkcs.asn resource file not found: %1&quot;</span> ).arg( asnDefsRsrc.filePath() ) );</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> pkcs1;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *asnDefsFile = asnDefsRsrc.absoluteFilePath().toLocal8Bit().constData();</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordtype">int</span> asn1_result = ASN1_SUCCESS, der_len = 0, oct_len = 0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  asn1_node definitions = NULL, structure = NULL;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordtype">char</span> errorDescription[ASN1_MAX_ERROR_DESCRIPTION_SIZE], oct_data[1024];</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *der = NULL;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags = 0; <span class="comment">//TODO: see if any or all ASN1_DECODE_FLAG_* flags can be set</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordtype">unsigned</span> oct_etype;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// Base PKCS#8 element to decode</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  QString <a class="code" href="qgswfsgetfeature_8cpp.html#a91798216200b925186e1bf0e7fcb201b">typeName</a>( QStringLiteral( <span class="stringliteral">&quot;PKCS-8.PrivateKeyInfo&quot;</span> ) );</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  asn1_result = asn1_parser2tree( asnDefsFile, &amp;definitions, errorDescription );</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">switch</span> ( asn1_result )</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">case</span> ASN1_SUCCESS:</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <a class="code" href="qgslogger_8h.html#a795a1fcfb1c61b988bbd999396411d13">QgsDebugMsgLevel</a>( QStringLiteral( <span class="stringliteral">&quot;Parse: done.\n&quot;</span> ), 4 );</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">case</span> ASN1_FILE_NOT_FOUND:</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, file not found: %1&quot;</span> ).arg( asnDefsFile ) );</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">return</span> pkcs1;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">case</span> ASN1_SYNTAX_ERROR:</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">case</span> ASN1_IDENTIFIER_NOT_FOUND:</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">case</span> ASN1_NAME_TOO_LONG:</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, asn1 parsing: %1&quot;</span> ).arg( errorDescription ) );</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">return</span> pkcs1;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, libtasn1: %1&quot;</span> ).arg( asn1_strerror( asn1_result ) ) );</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">return</span> pkcs1;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// Generate the ASN.1 structure</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  asn1_result = asn1_create_element( definitions, typeName.toLatin1().constData(), &amp;structure );</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">//asn1_print_structure( stdout, structure, &quot;&quot;, ASN1_PRINT_ALL);</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span> ( asn1_result != ASN1_SUCCESS )</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, structure creation: %1&quot;</span> ).arg( asn1_strerror( asn1_result ) ) );</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">goto</span> PKCS1DONE;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// Populate the ASN.1 structure with decoded DER data</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  der = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<span class="keyword">&gt;</span>( pkcs8Der.data() );</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  der_len = pkcs8Der.size();</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">if</span> ( flags != 0 )</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    asn1_result = asn1_der_decoding2( &amp;structure, der, &amp;der_len, flags, errorDescription );</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    asn1_result = asn1_der_decoding( &amp;structure, der, der_len, errorDescription );</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">if</span> ( asn1_result != ASN1_SUCCESS )</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, decoding: %1&quot;</span> ).arg( errorDescription ) );</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">goto</span> PKCS1DONE;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  {</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="qgslogger_8h.html#a795a1fcfb1c61b988bbd999396411d13">QgsDebugMsgLevel</a>( QStringLiteral( <span class="stringliteral">&quot;Decoding: %1&quot;</span> ).arg( asn1_strerror( asn1_result ) ), 4 );</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classQgsLogger.html#add89cf855ccb0bac5c783157f810bea8">QgsLogger::debugLevel</a>() &gt;= 4 )</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;DECODING RESULT:&quot;</span> ) );</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    asn1_print_structure( stdout, structure, <span class="stringliteral">&quot;&quot;</span>, ASN1_PRINT_NAME_TYPE_VALUE );</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// Validate and extract privateKey value</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="qgslogger_8h.html#a795a1fcfb1c61b988bbd999396411d13">QgsDebugMsgLevel</a>( QStringLiteral( <span class="stringliteral">&quot;Validating privateKey type...&quot;</span> ), 4 );</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  typeName.append( QStringLiteral( <span class="stringliteral">&quot;.privateKey&quot;</span> ) );</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="qgslogger_8h.html#a795a1fcfb1c61b988bbd999396411d13">QgsDebugMsgLevel</a>( QStringLiteral( <span class="stringliteral">&quot;privateKey element name: %1&quot;</span> ).arg( typeName ), 4 );</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  asn1_result = asn1_read_value_type( structure, <span class="stringliteral">&quot;privateKey&quot;</span>, NULL, &amp;oct_len, &amp;oct_etype );</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span> ( asn1_result != ASN1_MEM_ERROR ) <span class="comment">// not sure why ASN1_MEM_ERROR = success, but it does</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, asn1 read privateKey value type: %1&quot;</span> ).arg( asn1_strerror( asn1_result ) ) );</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">goto</span> PKCS1DONE;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">if</span> ( oct_etype != ASN1_ETYPE_OCTET_STRING )</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, asn1 privateKey value not octet string, but type: %1&quot;</span> ).arg( static_cast&lt;int&gt;( oct_etype ) ) );</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">goto</span> PKCS1DONE;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span> ( oct_len == 0 )</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, asn1 privateKey octet string empty&quot;</span> ) );</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">goto</span> PKCS1DONE;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="qgslogger_8h.html#a795a1fcfb1c61b988bbd999396411d13">QgsDebugMsgLevel</a>( QStringLiteral( <span class="stringliteral">&quot;Reading privateKey value...&quot;</span> ), 4 );</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  asn1_result = asn1_read_value( structure, <span class="stringliteral">&quot;privateKey&quot;</span>, oct_data, &amp;oct_len );</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">if</span> ( asn1_result != ASN1_SUCCESS )</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, asn1 read privateKey value: %1&quot;</span> ).arg( asn1_strerror( asn1_result ) ) );</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">goto</span> PKCS1DONE;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span> ( oct_len == 0 )</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;ERROR, asn1 privateKey value octet string empty&quot;</span> ) );</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">goto</span> PKCS1DONE;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  pkcs1 = QByteArray( oct_data, oct_len );</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// !!! SENSITIVE DATA - DO NOT LEAVE UNCOMMENTED !!!</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">//QgsDebugMsgLevel( QStringLiteral( &quot;privateKey octet data as PEM: %1&quot; ).arg( QString( pkcs1.toBase64() ) ), 4 );</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;PKCS1DONE:</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  asn1_delete_structure( &amp;structure );</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">return</span> pkcs1;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a72937c0e1b2bcb20e04c6a9ec49a4366">  438</a></span>&#160;QStringList <a class="code" href="classQgsAuthCertUtils.html#a72937c0e1b2bcb20e04c6a9ec49a4366">QgsAuthCertUtils::pkcs12BundleToPem</a>( <span class="keyword">const</span> QString &amp;bundlepath,</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keyword">const</span> QString &amp;bundlepass,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordtype">bool</span> reencrypt )</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;{</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  QStringList empty;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="keywordflow">if</span> ( !QCA::isSupported( <span class="stringliteral">&quot;pkcs12&quot;</span> ) )</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;QCA does not support PKCS#12&quot;</span> ) );</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">return</span> empty;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  QCA::KeyBundle bundle( <a class="code" href="classQgsAuthCertUtils.html#acb480f364903aba53ecee7f17571defc">QgsAuthCertUtils::qcaKeyBundle</a>( bundlepath, bundlepass ) );</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">if</span> ( bundle.isNull() )</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;FAILED to convert PKCS#12 file to QCA key bundle: %1&quot;</span> ).arg( bundlepath ) );</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> empty;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  QCA::SecureArray passarray;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">if</span> ( reencrypt &amp;&amp; !bundlepass.isEmpty() )</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    passarray = QCA::SecureArray( bundlepass.toUtf8() );</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  QString algtype;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  QSsl::KeyAlgorithm keyalg = QSsl::Opaque;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">if</span> ( bundle.privateKey().isRSA() )</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    algtype = QStringLiteral( <span class="stringliteral">&quot;rsa&quot;</span> );</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    keyalg = QSsl::Rsa;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bundle.privateKey().isDSA() )</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    algtype = QStringLiteral( <span class="stringliteral">&quot;dsa&quot;</span> );</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    keyalg = QSsl::Dsa;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bundle.privateKey().isDH() )</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    algtype = QStringLiteral( <span class="stringliteral">&quot;dh&quot;</span> );</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">// TODO: add support for EC keys, once QCA supports them</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// can currently only support RSA and DSA between QCA and Qt</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">if</span> ( keyalg == QSsl::Opaque )</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;FAILED to read PKCS#12 key (only RSA and DSA algorithms supported): %1&quot;</span> ).arg( bundlepath ) );</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">return</span> empty;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  QString keyPem;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="preprocessor">#ifdef Q_OS_MAC</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">if</span> ( keyalg == QSsl::Rsa &amp;&amp; <a class="code" href="classQgsAuthCertUtils.html#acf87e6e1bf6812600bf2e7041a7cb96e">QgsAuthCertUtils::pemIsPkcs8</a>( bundle.privateKey().toPEM() ) )</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="qgslogger_8h.html#a795a1fcfb1c61b988bbd999396411d13">QgsDebugMsgLevel</a>( QStringLiteral( <span class="stringliteral">&quot;Private key is PKCS#8: attempting conversion to PKCS#1...&quot;</span> ), 4 );</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// if RSA, convert from PKCS#8 key to &#39;traditional&#39; OpenSSL RSA format, which Qt prefers</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// note: QCA uses OpenSSL, regardless of the Qt SSL backend, and 1.0.2+ OpenSSL versions return</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">//       RSA private keys as PKCS#8, which choke Qt upon QSslKey creation</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    QByteArray pkcs8Der = bundle.privateKey().toDER().toByteArray();</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> ( pkcs8Der.isEmpty() )</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;FAILED to convert PKCS#12 key to DER-encoded format: %1&quot;</span> ).arg( bundlepath ) );</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordflow">return</span> empty;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    QByteArray pkcs1Der = QgsAuthCertUtils::pkcs8PrivateKey( pkcs8Der );</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">if</span> ( pkcs1Der.isEmpty() )</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;FAILED to convert PKCS#12 key from PKCS#8 to PKCS#1: %1&quot;</span> ).arg( bundlepath ) );</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">return</span> empty;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    QSslKey pkcs1Key( pkcs1Der, QSsl::Rsa, QSsl::Der, QSsl::PrivateKey );</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span> ( pkcs1Key.isNull() )</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;FAILED to convert PKCS#12 key from PKCS#8 to PKCS#1 QSslKey: %1&quot;</span> ).arg( bundlepath ) );</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">return</span> empty;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    keyPem = QString( pkcs1Key.toPem( passarray.toByteArray() ) );</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    keyPem = bundle.privateKey().toPEM( passarray );</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  keyPem = bundle.privateKey().toPEM( passarray );</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <a class="code" href="qgslogger_8h.html#a795a1fcfb1c61b988bbd999396411d13">QgsDebugMsgLevel</a>( QStringLiteral( <span class="stringliteral">&quot;PKCS#12 cert as PEM:\n%1&quot;</span> ).arg( QString( bundle.certificateChain().primary().toPEM() ) ), 4 );</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// !!! SENSITIVE DATA - DO NOT LEAVE UNCOMMENTED !!!</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">//QgsDebugMsgLevel( QStringLiteral( &quot;PKCS#12 key as PEM:\n%1&quot; ).arg( QString( keyPem ) ), 4 );</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">return</span> QStringList() &lt;&lt; bundle.certificateChain().primary().toPEM() &lt;&lt; keyPem &lt;&lt; algtype;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#ac1d183ba837ef614b379985f0dde7d88">  533</a></span>&#160;QList&lt;QSslCertificate&gt; <a class="code" href="classQgsAuthCertUtils.html#ac1d183ba837ef614b379985f0dde7d88">QgsAuthCertUtils::pkcs12BundleCas</a>( <span class="keyword">const</span> QString &amp;bundlepath, <span class="keyword">const</span> QString &amp;bundlepass )</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;{</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  QList&lt;QSslCertificate&gt; result;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">if</span> ( !QCA::isSupported( <span class="stringliteral">&quot;pkcs12&quot;</span> ) )</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  QCA::KeyBundle bundle( <a class="code" href="classQgsAuthCertUtils.html#acb480f364903aba53ecee7f17571defc">QgsAuthCertUtils::qcaKeyBundle</a>( bundlepath, bundlepass ) );</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordflow">if</span> ( bundle.isNull() )</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keyword">const</span> QCA::CertificateChain chain( bundle.certificateChain() );</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : chain )</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">if</span> ( cert.isCA( ) )</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      result.append( QSslCertificate::fromData( cert.toPEM().toAscii() ) );</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;}</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a5a9589a5cfc3f8578a5c5ed10a6e30e1">  554</a></span>&#160;QByteArray <a class="code" href="classQgsAuthCertUtils.html#a5a9589a5cfc3f8578a5c5ed10a6e30e1">QgsAuthCertUtils::certsToPemText</a>( <span class="keyword">const</span> QList&lt;QSslCertificate&gt; &amp;certs )</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;{</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  QByteArray capem;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordflow">if</span> ( !certs.isEmpty() )</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    QStringList certslist;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : certs )</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      certslist &lt;&lt; cert.toPem();</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    capem = certslist.join( QStringLiteral( <span class="stringliteral">&quot;\n&quot;</span> ) ).toLatin1(); <span class="comment">//+ &quot;\n&quot;;</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">return</span> capem;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;}</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#ace4ce0331465828e8eb0e8099affb06c">  569</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#ace4ce0331465828e8eb0e8099affb06c">QgsAuthCertUtils::pemTextToTempFile</a>( <span class="keyword">const</span> QString &amp;name, <span class="keyword">const</span> QByteArray &amp;pemtext )</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;{</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  QFile pemFile( QDir::tempPath() + QDir::separator() + name );</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  QString pemFilePath( pemFile.fileName() );</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">if</span> ( pemFile.open( QIODevice::WriteOnly | QIODevice::Truncate ) )</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    qint64 bytesWritten = pemFile.write( pemtext );</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">if</span> ( bytesWritten == -1 )</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;FAILED to write to temp PEM file: %1&quot;</span> ).arg( pemFilePath ) );</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      pemFilePath.clear();</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;FAILED to open writing for temp PEM file: %1&quot;</span> ).arg( pemFilePath ) );</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    pemFilePath.clear();</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">if</span> ( !pemFile.setPermissions( QFile::ReadUser ) )</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;FAILED to set permissions on temp PEM file: %1&quot;</span> ).arg( pemFilePath ) );</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    pemFilePath.clear();</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">return</span> pemFilePath;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;}</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#accfcb812574b479ee8f20cb0c8fbe009">  598</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#accfcb812574b479ee8f20cb0c8fbe009">QgsAuthCertUtils::getCaSourceName</a>( <a class="code" href="classQgsAuthCertUtils.html#abe90cccf324e3bd5c7f81691140375dd">QgsAuthCertUtils::CaCertSource</a> source, <span class="keywordtype">bool</span> single )</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;{</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">switch</span> ( source )</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#abe90cccf324e3bd5c7f81691140375ddad49c8b852dcd6bbec85e73466f91766f">SystemRoot</a>:</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keywordflow">return</span> single ? QObject::tr( <span class="stringliteral">&quot;System Root CA&quot;</span> ) : QObject::tr( <span class="stringliteral">&quot;System Root Authorities&quot;</span> );</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#abe90cccf324e3bd5c7f81691140375ddaf93573fbac9d47ce86174add2d629d5e">FromFile</a>:</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordflow">return</span> single ? QObject::tr( <span class="stringliteral">&quot;File CA&quot;</span> ) : QObject::tr( <span class="stringliteral">&quot;Authorities from File&quot;</span> );</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#abe90cccf324e3bd5c7f81691140375dda52c86bb5a8080b0c9263e473b7d9a888">InDatabase</a>:</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordflow">return</span> single ? QObject::tr( <span class="stringliteral">&quot;Database CA&quot;</span> ) : QObject::tr( <span class="stringliteral">&quot;Authorities in Database&quot;</span> );</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#abe90cccf324e3bd5c7f81691140375dda03a78a0213b569f008f3ba913a6c9194">Connection</a>:</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">return</span> single ? QObject::tr( <span class="stringliteral">&quot;Connection CA&quot;</span> ) : QObject::tr( <span class="stringliteral">&quot;Authorities from connection&quot;</span> );</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keywordflow">return</span> QString();</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;}</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a11e1b2b2c9538948503b70a23bc313dc">  615</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#a11e1b2b2c9538948503b70a23bc313dc">QgsAuthCertUtils::resolvedCertName</a>( <span class="keyword">const</span> QSslCertificate &amp;cert, <span class="keywordtype">bool</span> issuer )</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;{</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  QString name( issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( cert, QSslCertificate::CommonName )</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( cert, QSslCertificate::CommonName ) );</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">if</span> ( name.isEmpty() )</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    name = issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( cert, QSslCertificate::OrganizationalUnitName )</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;           : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( cert, QSslCertificate::OrganizationalUnitName );</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">if</span> ( name.isEmpty() )</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    name = issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( cert, QSslCertificate::Organization )</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;           : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( cert, QSslCertificate::Organization );</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">if</span> ( name.isEmpty() )</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    name = issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( cert, QSslCertificate::LocalityName )</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;           : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( cert, QSslCertificate::LocalityName );</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">if</span> ( name.isEmpty() )</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    name = issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( cert, QSslCertificate::StateOrProvinceName )</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;           : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( cert, QSslCertificate::StateOrProvinceName );</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">if</span> ( name.isEmpty() )</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    name = issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( cert, QSslCertificate::CountryName )</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;           : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( cert, QSslCertificate::CountryName );</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordflow">return</span> name;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;}</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">// private</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordtype">void</span> QgsAuthCertUtils::appendDirSegment_( QStringList &amp;dirname,</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keyword">const</span> QString &amp;segment, QString value )</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;{</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">if</span> ( !value.isEmpty() )</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    dirname.append( segment + <span class="charliteral">&#39;=&#39;</span> + value.replace( <span class="charliteral">&#39;,&#39;</span>, QLatin1String( <span class="stringliteral">&quot;\\,&quot;</span> ) ) );</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;}</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;QSsl::EncodingFormat QgsAuthCertUtils::sniffEncoding( <span class="keyword">const</span> QByteArray &amp;payload )</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;{</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordflow">return</span> payload.contains( QByteArrayLiteral( <span class="stringliteral">&quot;-----BEGIN &quot;</span> ) ) ?</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;         QSsl::Pem :</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;         QSsl::Der;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#af489448758b237628cf0a67c427ed03c">  660</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#af489448758b237628cf0a67c427ed03c">QgsAuthCertUtils::getCertDistinguishedName</a>( <span class="keyword">const</span> QSslCertificate &amp;qcert,</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keyword">const</span> QCA::Certificate &amp;acert,</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordtype">bool</span> issuer )</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;{</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classQgsApplication.html#aa879f2f9f0d9d79f1d7968cc0f1b9a6a">QgsApplication::authManager</a>()-&gt;isDisabled() )</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">return</span> QString();</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordflow">if</span> ( acert.isNull() )</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    QCA::ConvertResult res;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    QCA::Certificate acert( QCA::Certificate::fromPEM( qcert.toPem(), &amp;res, QStringLiteral( <span class="stringliteral">&quot;qca-ossl&quot;</span> ) ) );</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span> ( res != QCA::ConvertGood || acert.isNull() )</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Certificate could not be converted to QCA cert&quot;</span> ) );</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordflow">return</span> QString();</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  }</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">//  E=testcert@boundlessgeo.com,</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="comment">//  CN=Boundless Test Root CA,</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="comment">//  OU=Certificate Authority,</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="comment">//  O=Boundless Test CA,</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="comment">//  L=District of Columbia,</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="comment">//  ST=Washington\, DC,</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="comment">//  C=US</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  QStringList dirname;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  QgsAuthCertUtils::appendDirSegment_(</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    dirname, QStringLiteral( <span class="stringliteral">&quot;E&quot;</span> ), issuer ? acert.issuerInfo().value( QCA::Email )</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    : acert.subjectInfo().value( QCA::Email ) );</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  QgsAuthCertUtils::appendDirSegment_(</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    dirname, QStringLiteral( <span class="stringliteral">&quot;CN&quot;</span> ), issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( qcert, QSslCertificate::CommonName )</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( qcert, QSslCertificate::CommonName ) );</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  QgsAuthCertUtils::appendDirSegment_(</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    dirname, QStringLiteral( <span class="stringliteral">&quot;OU&quot;</span> ), issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( qcert, QSslCertificate::OrganizationalUnitName )</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( qcert, QSslCertificate::OrganizationalUnitName ) );</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  QgsAuthCertUtils::appendDirSegment_(</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    dirname, QStringLiteral( <span class="stringliteral">&quot;O&quot;</span> ), issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( qcert, QSslCertificate::Organization )</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( qcert, QSslCertificate::Organization ) );</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  QgsAuthCertUtils::appendDirSegment_(</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    dirname, QStringLiteral( <span class="stringliteral">&quot;L&quot;</span> ), issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( qcert, QSslCertificate::LocalityName )</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( qcert, QSslCertificate::LocalityName ) );</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  QgsAuthCertUtils::appendDirSegment_(</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    dirname, QStringLiteral( <span class="stringliteral">&quot;ST&quot;</span> ), issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( qcert, QSslCertificate::StateOrProvinceName )</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( qcert, QSslCertificate::StateOrProvinceName ) );</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  QgsAuthCertUtils::appendDirSegment_(</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    dirname, QStringLiteral( <span class="stringliteral">&quot;C&quot;</span> ), issuer ? <a class="code" href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a>( qcert, QSslCertificate::CountryName )</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    : <a class="code" href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a>( qcert, QSslCertificate::CountryName ) );</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordflow">return</span> dirname.join( QStringLiteral( <span class="stringliteral">&quot;,&quot;</span> ) );</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;}</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a1ea0bce656b5c6e5978a967ed201c765">  710</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#a1ea0bce656b5c6e5978a967ed201c765">QgsAuthCertUtils::getCertTrustName</a>( <a class="code" href="classQgsAuthCertUtils.html#a245baf0d84d532415adba1518bff7371">QgsAuthCertUtils::CertTrustPolicy</a> trust )</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;{</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordflow">switch</span> ( trust )</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#a245baf0d84d532415adba1518bff7371acdfae79e764aa28175aba1af1c813a44">DefaultTrust</a>:</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Default&quot;</span> );</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#a245baf0d84d532415adba1518bff7371a61ab01103aee838ab3df35b0d56f547c">Trusted</a>:</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Trusted&quot;</span> );</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#a245baf0d84d532415adba1518bff7371a1eb7b3429862d0c79080d69445b30acb">Untrusted</a>:</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Untrusted&quot;</span> );</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">return</span> QString();</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;}</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a61767370e1d5d5a2e87193aecc16d9aa">  725</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#a61767370e1d5d5a2e87193aecc16d9aa">QgsAuthCertUtils::getColonDelimited</a>( <span class="keyword">const</span> QString &amp;txt )</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;{</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="comment">// 64321c05b0ebab8e2b67ec0d7d9e2b6d4bc3c303</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="comment">//   -&gt; 64:32:1c:05:b0:eb:ab:8e:2b:67:ec:0d:7d:9e:2b:6d:4b:c3:c3:03</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  QStringList sl;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  sl.reserve( txt.size() );</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; txt.size(); i += 2 )</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    sl &lt;&lt; txt.mid( i, ( i + 2 &gt; txt.size() ) ? -1 : 2 );</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  }</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordflow">return</span> sl.join( QStringLiteral( <span class="stringliteral">&quot;:&quot;</span> ) );</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;}</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a21a2226262fa5b14de308a5a40b750d4">  738</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#a21a2226262fa5b14de308a5a40b750d4">QgsAuthCertUtils::shaHexForCert</a>( <span class="keyword">const</span> QSslCertificate &amp;cert, <span class="keywordtype">bool</span> formatted )</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;{</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  QString sha( cert.digest( QCryptographicHash::Sha1 ).toHex() );</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">if</span> ( formatted )</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classQgsAuthCertUtils.html#a61767370e1d5d5a2e87193aecc16d9aa">QgsAuthCertUtils::getColonDelimited</a>( sha );</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="keywordflow">return</span> sha;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;}</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a12b78fe6f22c96790e3b20c357d46168">  748</a></span>&#160;QCA::Certificate <a class="code" href="classQgsAuthCertUtils.html#a12b78fe6f22c96790e3b20c357d46168">QgsAuthCertUtils::qtCertToQcaCert</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;{</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classQgsApplication.html#aa879f2f9f0d9d79f1d7968cc0f1b9a6a">QgsApplication::authManager</a>()-&gt;isDisabled() )</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">return</span> QCA::Certificate();</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  QCA::ConvertResult res;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  QCA::Certificate qcacert( QCA::Certificate::fromPEM( cert.toPem(), &amp;res, QStringLiteral( <span class="stringliteral">&quot;qca-ossl&quot;</span> ) ) );</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">if</span> ( res != QCA::ConvertGood || qcacert.isNull() )</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Certificate could not be converted to QCA cert&quot;</span> ) );</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    qcacert = QCA::Certificate();</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">return</span> qcacert;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;}</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a21dca118cb02e62a12ea6dd06e5f7d77">  763</a></span>&#160;QCA::CertificateCollection <a class="code" href="classQgsAuthCertUtils.html#a21dca118cb02e62a12ea6dd06e5f7d77">QgsAuthCertUtils::qtCertsToQcaCollection</a>( <span class="keyword">const</span> QList&lt;QSslCertificate&gt; &amp;certs )</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;{</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  QCA::CertificateCollection qcacoll;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classQgsApplication.html#aa879f2f9f0d9d79f1d7968cc0f1b9a6a">QgsApplication::authManager</a>()-&gt;isDisabled() )</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">return</span> qcacoll;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : certs )</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    QCA::Certificate qcacert( <a class="code" href="classQgsAuthCertUtils.html#a12b78fe6f22c96790e3b20c357d46168">qtCertToQcaCert</a>( cert ) );</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">if</span> ( !qcacert.isNull() )</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      qcacoll.addCertificate( qcacert );</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    }</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  }</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordflow">return</span> qcacoll;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;}</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#acb480f364903aba53ecee7f17571defc">  780</a></span>&#160;QCA::KeyBundle <a class="code" href="classQgsAuthCertUtils.html#acb480f364903aba53ecee7f17571defc">QgsAuthCertUtils::qcaKeyBundle</a>( <span class="keyword">const</span> QString &amp;path, <span class="keyword">const</span> QString &amp;pass )</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;{</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  QCA::SecureArray passarray;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">if</span> ( !pass.isEmpty() )</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    passarray = QCA::SecureArray( pass.toUtf8() );</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  QCA::ConvertResult res;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  QCA::KeyBundle bundle( QCA::KeyBundle::fromFile( path, passarray, &amp;res, QStringLiteral( <span class="stringliteral">&quot;qca-ossl&quot;</span> ) ) );</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">return</span> ( res == QCA::ConvertGood ? bundle : QCA::KeyBundle() );</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;}</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a0368f502332634f4b27e0967738a0705">  792</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#a0368f502332634f4b27e0967738a0705">QgsAuthCertUtils::qcaValidityMessage</a>( QCA::Validity validity )</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;{</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordflow">switch</span> ( validity )</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">case</span> QCA::ValidityGood:</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate is valid.&quot;</span> );</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorRejected:</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Root CA rejected the certificate purpose.&quot;</span> );</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorUntrusted:</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate is not trusted.&quot;</span> );</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorSignatureFailed:</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Signature does not match.&quot;</span> );</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorInvalidCA:</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Authority is invalid or not found.&quot;</span> );</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorInvalidPurpose:</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Purpose does not match the intended usage.&quot;</span> );</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorSelfSigned:</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate is self-signed, and is not found in the list of trusted certificates.&quot;</span> );</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorRevoked:</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate has been revoked.&quot;</span> );</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorPathLengthExceeded:</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Path length from the root CA to this certificate is too long.&quot;</span> );</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorExpired:</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate has expired or is not yet valid.&quot;</span> );</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorExpiredCA:</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Authority has expired.&quot;</span> );</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">case</span> QCA::ErrorValidityUnknown:</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Validity is unknown.&quot;</span> );</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="keywordflow">return</span> QString();</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;}</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a11d4fbb80afe731d222e7184a8b61015">  825</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#a11d4fbb80afe731d222e7184a8b61015">QgsAuthCertUtils::qcaSignatureAlgorithm</a>( QCA::SignatureAlgorithm <a class="code" href="porting__processing_8dox.html#a2363590aeaf7c1e254a233e7d840ae29">algorithm</a> )</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;{</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">switch</span> ( algorithm )</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">case</span> QCA::EMSA1_SHA1:</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;SHA1, with EMSA1&quot;</span> );</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">case</span> QCA::EMSA3_SHA1:</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;SHA1, with EMSA3&quot;</span> );</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">case</span> QCA::EMSA3_MD5:</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;MD5, with EMSA3&quot;</span> );</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">case</span> QCA::EMSA3_MD2:</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;MD2, with EMSA3&quot;</span> );</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordflow">case</span> QCA::EMSA3_RIPEMD160:</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;RIPEMD160, with EMSA3&quot;</span> );</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">case</span> QCA::EMSA3_Raw:</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;EMSA3, without digest&quot;</span> );</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="preprocessor">#if QCA_VERSION &gt;= 0x020100</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">case</span> QCA::EMSA3_SHA224:</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;SHA224, with EMSA3&quot;</span> );</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">case</span> QCA::EMSA3_SHA256:</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;SHA256, with EMSA3&quot;</span> );</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">case</span> QCA::EMSA3_SHA384:</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;SHA384, with EMSA3&quot;</span> );</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">case</span> QCA::EMSA3_SHA512:</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;SHA512, with EMSA3&quot;</span> );</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Unknown (possibly Elliptic Curve)&quot;</span> );</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;}</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a2962d18262cda4b823d2643002460c7e">  856</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#a2962d18262cda4b823d2643002460c7e">QgsAuthCertUtils::qcaKnownConstraint</a>( QCA::ConstraintTypeKnown constraint )</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;{</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordflow">switch</span> ( constraint )</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">case</span> QCA::DigitalSignature:</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Digital Signature&quot;</span> );</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">case</span> QCA::NonRepudiation:</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Non-repudiation&quot;</span> );</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">case</span> QCA::KeyEncipherment:</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Key Encipherment&quot;</span> );</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">case</span> QCA::DataEncipherment:</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Data Encipherment&quot;</span> );</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">case</span> QCA::KeyAgreement:</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Key Agreement&quot;</span> );</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">case</span> QCA::KeyCertificateSign:</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Key Certificate Sign&quot;</span> );</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">case</span> QCA::CRLSign:</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;CRL Sign&quot;</span> );</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">case</span> QCA::EncipherOnly:</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Encipher Only&quot;</span> );</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">case</span> QCA::DecipherOnly:</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Decipher Only&quot;</span> );</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">case</span> QCA::ServerAuth:</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Server Authentication&quot;</span> );</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">case</span> QCA::ClientAuth:</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Client Authentication&quot;</span> );</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">case</span> QCA::CodeSigning:</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Code Signing&quot;</span> );</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">case</span> QCA::EmailProtection:</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Email Protection&quot;</span> );</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">case</span> QCA::IPSecEndSystem:</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;IPSec Endpoint&quot;</span> );</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">case</span> QCA::IPSecTunnel:</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;IPSec Tunnel&quot;</span> );</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordflow">case</span> QCA::IPSecUser:</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;IPSec User&quot;</span> );</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">case</span> QCA::TimeStamping:</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Time Stamping&quot;</span> );</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">case</span> QCA::OCSPSigning:</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;OCSP Signing&quot;</span> );</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="keywordflow">return</span> QString();</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;}</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a16620dbd0cce1f5376bda70e3aa579fd">  901</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#a16620dbd0cce1f5376bda70e3aa579fd">QgsAuthCertUtils::certificateUsageTypeString</a>( <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441d">QgsAuthCertUtils::CertUsageType</a> usagetype )</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;{</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">switch</span> ( usagetype )</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da28003122de2a6d9f2ab3fa241d6efc8d">QgsAuthCertUtils::AnyOrUnspecifiedUsage</a>:</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Any or unspecified&quot;</span> );</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dadb1d63565a06e7b6f9b2fa0937ccca75">QgsAuthCertUtils::CertAuthorityUsage</a>:</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Authority&quot;</span> );</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dadfaf0a4a3f1deeb262adcdd5ecec5803">QgsAuthCertUtils::CertIssuerUsage</a>:</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Issuer&quot;</span> );</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dacccda0119f3eca7ba3966e8ac47a5eda">QgsAuthCertUtils::TlsServerUsage</a>:</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;TLS/SSL Server&quot;</span> );</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dab7bbc9be6a6c9e785bfa0be0faf43c7e">QgsAuthCertUtils::TlsServerEvUsage</a>:</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;TLS/SSL Server EV&quot;</span> );</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da63936dc3cdd57dc5bcf47a12033d9cd1">QgsAuthCertUtils::TlsClientUsage</a>:</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;TLS/SSL Client&quot;</span> );</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441daa9496f8f2dedcbb74775b35f08a275bb">QgsAuthCertUtils::CodeSigningUsage</a>:</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Code Signing&quot;</span> );</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da2b9fa844681a557b0bc0e90ba7bc97bb">QgsAuthCertUtils::EmailProtectionUsage</a>:</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Email Protection&quot;</span> );</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dad6867785394257d9bb37fe33e0dd8aee">QgsAuthCertUtils::TimeStampingUsage</a>:</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Time Stamping&quot;</span> );</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441daf922d8831822db3011daa12d3b8bef7e">QgsAuthCertUtils::CRLSigningUsage</a>:</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;CRL Signing&quot;</span> );</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da56e9bc3bd8ccd5fb3f8d82723db7d70b">QgsAuthCertUtils::UndeterminedUsage</a>:</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Undetermined usage&quot;</span> );</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;}</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a0fdc4b741e51733b29ff60054b8cc125">  931</a></span>&#160;QList&lt;QgsAuthCertUtils::CertUsageType&gt; <a class="code" href="classQgsAuthCertUtils.html#a0fdc4b741e51733b29ff60054b8cc125">QgsAuthCertUtils::certificateUsageTypes</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;{</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  QList&lt;QgsAuthCertUtils::CertUsageType&gt; usages;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classQgsApplication.html#aa879f2f9f0d9d79f1d7968cc0f1b9a6a">QgsApplication::authManager</a>()-&gt;isDisabled() )</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">return</span> usages;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  QCA::ConvertResult res;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  QCA::Certificate qcacert( QCA::Certificate::fromPEM( cert.toPem(), &amp;res, QStringLiteral( <span class="stringliteral">&quot;qca-ossl&quot;</span> ) ) );</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keywordflow">if</span> ( res != QCA::ConvertGood || qcacert.isNull() )</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  {</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Certificate could not be converted to QCA cert&quot;</span> ) );</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">return</span> usages;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  }</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">if</span> ( qcacert.isCA() )</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Certificate has &#39;CA:TRUE&#39; basic constraint&quot;</span> ) );</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    usages &lt;&lt; <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dadb1d63565a06e7b6f9b2fa0937ccca75">QgsAuthCertUtils::CertAuthorityUsage</a>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="keyword">const</span> QList&lt;QCA::ConstraintType&gt; certconsts = qcacert.constraints();</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;certconst : certconsts )</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  {</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span> ( certconst.known() == QCA::KeyCertificateSign )</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Certificate has &#39;Certificate Sign&#39; key usage&quot;</span> ) );</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      usages &lt;&lt; <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dadfaf0a4a3f1deeb262adcdd5ecec5803">QgsAuthCertUtils::CertIssuerUsage</a>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( certconst.known() == QCA::ServerAuth )</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Certificate has &#39;server authentication&#39; extended key usage&quot;</span> ) );</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      usages &lt;&lt; <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dacccda0119f3eca7ba3966e8ac47a5eda">QgsAuthCertUtils::TlsServerUsage</a>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  }</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="comment">// ask QCA what it thinks about potential usages</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  QCA::CertificateCollection trustedCAs(</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <a class="code" href="classQgsAuthCertUtils.html#a21dca118cb02e62a12ea6dd06e5f7d77">qtCertsToQcaCollection</a>( <a class="code" href="classQgsApplication.html#aa879f2f9f0d9d79f1d7968cc0f1b9a6a">QgsApplication::authManager</a>()-&gt;trustedCaCertsCache() ) );</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  QCA::CertificateCollection untrustedCAs(</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="classQgsAuthCertUtils.html#a21dca118cb02e62a12ea6dd06e5f7d77">qtCertsToQcaCollection</a>( <a class="code" href="classQgsApplication.html#aa879f2f9f0d9d79f1d7968cc0f1b9a6a">QgsApplication::authManager</a>()-&gt;untrustedCaCerts() ) );</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  QCA::Validity v_any;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  v_any = qcacert.validate( trustedCAs, untrustedCAs, QCA::UsageAny, QCA::ValidateAll );</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordflow">if</span> ( v_any == QCA::ValidityGood )</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  {</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    usages &lt;&lt; <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da28003122de2a6d9f2ab3fa241d6efc8d">QgsAuthCertUtils::AnyOrUnspecifiedUsage</a>;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  }</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  QCA::Validity v_tlsserver;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  v_tlsserver = qcacert.validate( trustedCAs, untrustedCAs, QCA::UsageTLSServer, QCA::ValidateAll );</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">if</span> ( v_tlsserver == QCA::ValidityGood )</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">if</span> ( !usages.contains( <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dacccda0119f3eca7ba3966e8ac47a5eda">QgsAuthCertUtils::TlsServerUsage</a> ) )</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    {</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      usages &lt;&lt; <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dacccda0119f3eca7ba3966e8ac47a5eda">QgsAuthCertUtils::TlsServerUsage</a>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    }</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="comment">// TODO: why doesn&#39;t this tag client certs?</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="comment">//       always seems to return QCA::ErrorInvalidPurpose (enum #5)</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  QCA::Validity v_tlsclient;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  v_tlsclient = qcacert.validate( trustedCAs, untrustedCAs, QCA::UsageTLSClient, QCA::ValidateAll );</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="comment">//QgsDebugMsg( QStringLiteral( &quot;QCA::UsageTLSClient validity: %1&quot; ).arg( static_cast&lt;int&gt;(v_tlsclient) ) );</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">if</span> ( v_tlsclient == QCA::ValidityGood )</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    usages &lt;&lt; <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da63936dc3cdd57dc5bcf47a12033d9cd1">QgsAuthCertUtils::TlsClientUsage</a>;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  }</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="comment">// TODO: add TlsServerEvUsage, CodeSigningUsage, EmailProtectionUsage, TimeStampingUsage, CRLSigningUsage</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">//       as they become necessary, since we do not want the overhead of checking just yet.</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">return</span> usages;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;}</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a61f6a45ac9651f157bd80bb1fe1e2a4a"> 1006</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classQgsAuthCertUtils.html#a61f6a45ac9651f157bd80bb1fe1e2a4a">QgsAuthCertUtils::certificateIsAuthority</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;{</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classQgsAuthCertUtils.html#a0fdc4b741e51733b29ff60054b8cc125">QgsAuthCertUtils::certificateUsageTypes</a>( cert ).contains( <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dadb1d63565a06e7b6f9b2fa0937ccca75">QgsAuthCertUtils::CertAuthorityUsage</a> );</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;}</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a825f5bf88b68a43f8b9203faa6d14920"> 1011</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classQgsAuthCertUtils.html#a825f5bf88b68a43f8b9203faa6d14920">QgsAuthCertUtils::certificateIsIssuer</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;{</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classQgsAuthCertUtils.html#a0fdc4b741e51733b29ff60054b8cc125">QgsAuthCertUtils::certificateUsageTypes</a>( cert ).contains( <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dadfaf0a4a3f1deeb262adcdd5ecec5803">QgsAuthCertUtils::CertIssuerUsage</a> );</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;}</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a804e7ef202efaba3d411f9367f5b4008"> 1016</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classQgsAuthCertUtils.html#a804e7ef202efaba3d411f9367f5b4008">QgsAuthCertUtils::certificateIsAuthorityOrIssuer</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;{</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">return</span> ( <a class="code" href="classQgsAuthCertUtils.html#a61f6a45ac9651f157bd80bb1fe1e2a4a">QgsAuthCertUtils::certificateIsAuthority</a>( cert )</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;           || <a class="code" href="classQgsAuthCertUtils.html#a825f5bf88b68a43f8b9203faa6d14920">QgsAuthCertUtils::certificateIsIssuer</a>( cert ) );</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;}</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a972bf42397ede51bf0d82a8e2ca21ea2"> 1022</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classQgsAuthCertUtils.html#a972bf42397ede51bf0d82a8e2ca21ea2">QgsAuthCertUtils::certificateIsSslServer</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;{</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="keywordflow">return</span> ( <a class="code" href="classQgsAuthCertUtils.html#a0fdc4b741e51733b29ff60054b8cc125">QgsAuthCertUtils::certificateUsageTypes</a>( cert ).contains( <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dacccda0119f3eca7ba3966e8ac47a5eda">QgsAuthCertUtils::TlsServerUsage</a> )</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;           || <a class="code" href="classQgsAuthCertUtils.html#a0fdc4b741e51733b29ff60054b8cc125">QgsAuthCertUtils::certificateUsageTypes</a>( cert ).contains( <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dab7bbc9be6a6c9e785bfa0be0faf43c7e">QgsAuthCertUtils::TlsServerEvUsage</a> ) );</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classQgsAuthCertUtils.html#a972bf42397ede51bf0d82a8e2ca21ea2">QgsAuthCertUtils::certificateIsSslServer</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;{</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">// TODO: There is no difinitive method for strictly enforcing what determines an SSL server cert;</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">//       only what it should not be able to do (cert sign, etc.). The logic here may need refined</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="comment">// see: http://security.stackexchange.com/a/26650</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classQgsApplication.html#aa879f2f9f0d9d79f1d7968cc0f1b9a6a">QgsApplication::authManager</a>()-&gt;isDisabled() )</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  QCA::ConvertResult res;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  QCA::Certificate qcacert( QCA::Certificate::fromPEM( cert.toPem(), &amp;res, QString( <span class="stringliteral">&quot;qca-ossl&quot;</span> ) ) );</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordflow">if</span> ( res != QCA::ConvertGood || qcacert.isNull() )</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Certificate could not be converted to QCA cert&quot;</span> ) );</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  }</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keywordflow">if</span> ( qcacert.isCA() )</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  {</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;SSL server certificate has &#39;CA:TRUE&#39; basic constraint (and should not)&quot;</span> ) );</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keyword">const</span> QList&lt;QCA::ConstraintType&gt; certconsts = qcacert.constraints();</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp; certconst, certconsts )</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  {</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">if</span> ( certconst.known() == QCA::KeyCertificateSign )</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    {</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;SSL server certificate has &#39;Certificate Sign&#39; key usage (and should not)&quot;</span> ) );</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    }</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="comment">// check for common key usage and extended key usage constraints</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="comment">// see: https://www.ietf.org/rfc/rfc3280.txt  4.2.1.3(Key Usage) and  4.2.1.13(Extended Key Usage)</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordtype">bool</span> serverauth = <span class="keyword">false</span>;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordtype">bool</span> dsignature = <span class="keyword">false</span>;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keywordtype">bool</span> keyencrypt = <span class="keyword">false</span>;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;certconst : certconsts )</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">if</span> ( certconst.known() == QCA::DigitalSignature )</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;SSL server certificate has &#39;digital signature&#39; key usage&quot;</span> ) );</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      dsignature = <span class="keyword">true</span>;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( certconst.known() == QCA::KeyEncipherment )</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    {</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;SSL server certificate has &#39;key encipherment&#39; key usage&quot;</span> ) );</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      keyencrypt = <span class="keyword">true</span>;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( certconst.known() == QCA::KeyAgreement )</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;SSL server certificate has &#39;key agreement&#39; key usage&quot;</span> ) );</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      keyencrypt = <span class="keyword">true</span>;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    }</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( certconst.known() == QCA::ServerAuth )</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    {</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;SSL server certificate has &#39;server authentication&#39; extended key usage&quot;</span> ) );</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      serverauth = <span class="keyword">true</span>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    }</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  }</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="comment">// From 4.2.1.13(Extended Key Usage):</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="comment">//   &quot;If a certificate contains both a key usage extension and an extended</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="comment">//   key usage extension, then both extensions MUST be processed</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="comment">//   independently and the certificate MUST only be used for a purpose</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="comment">//   consistent with both extensions.  If there is no purpose consistent</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="comment">//   with both extensions, then the certificate MUST NOT be used for any</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="comment">//   purpose.&quot;</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">if</span> ( serverauth &amp;&amp; dsignature &amp;&amp; keyencrypt )</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  {</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordflow">if</span> ( dsignature &amp;&amp; keyencrypt )</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  {</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  }</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="comment">// lastly, check for DH key and key agreement</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordtype">bool</span> keyagree = <span class="keyword">false</span>;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordtype">bool</span> encipheronly = <span class="keyword">false</span>;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordtype">bool</span> decipheronly = <span class="keyword">false</span>;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  QCA::PublicKey pubkey( qcacert.subjectPublicKey() );</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="comment">// key size may be 0 for eliptical curve-based keys, in which case isDH() crashes QCA</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">if</span> ( pubkey.bitSize() &gt; 0 &amp;&amp; pubkey.isDH() )</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  {</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    keyagree = pubkey.canKeyAgree();</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">if</span> ( !keyagree )</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    }</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;certconst : certconsts )</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">if</span> ( certconst.known() == QCA::EncipherOnly )</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      {</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;SSL server public key has &#39;encipher only&#39; key usage&quot;</span> ) );</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        encipheronly = <span class="keyword">true</span>;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( certconst.known() == QCA::DecipherOnly )</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      {</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;SSL server public key has &#39;decipher only&#39; key usage&quot;</span> ) );</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        decipheronly = <span class="keyword">true</span>;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      }</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    }</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">if</span> ( !encipheronly &amp;&amp; !decipheronly )</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    {</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    }</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  }</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;}</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a93804e12c26c578824074732840856d7"> 1143</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classQgsAuthCertUtils.html#a93804e12c26c578824074732840856d7">QgsAuthCertUtils::certificateIsSslClient</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;{</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classQgsAuthCertUtils.html#a0fdc4b741e51733b29ff60054b8cc125">QgsAuthCertUtils::certificateUsageTypes</a>( cert ).contains( <a class="code" href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da63936dc3cdd57dc5bcf47a12033d9cd1">QgsAuthCertUtils::TlsClientUsage</a> );</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;}</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd"> 1148</a></span>&#160;QString <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::SslError errenum )</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;{</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">switch</span> ( errenum )</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  {</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordflow">case</span> QSslError::UnableToGetIssuerCertificate:</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Unable to Get Issuer Certificate&quot;</span> );</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordflow">case</span> QSslError::UnableToDecryptCertificateSignature:</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Unable to Decrypt Certificate Signature&quot;</span> );</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">case</span> QSslError::UnableToDecodeIssuerPublicKey:</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Unable to Decode Issuer Public Key&quot;</span> );</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">case</span> QSslError::CertificateSignatureFailed:</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Signature Failed&quot;</span> );</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordflow">case</span> QSslError::CertificateNotYetValid:</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Not Yet Valid&quot;</span> );</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordflow">case</span> QSslError::CertificateExpired:</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Expired&quot;</span> );</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">case</span> QSslError::InvalidNotBeforeField:</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Invalid Not Before Field&quot;</span> );</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">case</span> QSslError::InvalidNotAfterField:</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Invalid Not After Field&quot;</span> );</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">case</span> QSslError::SelfSignedCertificate:</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Self-signed Certificate&quot;</span> );</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">case</span> QSslError::SelfSignedCertificateInChain:</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Self-signed Certificate In Chain&quot;</span> );</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordflow">case</span> QSslError::UnableToGetLocalIssuerCertificate:</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Unable to Get Local Issuer Certificate&quot;</span> );</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">case</span> QSslError::UnableToVerifyFirstCertificate:</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Unable to Verify First Certificate&quot;</span> );</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">case</span> QSslError::CertificateRevoked:</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Revoked&quot;</span> );</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">case</span> QSslError::InvalidCaCertificate:</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Invalid CA Certificate&quot;</span> );</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">case</span> QSslError::PathLengthExceeded:</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Path Length Exceeded&quot;</span> );</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">case</span> QSslError::InvalidPurpose:</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Invalid Purpose&quot;</span> );</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordflow">case</span> QSslError::CertificateUntrusted:</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Untrusted&quot;</span> );</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">case</span> QSslError::CertificateRejected:</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Rejected&quot;</span> );</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">case</span> QSslError::SubjectIssuerMismatch:</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Subject Issuer Mismatch&quot;</span> );</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">case</span> QSslError::AuthorityIssuerSerialNumberMismatch:</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Authority Issuer Serial Number Mismatch&quot;</span> );</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordflow">case</span> QSslError::NoPeerCertificate:</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;No Peer Certificate&quot;</span> );</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">case</span> QSslError::HostNameMismatch:</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Host Name Mismatch&quot;</span> );</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">case</span> QSslError::UnspecifiedError:</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Unspecified Error&quot;</span> );</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">case</span> QSslError::CertificateBlacklisted:</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;Certificate Blacklisted&quot;</span> );</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">case</span> QSslError::NoError:</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;No Error&quot;</span> );</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordflow">case</span> QSslError::NoSslSupport:</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="keywordflow">return</span> QObject::tr( <span class="stringliteral">&quot;No SSL Support&quot;</span> );</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keywordflow">return</span> QString();</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  }</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;}</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#aded924e7f75d6e374b5a9de81238d478"> 1209</a></span>&#160;QList&lt;QPair&lt;QSslError::SslError, QString&gt; &gt; <a class="code" href="classQgsAuthCertUtils.html#aded924e7f75d6e374b5a9de81238d478">QgsAuthCertUtils::sslErrorEnumStrings</a>()</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;{</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  QList&lt;QPair&lt;QSslError::SslError, QString&gt; &gt; errenums;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::UnableToGetIssuerCertificate,</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::UnableToGetIssuerCertificate ) );</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::UnableToDecryptCertificateSignature,</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::UnableToDecryptCertificateSignature ) );</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::UnableToDecodeIssuerPublicKey,</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::UnableToDecodeIssuerPublicKey ) );</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::CertificateSignatureFailed,</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::CertificateSignatureFailed ) );</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::CertificateNotYetValid,</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::CertificateNotYetValid ) );</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::CertificateExpired,</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::CertificateExpired ) );</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::InvalidNotBeforeField,</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::InvalidNotBeforeField ) );</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::InvalidNotAfterField,</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::InvalidNotAfterField ) );</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::SelfSignedCertificate,</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::SelfSignedCertificate ) );</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::SelfSignedCertificateInChain,</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::SelfSignedCertificateInChain ) );</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::UnableToGetLocalIssuerCertificate,</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::UnableToGetLocalIssuerCertificate ) );</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::UnableToVerifyFirstCertificate,</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::UnableToVerifyFirstCertificate ) );</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::CertificateRevoked,</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::CertificateRevoked ) );</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::InvalidCaCertificate,</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::InvalidCaCertificate ) );</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::PathLengthExceeded,</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::PathLengthExceeded ) );</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::InvalidPurpose,</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::InvalidPurpose ) );</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::CertificateUntrusted,</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::CertificateUntrusted ) );</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::CertificateRejected,</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::CertificateRejected ) );</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::SubjectIssuerMismatch,</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::SubjectIssuerMismatch ) );</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::AuthorityIssuerSerialNumberMismatch,</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::AuthorityIssuerSerialNumberMismatch ) );</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::NoPeerCertificate,</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::NoPeerCertificate ) );</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::HostNameMismatch,</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::HostNameMismatch ) );</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::UnspecifiedError,</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::UnspecifiedError ) );</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  errenums &lt;&lt; qMakePair( QSslError::CertificateBlacklisted,</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                         <a class="code" href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a>( QSslError::CertificateBlacklisted ) );</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <span class="keywordflow">return</span> errenums;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;}</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div><div class="line"><a name="l01263"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#aa9c721886de725572019df6ec482d993"> 1263</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classQgsAuthCertUtils.html#aa9c721886de725572019df6ec482d993">QgsAuthCertUtils::certIsCurrent</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;{</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="keywordflow">if</span> ( cert.isNull() )</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="keyword">const</span> QDateTime currentTime = QDateTime::currentDateTime();</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="keywordflow">return</span> cert.effectiveDate() &lt;= currentTime &amp;&amp; cert.expiryDate() &gt;= currentTime;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;}</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#affa1f6b8954b67f407f8cd78ab25fb76"> 1271</a></span>&#160;QList&lt;QSslError&gt; <a class="code" href="classQgsAuthCertUtils.html#affa1f6b8954b67f407f8cd78ab25fb76">QgsAuthCertUtils::certViabilityErrors</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;{</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  QList&lt;QSslError&gt; sslErrors;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="keywordflow">if</span> ( cert.isNull() )</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keywordflow">return</span> sslErrors;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="keyword">const</span> QDateTime currentTime = QDateTime::currentDateTime();</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="keywordflow">if</span> ( cert.expiryDate() &lt;= currentTime )</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    sslErrors &lt;&lt; QSslError( QSslError::SslError::CertificateExpired, cert );</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  }</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordflow">if</span> ( cert.effectiveDate() &gt;= QDateTime::currentDateTime() )</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  {</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    sslErrors &lt;&lt; QSslError( QSslError::SslError::CertificateNotYetValid, cert );</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  }</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="keywordflow">if</span> ( cert.isBlacklisted() )</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  {</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    sslErrors &lt;&lt; QSslError( QSslError::SslError::CertificateBlacklisted, cert );</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  }</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="keywordflow">return</span> sslErrors;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;}</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div><div class="line"><a name="l01295"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#a5d80a3c4e51240d12e7b30cd4f0890a0"> 1295</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classQgsAuthCertUtils.html#a5d80a3c4e51240d12e7b30cd4f0890a0">QgsAuthCertUtils::certIsViable</a>( <span class="keyword">const</span> QSslCertificate &amp;cert )</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;{</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="keywordflow">return</span> !cert.isNull() &amp;&amp; <a class="code" href="classQgsAuthCertUtils.html#affa1f6b8954b67f407f8cd78ab25fb76">QgsAuthCertUtils::certViabilityErrors</a>( cert ).isEmpty();</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;}</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#ad87fa6f35b409b3bedb3833819d43dec"> 1300</a></span>&#160;QList&lt;QSslError&gt; <a class="code" href="classQgsAuthCertUtils.html#ad87fa6f35b409b3bedb3833819d43dec">QgsAuthCertUtils::validateCertChain</a>( <span class="keyword">const</span> QList&lt;QSslCertificate&gt; &amp;certificateChain,</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keyword">const</span> QString &amp;hostName,</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordtype">bool</span> trustRootCa )</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;{</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  QList&lt;QSslError&gt; sslErrors;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  QList&lt;QSslCertificate&gt; trustedChain;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="comment">// Filter out all CAs that are not trusted from QgsAuthManager</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : certificateChain )</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  {</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordtype">bool</span> untrusted = <span class="keyword">false</span>;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;untrustedCert : <a class="code" href="classQgsApplication.html#aa879f2f9f0d9d79f1d7968cc0f1b9a6a">QgsApplication::authManager</a>()-&gt;untrustedCaCerts() )</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    {</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keywordflow">if</span> ( cert.digest( ) == untrustedCert.digest( ) )</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      {</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        untrusted = <span class="keyword">true</span>;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      }</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    }</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordflow">if</span> ( ! untrusted )</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    {</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      trustedChain &lt;&lt; cert;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    }</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  }</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="comment">// Check that no certs in the chain are expired or not yet valid or blacklisted</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keyword">const</span> QList&lt;QSslCertificate&gt; constTrustedChain( trustedChain );</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;cert : constTrustedChain )</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  {</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    sslErrors &lt;&lt; <a class="code" href="classQgsAuthCertUtils.html#affa1f6b8954b67f407f8cd78ab25fb76">QgsAuthCertUtils::certViabilityErrors</a>( cert );</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  }</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="comment">// Merge in the root CA if present and asked for</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="keywordflow">if</span> ( trustRootCa &amp;&amp; trustedChain.count() &gt; 1 &amp;&amp; trustedChain.last().isSelfSigned() )</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  {</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keyword">static</span> QMutex sMutex;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    QMutexLocker lock( &amp;sMutex );</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    QSslConfiguration oldSslConfig( QSslConfiguration::defaultConfiguration() );</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    QSslConfiguration sslConfig( oldSslConfig );</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    sslConfig.setCaCertificates( <a class="code" href="classQgsAuthCertUtils.html#a4aaa3f19c881ed1ee82428b9c2ca6952">casMerge</a>( sslConfig.caCertificates(), QList&lt;QSslCertificate&gt;() &lt;&lt; trustedChain.last() ) );</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    QSslConfiguration::setDefaultConfiguration( sslConfig );</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    sslErrors = QSslCertificate::verify( trustedChain, hostName );</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    QSslConfiguration::setDefaultConfiguration( oldSslConfig );</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  }</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  {</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    sslErrors = QSslCertificate::verify( trustedChain, hostName );</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  }</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="keywordflow">return</span> sslErrors;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;}</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div><div class="line"><a name="l01350"></a><span class="lineno"><a class="line" href="classQgsAuthCertUtils.html#afa9cc61136ec0cebe5cb7e9fbcfc5650"> 1350</a></span>&#160;QStringList <a class="code" href="classQgsAuthCertUtils.html#afa9cc61136ec0cebe5cb7e9fbcfc5650">QgsAuthCertUtils::validatePKIBundle</a>( <a class="code" href="classQgsPkiBundle.html">QgsPkiBundle</a> &amp;bundle, <span class="keywordtype">bool</span> useIntermediates, <span class="keywordtype">bool</span> trustRootCa )</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;{</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  QStringList errors;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordflow">if</span> ( bundle.<a class="code" href="classQgsPkiBundle.html#ae2972b970689145432710bdf76977a10">clientCert</a>().isNull() )</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    errors &lt;&lt; QObject::tr( <span class="stringliteral">&quot;Client certificate is NULL.&quot;</span> );</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="keywordflow">if</span> ( bundle.<a class="code" href="classQgsPkiBundle.html#aa9f21aa254da8164af0c8c78df406269">clientKey</a>().isNull() )</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    errors &lt;&lt; QObject::tr( <span class="stringliteral">&quot;Client certificate key is NULL.&quot;</span> );</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="comment">// immediately bail out if cert or key is NULL</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">if</span> ( !errors.isEmpty() )</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordflow">return</span> errors;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  QList&lt;QSslError&gt; sslErrors;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="keywordflow">if</span> ( useIntermediates )</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  {</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    QList&lt;QSslCertificate&gt; certsList( bundle.<a class="code" href="classQgsPkiBundle.html#acf7fc2977a7dd2f36a33eaab9aa86dde">caChain</a>() );</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    certsList.insert( 0, bundle.<a class="code" href="classQgsPkiBundle.html#ae2972b970689145432710bdf76977a10">clientCert</a>( ) );</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    sslErrors = <a class="code" href="classQgsAuthCertUtils.html#ad87fa6f35b409b3bedb3833819d43dec">QgsAuthCertUtils::validateCertChain</a>( certsList, QString(), trustRootCa );</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  }</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  {</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    sslErrors = QSslCertificate::verify( QList&lt;QSslCertificate&gt;() &lt;&lt; bundle.<a class="code" href="classQgsPkiBundle.html#ae2972b970689145432710bdf76977a10">clientCert</a>() );</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  }</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keyword">const</span> QList&lt;QSslError&gt; constSslErrors( sslErrors );</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;sslError : constSslErrors )</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">if</span> ( sslError.error() != QSslError::NoError )</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    {</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      errors &lt;&lt; sslError.errorString();</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    }</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  }</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="comment">// Now check the key with QCA!</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  QCA::PrivateKey pvtKey( QCA::PrivateKey::fromPEM( bundle.<a class="code" href="classQgsPkiBundle.html#aa9f21aa254da8164af0c8c78df406269">clientKey</a>().toPem() ) );</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  QCA::PublicKey pubKey( QCA::PublicKey::fromPEM( bundle.<a class="code" href="classQgsPkiBundle.html#ae2972b970689145432710bdf76977a10">clientCert</a>().publicKey().toPem( ) ) );</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="keywordtype">bool</span> keyValid( ! pvtKey.isNull() );</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  <span class="keywordflow">if</span> ( keyValid &amp;&amp; !( pubKey.toRSA().isNull( ) || pvtKey.toRSA().isNull( ) ) )</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  {</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    keyValid = pubKey.toRSA().n() == pvtKey.toRSA().n();</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  }</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( keyValid &amp;&amp; !( pubKey.toDSA().isNull( ) || pvtKey.toDSA().isNull( ) ) )</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  {</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    keyValid = pubKey == QCA::DSAPublicKey( pvtKey.toDSA() );</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  }</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  {</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( QStringLiteral( <span class="stringliteral">&quot;Key is not DSA, RSA: validation is not supported by QCA&quot;</span> ) );</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="keywordflow">if</span> ( ! keyValid )</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  {</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    errors &lt;&lt; QObject::tr( <span class="stringliteral">&quot;Private key does not match client certificate public key.&quot;</span> );</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  }</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordflow">return</span> errors;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}</div><div class="ttc" id="classQgsAuthCertUtils_html_acf87e6e1bf6812600bf2e7041a7cb96e"><div class="ttname"><a href="classQgsAuthCertUtils.html#acf87e6e1bf6812600bf2e7041a7cb96e">QgsAuthCertUtils::pemIsPkcs8</a></div><div class="ttdeci">static bool pemIsPkcs8(const QString &amp;keyPemTxt)</div><div class="ttdoc">Determine if the PEM-encoded text of a key is PKCS#8 format. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00288">qgsauthcertutils.cpp:288</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a16620dbd0cce1f5376bda70e3aa579fd"><div class="ttname"><a href="classQgsAuthCertUtils.html#a16620dbd0cce1f5376bda70e3aa579fd">QgsAuthCertUtils::certificateUsageTypeString</a></div><div class="ttdeci">static QString certificateUsageTypeString(QgsAuthCertUtils::CertUsageType usagetype)</div><div class="ttdoc">Certificate usage type strings per enum. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00901">qgsauthcertutils.cpp:901</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a4aaa3f19c881ed1ee82428b9c2ca6952"><div class="ttname"><a href="classQgsAuthCertUtils.html#a4aaa3f19c881ed1ee82428b9c2ca6952">QgsAuthCertUtils::casMerge</a></div><div class="ttdeci">static QList&lt; QSslCertificate &gt; casMerge(const QList&lt; QSslCertificate &gt; &amp;bundle1, const QList&lt; QSslCertificate &gt; &amp;bundle2)</div><div class="ttdoc">casMerge merges two certificate bundles in a single one removing duplicates, the certificates from th...</div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00151">qgsauthcertutils.cpp:151</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ace4ce0331465828e8eb0e8099affb06c"><div class="ttname"><a href="classQgsAuthCertUtils.html#ace4ce0331465828e8eb0e8099affb06c">QgsAuthCertUtils::pemTextToTempFile</a></div><div class="ttdeci">static QString pemTextToTempFile(const QString &amp;name, const QByteArray &amp;pemtext)</div><div class="ttdoc">Write a temporary file for a PEM text of cert/key/CAs bundle component. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00569">qgsauthcertutils.cpp:569</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441daa9496f8f2dedcbb74775b35f08a275bb"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441daa9496f8f2dedcbb74775b35f08a275bb">QgsAuthCertUtils::CodeSigningUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00071">qgsauthcertutils.h:71</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_abe90cccf324e3bd5c7f81691140375ddad49c8b852dcd6bbec85e73466f91766f"><div class="ttname"><a href="classQgsAuthCertUtils.html#abe90cccf324e3bd5c7f81691140375ddad49c8b852dcd6bbec85e73466f91766f">QgsAuthCertUtils::SystemRoot</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00046">qgsauthcertutils.h:46</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ad50f8df6822e222b43f71cae741b7a85"><div class="ttname"><a href="classQgsAuthCertUtils.html#ad50f8df6822e222b43f71cae741b7a85">QgsAuthCertUtils::mapDigestToSslConfigs</a></div><div class="ttdeci">static QMap&lt; QString, QgsAuthConfigSslServer &gt; mapDigestToSslConfigs(const QList&lt; QgsAuthConfigSslServer &gt; &amp;configs)</div><div class="ttdoc">Map SSL custom configs&amp;#39; certificate sha1 to custom config as simple cache. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00079">qgsauthcertutils.cpp:79</a></div></div>
<div class="ttc" id="qgsauthmanager_8h_html"><div class="ttname"><a href="qgsauthmanager_8h.html">qgsauthmanager.h</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a825f5bf88b68a43f8b9203faa6d14920"><div class="ttname"><a href="classQgsAuthCertUtils.html#a825f5bf88b68a43f8b9203faa6d14920">QgsAuthCertUtils::certificateIsIssuer</a></div><div class="ttdeci">static bool certificateIsIssuer(const QSslCertificate &amp;cert)</div><div class="ttdoc">Gets whether a certificate can sign other certificates. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01011">qgsauthcertutils.cpp:1011</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a245baf0d84d532415adba1518bff7371a1eb7b3429862d0c79080d69445b30acb"><div class="ttname"><a href="classQgsAuthCertUtils.html#a245baf0d84d532415adba1518bff7371a1eb7b3429862d0c79080d69445b30acb">QgsAuthCertUtils::Untrusted</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00057">qgsauthcertutils.h:57</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a2962d18262cda4b823d2643002460c7e"><div class="ttname"><a href="classQgsAuthCertUtils.html#a2962d18262cda4b823d2643002460c7e">QgsAuthCertUtils::qcaKnownConstraint</a></div><div class="ttdeci">static QString qcaKnownConstraint(QCA::ConstraintTypeKnown constraint)</div><div class="ttdoc">Certificate well-known constraint strings per enum. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00856">qgsauthcertutils.cpp:856</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a95a831125902ad0426a60ca9c2e0cb59"><div class="ttname"><a href="classQgsAuthCertUtils.html#a95a831125902ad0426a60ca9c2e0cb59">QgsAuthCertUtils::keyFromFile</a></div><div class="ttdeci">static QSslKey keyFromFile(const QString &amp;keypath, const QString &amp;keypass=QString(), QString *algtype=nullptr)</div><div class="ttdoc">Returns non-encrypted key from a PEM or DER formatted file. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00188">qgsauthcertutils.cpp:188</a></div></div>
<div class="ttc" id="qgslogger_8h_html_ab273942cfb1b76ef0a5dafe6ed64fe23"><div class="ttname"><a href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a></div><div class="ttdeci">#define QgsDebugMsg(str)</div><div class="ttdef"><b>Definition:</b> <a href="qgslogger_8h_source.html#l00038">qgslogger.h:38</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a9b60d458a0085eb7d3be49e891a28de7"><div class="ttname"><a href="classQgsAuthCertUtils.html#a9b60d458a0085eb7d3be49e891a28de7">QgsAuthCertUtils::casFromFile</a></div><div class="ttdeci">static QList&lt; QSslCertificate &gt; casFromFile(const QString &amp;certspath)</div><div class="ttdoc">Returns a list of concatenated CAs from a PEM or DER formatted file. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00137">qgsauthcertutils.cpp:137</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441dacccda0119f3eca7ba3966e8ac47a5eda"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dacccda0119f3eca7ba3966e8ac47a5eda">QgsAuthCertUtils::TlsServerUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00068">qgsauthcertutils.h:68</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a02e114e5382af5cfd5dd7e9a93810abd"><div class="ttname"><a href="classQgsAuthCertUtils.html#a02e114e5382af5cfd5dd7e9a93810abd">QgsAuthCertUtils::sslErrorEnumString</a></div><div class="ttdeci">static QString sslErrorEnumString(QSslError::SslError errenum)</div><div class="ttdoc">Gets short strings describing an SSL error. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01148">qgsauthcertutils.cpp:1148</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a7a419d79cf4d21caf313a1892c64f74d"><div class="ttname"><a href="classQgsAuthCertUtils.html#a7a419d79cf4d21caf313a1892c64f74d">QgsAuthCertUtils::certsFromFile</a></div><div class="ttdeci">static QList&lt; QSslCertificate &gt; certsFromFile(const QString &amp;certspath)</div><div class="ttdoc">Returns a list of concatenated certs from a PEM or DER formatted file. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00125">qgsauthcertutils.cpp:125</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_afa9cc61136ec0cebe5cb7e9fbcfc5650"><div class="ttname"><a href="classQgsAuthCertUtils.html#afa9cc61136ec0cebe5cb7e9fbcfc5650">QgsAuthCertUtils::validatePKIBundle</a></div><div class="ttdeci">static QStringList validatePKIBundle(QgsPkiBundle &amp;bundle, bool useIntermediates=true, bool trustRootCa=false)</div><div class="ttdoc">validatePKIBundle validate the PKI bundle by checking the certificate chain, the expiration and effec...</div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01350">qgsauthcertutils.cpp:1350</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a3c8a249d8342929ac22985e3e844f9c0"><div class="ttname"><a href="classQgsAuthCertUtils.html#a3c8a249d8342929ac22985e3e844f9c0">QgsAuthCertUtils::mapDigestToCerts</a></div><div class="ttdeci">static QMap&lt; QString, QSslCertificate &gt; mapDigestToCerts(const QList&lt; QSslCertificate &gt; &amp;certs)</div><div class="ttdoc">Map certificate sha1 to certificate as simple cache. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00055">qgsauthcertutils.cpp:55</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a804e7ef202efaba3d411f9367f5b4008"><div class="ttname"><a href="classQgsAuthCertUtils.html#a804e7ef202efaba3d411f9367f5b4008">QgsAuthCertUtils::certificateIsAuthorityOrIssuer</a></div><div class="ttdeci">static bool certificateIsAuthorityOrIssuer(const QSslCertificate &amp;cert)</div><div class="ttdoc">Gets whether a certificate is an Authority or can at least sign other certificates. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01016">qgsauthcertutils.cpp:1016</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a21dca118cb02e62a12ea6dd06e5f7d77"><div class="ttname"><a href="classQgsAuthCertUtils.html#a21dca118cb02e62a12ea6dd06e5f7d77">QgsAuthCertUtils::qtCertsToQcaCollection</a></div><div class="ttdeci">static QCA::CertificateCollection qtCertsToQcaCollection(const QList&lt; QSslCertificate &gt; &amp;certs)</div><div class="ttdoc">Convert a QList of QSslCertificate to a QCA::CertificateCollection. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00763">qgsauthcertutils.cpp:763</a></div></div>
<div class="ttc" id="classQgsPkiBundle_html_ae2972b970689145432710bdf76977a10"><div class="ttname"><a href="classQgsPkiBundle.html#ae2972b970689145432710bdf76977a10">QgsPkiBundle::clientCert</a></div><div class="ttdeci">const QSslCertificate clientCert() const</div><div class="ttdoc">Client certificate object. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthconfig_8h_source.html#l00233">qgsauthconfig.h:233</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441d"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441d">QgsAuthCertUtils::CertUsageType</a></div><div class="ttdeci">CertUsageType</div><div class="ttdoc">Type of certificate usage. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00062">qgsauthcertutils.h:62</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a12b78fe6f22c96790e3b20c357d46168"><div class="ttname"><a href="classQgsAuthCertUtils.html#a12b78fe6f22c96790e3b20c357d46168">QgsAuthCertUtils::qtCertToQcaCert</a></div><div class="ttdeci">static QCA::Certificate qtCertToQcaCert(const QSslCertificate &amp;cert)</div><div class="ttdoc">Convert a QSslCertificate to a QCA::Certificate. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00748">qgsauthcertutils.cpp:748</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a0fdc4b741e51733b29ff60054b8cc125"><div class="ttname"><a href="classQgsAuthCertUtils.html#a0fdc4b741e51733b29ff60054b8cc125">QgsAuthCertUtils::certificateUsageTypes</a></div><div class="ttdeci">static QList&lt; QgsAuthCertUtils::CertUsageType &gt; certificateUsageTypes(const QSslCertificate &amp;cert)</div><div class="ttdoc">Try to determine the certificates usage types. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00931">qgsauthcertutils.cpp:931</a></div></div>
<div class="ttc" id="qgsauthcertutils_8h_html"><div class="ttname"><a href="qgsauthcertutils_8h.html">qgsauthcertutils.h</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441da63936dc3cdd57dc5bcf47a12033d9cd1"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da63936dc3cdd57dc5bcf47a12033d9cd1">QgsAuthCertUtils::TlsClientUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00070">qgsauthcertutils.h:70</a></div></div>
<div class="ttc" id="classQgsPkiBundle_html"><div class="ttname"><a href="classQgsPkiBundle.html">QgsPkiBundle</a></div><div class="ttdoc">Storage set for PKI bundle: SSL certificate, key, optional CA cert chain. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthconfig_8h_source.html#l00189">qgsauthconfig.h:189</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a5d80a3c4e51240d12e7b30cd4f0890a0"><div class="ttname"><a href="classQgsAuthCertUtils.html#a5d80a3c4e51240d12e7b30cd4f0890a0">QgsAuthCertUtils::certIsViable</a></div><div class="ttdeci">static bool certIsViable(const QSslCertificate &amp;cert)</div><div class="ttdoc">certIsViable checks for viability errors of cert and whether it is NULL </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01295">qgsauthcertutils.cpp:1295</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a72937c0e1b2bcb20e04c6a9ec49a4366"><div class="ttname"><a href="classQgsAuthCertUtils.html#a72937c0e1b2bcb20e04c6a9ec49a4366">QgsAuthCertUtils::pkcs12BundleToPem</a></div><div class="ttdeci">static QStringList pkcs12BundleToPem(const QString &amp;bundlepath, const QString &amp;bundlepass=QString(), bool reencrypt=true)</div><div class="ttdoc">Returns list of certificate, private key and algorithm (as PEM text) for a PKCS#12 bundle...</div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00438">qgsauthcertutils.cpp:438</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a61f6a45ac9651f157bd80bb1fe1e2a4a"><div class="ttname"><a href="classQgsAuthCertUtils.html#a61f6a45ac9651f157bd80bb1fe1e2a4a">QgsAuthCertUtils::certificateIsAuthority</a></div><div class="ttdeci">static bool certificateIsAuthority(const QSslCertificate &amp;cert)</div><div class="ttdoc">Gets whether a certificate is an Authority. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01006">qgsauthcertutils.cpp:1006</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a084547c0569b050312bff9f72844034f"><div class="ttname"><a href="classQgsAuthCertUtils.html#a084547c0569b050312bff9f72844034f">QgsAuthCertUtils::fileData</a></div><div class="ttdeci">static QByteArray fileData(const QString &amp;path)</div><div class="ttdoc">Returns data from a local file via a read-only operation. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00104">qgsauthcertutils.cpp:104</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a80db11dd909408dac031a3e6db84cca9"><div class="ttname"><a href="classQgsAuthCertUtils.html#a80db11dd909408dac031a3e6db84cca9">QgsAuthCertUtils::casRemoveSelfSigned</a></div><div class="ttdeci">static QList&lt; QSslCertificate &gt; casRemoveSelfSigned(const QList&lt; QSslCertificate &gt; &amp;caList)</div><div class="ttdoc">casRemoveSelfSigned remove self-signed CA certificates from caList </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00250">qgsauthcertutils.cpp:250</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_abe90cccf324e3bd5c7f81691140375dda52c86bb5a8080b0c9263e473b7d9a888"><div class="ttname"><a href="classQgsAuthCertUtils.html#abe90cccf324e3bd5c7f81691140375dda52c86bb5a8080b0c9263e473b7d9a888">QgsAuthCertUtils::InDatabase</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00048">qgsauthcertutils.h:48</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441da56e9bc3bd8ccd5fb3f8d82723db7d70b"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da56e9bc3bd8ccd5fb3f8d82723db7d70b">QgsAuthCertUtils::UndeterminedUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00064">qgsauthcertutils.h:64</a></div></div>
<div class="ttc" id="qgslogger_8h_html_a795a1fcfb1c61b988bbd999396411d13"><div class="ttname"><a href="qgslogger_8h.html#a795a1fcfb1c61b988bbd999396411d13">QgsDebugMsgLevel</a></div><div class="ttdeci">#define QgsDebugMsgLevel(str, level)</div><div class="ttdef"><b>Definition:</b> <a href="qgslogger_8h_source.html#l00039">qgslogger.h:39</a></div></div>
<div class="ttc" id="classQgsPkiBundle_html_aa9f21aa254da8164af0c8c78df406269"><div class="ttname"><a href="classQgsPkiBundle.html#aa9f21aa254da8164af0c8c78df406269">QgsPkiBundle::clientKey</a></div><div class="ttdeci">const QSslKey clientKey() const</div><div class="ttdoc">Private key object. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthconfig_8h_source.html#l00238">qgsauthconfig.h:238</a></div></div>
<div class="ttc" id="qgswfsgetfeature_8cpp_html_a91798216200b925186e1bf0e7fcb201b"><div class="ttname"><a href="qgswfsgetfeature_8cpp.html#a91798216200b925186e1bf0e7fcb201b">typeName</a></div><div class="ttdeci">const QString &amp; typeName</div><div class="ttdef"><b>Definition:</b> <a href="qgswfsgetfeature_8cpp_source.html#l00053">qgswfsgetfeature.cpp:53</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_abe90cccf324e3bd5c7f81691140375dda03a78a0213b569f008f3ba913a6c9194"><div class="ttname"><a href="classQgsAuthCertUtils.html#abe90cccf324e3bd5c7f81691140375dda03a78a0213b569f008f3ba913a6c9194">QgsAuthCertUtils::Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00049">qgsauthcertutils.h:49</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a6006a28b31c4ae2f2f58a8727dea79d4"><div class="ttname"><a href="classQgsAuthCertUtils.html#a6006a28b31c4ae2f2f58a8727dea79d4">QgsAuthCertUtils::certKeyBundleToPem</a></div><div class="ttdeci">static QStringList certKeyBundleToPem(const QString &amp;certpath, const QString &amp;keypath, const QString &amp;keypass=QString(), bool reencrypt=true)</div><div class="ttdoc">Returns list of certificate, private key and algorithm (as PEM text) from file path components...</div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00263">qgsauthcertutils.cpp:263</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441dad6867785394257d9bb37fe33e0dd8aee"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dad6867785394257d9bb37fe33e0dd8aee">QgsAuthCertUtils::TimeStampingUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00073">qgsauthcertutils.h:73</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_af489448758b237628cf0a67c427ed03c"><div class="ttname"><a href="classQgsAuthCertUtils.html#af489448758b237628cf0a67c427ed03c">QgsAuthCertUtils::getCertDistinguishedName</a></div><div class="ttdeci">static QString getCertDistinguishedName(const QSslCertificate &amp;qcert, const QCA::Certificate &amp;acert=QCA::Certificate(), bool issuer=false)</div><div class="ttdoc">Gets combined distinguished name for certificate. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00660">qgsauthcertutils.cpp:660</a></div></div>
<div class="ttc" id="qgsapplication_8h_html"><div class="ttname"><a href="qgsapplication_8h.html">qgsapplication.h</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_affa1f6b8954b67f407f8cd78ab25fb76"><div class="ttname"><a href="classQgsAuthCertUtils.html#affa1f6b8954b67f407f8cd78ab25fb76">QgsAuthCertUtils::certViabilityErrors</a></div><div class="ttdeci">static QList&lt; QSslError &gt; certViabilityErrors(const QSslCertificate &amp;cert)</div><div class="ttdoc">certViabilityErrors checks basic characteristics (validity dates, blacklisting, etc.) of given cert </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01271">qgsauthcertutils.cpp:1271</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441dadfaf0a4a3f1deeb262adcdd5ecec5803"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dadfaf0a4a3f1deeb262adcdd5ecec5803">QgsAuthCertUtils::CertIssuerUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00067">qgsauthcertutils.h:67</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a7808536527d2af8e162da8c6c382c647"><div class="ttname"><a href="classQgsAuthCertUtils.html#a7808536527d2af8e162da8c6c382c647">QgsAuthCertUtils::sslConfigsGroupedByOrg</a></div><div class="ttdeci">static QMap&lt; QString, QList&lt; QgsAuthConfigSslServer &gt; &gt; sslConfigsGroupedByOrg(const QList&lt; QgsAuthConfigSslServer &gt; &amp;configs)</div><div class="ttdoc">Map SSL custom configs&amp;#39; certificates to their oraganization. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00089">qgsauthcertutils.cpp:89</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a245baf0d84d532415adba1518bff7371a61ab01103aee838ab3df35b0d56f547c"><div class="ttname"><a href="classQgsAuthCertUtils.html#a245baf0d84d532415adba1518bff7371a61ab01103aee838ab3df35b0d56f547c">QgsAuthCertUtils::Trusted</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00056">qgsauthcertutils.h:56</a></div></div>
<div class="ttc" id="porting__processing_8dox_html_a2363590aeaf7c1e254a233e7d840ae29"><div class="ttname"><a href="porting__processing_8dox.html#a2363590aeaf7c1e254a233e7d840ae29">algorithm</a></div><div class="ttdeci">As part of the API refactoring and improvements which landed in the Processing API was substantially reworked from the x version This was done in order to allow much of the underlying Processing framework to be ported into allowing algorithms to be written in pure substantial changes are required in order to port existing x Processing algorithms for QGIS x The most significant changes are outlined not GeoAlgorithm For algorithms which operate on features one by consider subclassing the QgsProcessingFeatureBasedAlgorithm class This class allows much of the boilerplate code for looping over features from a vector layer to be bypassed and instead requires implementation of a processFeature method Ensure that your algorithm(or algorithm 's parent class) implements the new pure virtual createInstance(self) call</div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a972bf42397ede51bf0d82a8e2ca21ea2"><div class="ttname"><a href="classQgsAuthCertUtils.html#a972bf42397ede51bf0d82a8e2ca21ea2">QgsAuthCertUtils::certificateIsSslServer</a></div><div class="ttdeci">static bool certificateIsSslServer(const QSslCertificate &amp;cert)</div><div class="ttdoc">Gets whether a certificate is probably used for a SSL server. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01022">qgsauthcertutils.cpp:1022</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441daf922d8831822db3011daa12d3b8bef7e"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441daf922d8831822db3011daa12d3b8bef7e">QgsAuthCertUtils::CRLSigningUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00074">qgsauthcertutils.h:74</a></div></div>
<div class="ttc" id="classQgsApplication_html_a54c2585a8214bc2031f0e11e6b88445a"><div class="ttname"><a href="classQgsApplication.html#a54c2585a8214bc2031f0e11e6b88445a">QgsApplication::pkgDataPath</a></div><div class="ttdeci">static QString pkgDataPath()</div><div class="ttdoc">Returns the common root path of all application data directories. </div><div class="ttdef"><b>Definition:</b> <a href="qgsapplication_8cpp_source.html#l00481">qgsapplication.cpp:481</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a9c3cbaccac44ffd7883a500ebf7c845b"><div class="ttname"><a href="classQgsAuthCertUtils.html#a9c3cbaccac44ffd7883a500ebf7c845b">QgsAuthCertUtils::certsFromString</a></div><div class="ttdeci">static QList&lt; QSslCertificate &gt; certsFromString(const QString &amp;pemtext)</div><div class="ttdoc">Returns a list of concatenated certs from a PEM Base64 text block. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00239">qgsauthcertutils.cpp:239</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ad87fa6f35b409b3bedb3833819d43dec"><div class="ttname"><a href="classQgsAuthCertUtils.html#ad87fa6f35b409b3bedb3833819d43dec">QgsAuthCertUtils::validateCertChain</a></div><div class="ttdeci">static QList&lt; QSslError &gt; validateCertChain(const QList&lt; QSslCertificate &gt; &amp;certificateChain, const QString &amp;hostName=QString(), bool trustRootCa=false)</div><div class="ttdoc">validateCertChain validates the given certificateChain </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01300">qgsauthcertutils.cpp:1300</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a5cd9c87c780de657dd72ed2886e380e0"><div class="ttname"><a href="classQgsAuthCertUtils.html#a5cd9c87c780de657dd72ed2886e380e0">QgsAuthCertUtils::getSslProtocolName</a></div><div class="ttdeci">static QString getSslProtocolName(QSsl::SslProtocol protocol)</div><div class="ttdoc">SSL Protocol name strings per enum. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00036">qgsauthcertutils.cpp:36</a></div></div>
<div class="ttc" id="classQgsLogger_html_add89cf855ccb0bac5c783157f810bea8"><div class="ttname"><a href="classQgsLogger.html#add89cf855ccb0bac5c783157f810bea8">QgsLogger::debugLevel</a></div><div class="ttdeci">static int debugLevel()</div><div class="ttdoc">Reads the environment variable QGIS_DEBUG and converts it to int. </div><div class="ttdef"><b>Definition:</b> <a href="qgslogger_8h_source.html#l00105">qgslogger.h:105</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441da2b9fa844681a557b0bc0e90ba7bc97bb"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da2b9fa844681a557b0bc0e90ba7bc97bb">QgsAuthCertUtils::EmailProtectionUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00072">qgsauthcertutils.h:72</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a93804e12c26c578824074732840856d7"><div class="ttname"><a href="classQgsAuthCertUtils.html#a93804e12c26c578824074732840856d7">QgsAuthCertUtils::certificateIsSslClient</a></div><div class="ttdeci">static bool certificateIsSslClient(const QSslCertificate &amp;cert)</div><div class="ttdoc">Gets whether a certificate is probably used for a client identity. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01143">qgsauthcertutils.cpp:1143</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a21a2226262fa5b14de308a5a40b750d4"><div class="ttname"><a href="classQgsAuthCertUtils.html#a21a2226262fa5b14de308a5a40b750d4">QgsAuthCertUtils::shaHexForCert</a></div><div class="ttdeci">static QString shaHexForCert(const QSslCertificate &amp;cert, bool formatted=false)</div><div class="ttdoc">Gets the sha1 hash for certificate. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00738">qgsauthcertutils.cpp:738</a></div></div>
<div class="ttc" id="classQgsApplication_html_aa879f2f9f0d9d79f1d7968cc0f1b9a6a"><div class="ttname"><a href="classQgsApplication.html#aa879f2f9f0d9d79f1d7968cc0f1b9a6a">QgsApplication::authManager</a></div><div class="ttdeci">static QgsAuthManager * authManager()</div><div class="ttdoc">Returns the application&amp;#39;s authentication manager instance. </div><div class="ttdef"><b>Definition:</b> <a href="qgsapplication_8cpp_source.html#l01157">qgsapplication.cpp:1157</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441dab7bbc9be6a6c9e785bfa0be0faf43c7e"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dab7bbc9be6a6c9e785bfa0be0faf43c7e">QgsAuthCertUtils::TlsServerEvUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00069">qgsauthcertutils.h:69</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ac1d183ba837ef614b379985f0dde7d88"><div class="ttname"><a href="classQgsAuthCertUtils.html#ac1d183ba837ef614b379985f0dde7d88">QgsAuthCertUtils::pkcs12BundleCas</a></div><div class="ttdeci">static QList&lt; QSslCertificate &gt; pkcs12BundleCas(const QString &amp;bundlepath, const QString &amp;bundlepass=QString())</div><div class="ttdoc">Returns list of CA certificates (as QSslCertificate) for a PKCS#12 bundle. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00533">qgsauthcertutils.cpp:533</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_abe90cccf324e3bd5c7f81691140375dd"><div class="ttname"><a href="classQgsAuthCertUtils.html#abe90cccf324e3bd5c7f81691140375dd">QgsAuthCertUtils::CaCertSource</a></div><div class="ttdeci">CaCertSource</div><div class="ttdoc">Type of CA certificate source. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00044">qgsauthcertutils.h:44</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_aa9c721886de725572019df6ec482d993"><div class="ttname"><a href="classQgsAuthCertUtils.html#aa9c721886de725572019df6ec482d993">QgsAuthCertUtils::certIsCurrent</a></div><div class="ttdeci">static bool certIsCurrent(const QSslCertificate &amp;cert)</div><div class="ttdoc">certIsCurrent checks if cert is viable for its not before and not after dates </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01263">qgsauthcertutils.cpp:1263</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441dadb1d63565a06e7b6f9b2fa0937ccca75"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441dadb1d63565a06e7b6f9b2fa0937ccca75">QgsAuthCertUtils::CertAuthorityUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00066">qgsauthcertutils.h:66</a></div></div>
<div class="ttc" id="classQgsPkiBundle_html_acf7fc2977a7dd2f36a33eaab9aa86dde"><div class="ttname"><a href="classQgsPkiBundle.html#acf7fc2977a7dd2f36a33eaab9aa86dde">QgsPkiBundle::caChain</a></div><div class="ttdeci">const QList&lt; QSslCertificate &gt; caChain() const</div><div class="ttdoc">Chain of Certificate Authorities for client certificate. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthconfig_8h_source.html#l00243">qgsauthconfig.h:243</a></div></div>
<div class="ttc" id="qgsauthcertutils_8h_html_a3aed9551d2e236e464ed48227933b371"><div class="ttname"><a href="qgsauthcertutils_8h.html#a3aed9551d2e236e464ed48227933b371">SSL_SUBJECT_INFO</a></div><div class="ttdeci">#define SSL_SUBJECT_INFO(var, prop)</div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00034">qgsauthcertutils.h:34</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a11d4fbb80afe731d222e7184a8b61015"><div class="ttname"><a href="classQgsAuthCertUtils.html#a11d4fbb80afe731d222e7184a8b61015">QgsAuthCertUtils::qcaSignatureAlgorithm</a></div><div class="ttdeci">static QString qcaSignatureAlgorithm(QCA::SignatureAlgorithm algorithm)</div><div class="ttdoc">Certificate signature algorithm strings per enum. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00825">qgsauthcertutils.cpp:825</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_abe90cccf324e3bd5c7f81691140375ddaf93573fbac9d47ce86174add2d629d5e"><div class="ttname"><a href="classQgsAuthCertUtils.html#abe90cccf324e3bd5c7f81691140375ddaf93573fbac9d47ce86174add2d629d5e">QgsAuthCertUtils::FromFile</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00047">qgsauthcertutils.h:47</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_ab5152748d33625a50f6140968348441da28003122de2a6d9f2ab3fa241d6efc8d"><div class="ttname"><a href="classQgsAuthCertUtils.html#ab5152748d33625a50f6140968348441da28003122de2a6d9f2ab3fa241d6efc8d">QgsAuthCertUtils::AnyOrUnspecifiedUsage</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00065">qgsauthcertutils.h:65</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a152a1d7f76e61d9e9caee9dbe646f107"><div class="ttname"><a href="classQgsAuthCertUtils.html#a152a1d7f76e61d9e9caee9dbe646f107">QgsAuthCertUtils::certsGroupedByOrg</a></div><div class="ttdeci">static QMap&lt; QString, QList&lt; QSslCertificate &gt; &gt; certsGroupedByOrg(const QList&lt; QSslCertificate &gt; &amp;certs)</div><div class="ttdoc">Map certificates to their oraganization. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00065">qgsauthcertutils.cpp:65</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a245baf0d84d532415adba1518bff7371"><div class="ttname"><a href="classQgsAuthCertUtils.html#a245baf0d84d532415adba1518bff7371">QgsAuthCertUtils::CertTrustPolicy</a></div><div class="ttdeci">CertTrustPolicy</div><div class="ttdoc">Type of certificate trust policy. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00053">qgsauthcertutils.h:53</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a61767370e1d5d5a2e87193aecc16d9aa"><div class="ttname"><a href="classQgsAuthCertUtils.html#a61767370e1d5d5a2e87193aecc16d9aa">QgsAuthCertUtils::getColonDelimited</a></div><div class="ttdeci">static QString getColonDelimited(const QString &amp;txt)</div><div class="ttdoc">Gets string with colon delimiters every 2 characters. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00725">qgsauthcertutils.cpp:725</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_acb480f364903aba53ecee7f17571defc"><div class="ttname"><a href="classQgsAuthCertUtils.html#acb480f364903aba53ecee7f17571defc">QgsAuthCertUtils::qcaKeyBundle</a></div><div class="ttdeci">static QCA::KeyBundle qcaKeyBundle(const QString &amp;path, const QString &amp;pass)</div><div class="ttdoc">PKI key/cert bundle from file path, e.g. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00780">qgsauthcertutils.cpp:780</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_aded924e7f75d6e374b5a9de81238d478"><div class="ttname"><a href="classQgsAuthCertUtils.html#aded924e7f75d6e374b5a9de81238d478">QgsAuthCertUtils::sslErrorEnumStrings</a></div><div class="ttdeci">static QList&lt; QPair&lt; QSslError::SslError, QString &gt; &gt; sslErrorEnumStrings()</div><div class="ttdoc">Gets short strings describing SSL errors. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l01209">qgsauthcertutils.cpp:1209</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a1ea0bce656b5c6e5978a967ed201c765"><div class="ttname"><a href="classQgsAuthCertUtils.html#a1ea0bce656b5c6e5978a967ed201c765">QgsAuthCertUtils::getCertTrustName</a></div><div class="ttdeci">static QString getCertTrustName(QgsAuthCertUtils::CertTrustPolicy trust)</div><div class="ttdoc">Gets the general name for certificate trust. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00710">qgsauthcertutils.cpp:710</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a245baf0d84d532415adba1518bff7371acdfae79e764aa28175aba1af1c813a44"><div class="ttname"><a href="classQgsAuthCertUtils.html#a245baf0d84d532415adba1518bff7371acdfae79e764aa28175aba1af1c813a44">QgsAuthCertUtils::DefaultTrust</a></div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00055">qgsauthcertutils.h:55</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a2781a4ccfc51cbb78353405dc838e344"><div class="ttname"><a href="classQgsAuthCertUtils.html#a2781a4ccfc51cbb78353405dc838e344">QgsAuthCertUtils::certFromFile</a></div><div class="ttdeci">static QSslCertificate certFromFile(const QString &amp;certpath)</div><div class="ttdoc">Returns the first cert from a PEM or DER formatted file. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00173">qgsauthcertutils.cpp:173</a></div></div>
<div class="ttc" id="qgsauthcertutils_8h_html_ad021424dfb4390157f2f67978975456d"><div class="ttname"><a href="qgsauthcertutils_8h.html#ad021424dfb4390157f2f67978975456d">SSL_ISSUER_INFO</a></div><div class="ttdeci">#define SSL_ISSUER_INFO(var, prop)</div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8h_source.html#l00032">qgsauthcertutils.h:32</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_accfcb812574b479ee8f20cb0c8fbe009"><div class="ttname"><a href="classQgsAuthCertUtils.html#accfcb812574b479ee8f20cb0c8fbe009">QgsAuthCertUtils::getCaSourceName</a></div><div class="ttdeci">static QString getCaSourceName(QgsAuthCertUtils::CaCertSource source, bool single=false)</div><div class="ttdoc">Gets the general name for CA source enum type. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00598">qgsauthcertutils.cpp:598</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a11e1b2b2c9538948503b70a23bc313dc"><div class="ttname"><a href="classQgsAuthCertUtils.html#a11e1b2b2c9538948503b70a23bc313dc">QgsAuthCertUtils::resolvedCertName</a></div><div class="ttdeci">static QString resolvedCertName(const QSslCertificate &amp;cert, bool issuer=false)</div><div class="ttdoc">Gets the general name via RFC 5280 resolution. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00615">qgsauthcertutils.cpp:615</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a0368f502332634f4b27e0967738a0705"><div class="ttname"><a href="classQgsAuthCertUtils.html#a0368f502332634f4b27e0967738a0705">QgsAuthCertUtils::qcaValidityMessage</a></div><div class="ttdeci">static QString qcaValidityMessage(QCA::Validity validity)</div><div class="ttdoc">Certificate validity check messages per enum. </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00792">qgsauthcertutils.cpp:792</a></div></div>
<div class="ttc" id="classQgsAuthCertUtils_html_a5a9589a5cfc3f8578a5c5ed10a6e30e1"><div class="ttname"><a href="classQgsAuthCertUtils.html#a5a9589a5cfc3f8578a5c5ed10a6e30e1">QgsAuthCertUtils::certsToPemText</a></div><div class="ttdeci">static QByteArray certsToPemText(const QList&lt; QSslCertificate &gt; &amp;certs)</div><div class="ttdoc">certsToPemText dump a list of QSslCertificates to PEM text </div><div class="ttdef"><b>Definition:</b> <a href="qgsauthcertutils_8cpp_source.html#l00554">qgsauthcertutils.cpp:554</a></div></div>
<div class="ttc" id="qgslogger_8h_html"><div class="ttname"><a href="qgslogger_8h.html">qgslogger.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 23 2019 03:59:22 for QGIS API Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
