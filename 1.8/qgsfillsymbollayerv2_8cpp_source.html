<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Quantum GIS API Documentation: src/core/symbology-ng/qgsfillsymbollayerv2.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Quantum GIS API Documentation
   &#160;<span id="projectnumber">1.8</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">src/core/symbology-ng/qgsfillsymbollayerv2.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="qgsfillsymbollayerv2_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">    qgsfillsymbollayerv2.cpp</span>
<a name="l00003"></a>00003 <span class="comment">    ---------------------</span>
<a name="l00004"></a>00004 <span class="comment">    begin                : November 2009</span>
<a name="l00005"></a>00005 <span class="comment">    copyright            : (C) 2009 by Martin Dobias</span>
<a name="l00006"></a>00006 <span class="comment">    email                : wonder.sk at gmail.com</span>
<a name="l00007"></a>00007 <span class="comment"> ***************************************************************************</span>
<a name="l00008"></a>00008 <span class="comment"> *                                                                         *</span>
<a name="l00009"></a>00009 <span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span>
<a name="l00010"></a>00010 <span class="comment"> *   it under the terms of the GNU General Public License as published by  *</span>
<a name="l00011"></a>00011 <span class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
<a name="l00012"></a>00012 <span class="comment"> *   (at your option) any later version.                                   *</span>
<a name="l00013"></a>00013 <span class="comment"> *                                                                         *</span>
<a name="l00014"></a>00014 <span class="comment"> ***************************************************************************/</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="qgsfillsymbollayerv2_8h.html">qgsfillsymbollayerv2.h</a>&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="qgsmarkersymbollayerv2_8h.html">qgsmarkersymbollayerv2.h</a>&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;<a class="code" href="qgssymbollayerv2utils_8h.html">qgssymbollayerv2utils.h</a>&quot;</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="qgsrendercontext_8h.html">qgsrendercontext.h</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="qgsproject_8h.html">qgsproject.h</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="qgssvgcache_8h.html">qgssvgcache.h</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="qgslogger_8h.html">qgslogger.h</a>&quot;</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;QPainter&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;QFile&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;QSvgRenderer&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;QDomDocument&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;QDomElement&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a3a8a1b7b87a927e9f43d1648e21dc1dd">00030</a> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a3a8a1b7b87a927e9f43d1648e21dc1dd">QgsSimpleFillSymbolLayerV2::QgsSimpleFillSymbolLayerV2</a>( QColor color, Qt::BrushStyle style, QColor borderColor, Qt::PenStyle borderStyle, <span class="keywordtype">double</span> borderWidth )
<a name="l00031"></a>00031     : mBrushStyle( style ), mBorderColor( borderColor ), mBorderStyle( borderStyle ), mBorderWidth( borderWidth )
<a name="l00032"></a>00032 {
<a name="l00033"></a>00033   <a class="code" href="classQgsSymbolLayerV2.html#a042b3eac41d39f58dd4b7d2126f646de">mColor</a> = <a class="code" href="classQgsSymbolLayerV2.html#a692837dc473ba2b206f8015aca8ec387">color</a>;
<a name="l00034"></a>00034 }
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ae82db30df503099f6e7f53c525b4a85d">00037</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ae82db30df503099f6e7f53c525b4a85d">QgsSimpleFillSymbolLayerV2::create</a>( <span class="keyword">const</span> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a>&amp; props )
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039   QColor <a class="code" href="classQgsSymbolLayerV2.html#a692837dc473ba2b206f8015aca8ec387">color</a> = <a class="code" href="qgsfillsymbollayerv2_8h.html#a502711d3aa9b1d58bc75b2339336eac8">DEFAULT_SIMPLEFILL_COLOR</a>;
<a name="l00040"></a>00040   Qt::BrushStyle style = <a class="code" href="qgsfillsymbollayerv2_8h.html#a53ae00b66da3108aa8a98aee3ef0e9b2">DEFAULT_SIMPLEFILL_STYLE</a>;
<a name="l00041"></a>00041   QColor <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#aef351b6181af6e75e1514527605b992d">borderColor</a> = <a class="code" href="qgsfillsymbollayerv2_8h.html#a7888ccc18f6dde47796ffd00d8523e00">DEFAULT_SIMPLEFILL_BORDERCOLOR</a>;
<a name="l00042"></a>00042   Qt::PenStyle <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ae4df553babef47a5ed3897978c7ff1fa">borderStyle</a> = <a class="code" href="qgsfillsymbollayerv2_8h.html#a734b37544a013ecaa791cd94aa2cc243">DEFAULT_SIMPLEFILL_BORDERSTYLE</a>;
<a name="l00043"></a>00043   <span class="keywordtype">double</span> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a8d8dd673772bfb3aeab3e2f46b4f7216">borderWidth</a> = <a class="code" href="qgsfillsymbollayerv2_8h.html#ab19cda08dcf4f7aaed2294ae0d60dd6a">DEFAULT_SIMPLEFILL_BORDERWIDTH</a>;
<a name="l00044"></a>00044   QPointF <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a5a1c93d3f3b7c4cdfce0f5225968058c">offset</a>;
<a name="l00045"></a>00045 
<a name="l00046"></a>00046   <span class="keywordflow">if</span> ( props.contains( <span class="stringliteral">&quot;color&quot;</span> ) )
<a name="l00047"></a>00047     color = <a class="code" href="classQgsSymbolLayerV2Utils.html#a942f2c54ef1be3c474313ff3739a9aa8">QgsSymbolLayerV2Utils::decodeColor</a>( props[<span class="stringliteral">&quot;color&quot;</span>] );
<a name="l00048"></a>00048   <span class="keywordflow">if</span> ( props.contains( <span class="stringliteral">&quot;style&quot;</span> ) )
<a name="l00049"></a>00049     style = <a class="code" href="classQgsSymbolLayerV2Utils.html#a06545973408623b85f876cd27d6968f8">QgsSymbolLayerV2Utils::decodeBrushStyle</a>( props[<span class="stringliteral">&quot;style&quot;</span>] );
<a name="l00050"></a>00050   <span class="keywordflow">if</span> ( props.contains( <span class="stringliteral">&quot;color_border&quot;</span> ) )
<a name="l00051"></a>00051     borderColor = <a class="code" href="classQgsSymbolLayerV2Utils.html#a942f2c54ef1be3c474313ff3739a9aa8">QgsSymbolLayerV2Utils::decodeColor</a>( props[<span class="stringliteral">&quot;color_border&quot;</span>] );
<a name="l00052"></a>00052   <span class="keywordflow">if</span> ( props.contains( <span class="stringliteral">&quot;style_border&quot;</span> ) )
<a name="l00053"></a>00053     borderStyle = <a class="code" href="classQgsSymbolLayerV2Utils.html#a01dbfedb2d2501595e67f6827f72785b">QgsSymbolLayerV2Utils::decodePenStyle</a>( props[<span class="stringliteral">&quot;style_border&quot;</span>] );
<a name="l00054"></a>00054   <span class="keywordflow">if</span> ( props.contains( <span class="stringliteral">&quot;width_border&quot;</span> ) )
<a name="l00055"></a>00055     borderWidth = props[<span class="stringliteral">&quot;width_border&quot;</span>].toDouble();
<a name="l00056"></a>00056   <span class="keywordflow">if</span> ( props.contains( <span class="stringliteral">&quot;offset&quot;</span> ) )
<a name="l00057"></a>00057     offset = <a class="code" href="classQgsSymbolLayerV2Utils.html#a1709e6b136de7414fcb77c11784e1ad5">QgsSymbolLayerV2Utils::decodePoint</a>( props[<span class="stringliteral">&quot;offset&quot;</span>] );
<a name="l00058"></a>00058 
<a name="l00059"></a>00059   <a class="code" href="classQgsSimpleFillSymbolLayerV2.html">QgsSimpleFillSymbolLayerV2</a>* sl = <span class="keyword">new</span> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a3a8a1b7b87a927e9f43d1648e21dc1dd">QgsSimpleFillSymbolLayerV2</a>( color, style, borderColor, borderStyle, borderWidth );
<a name="l00060"></a>00060   sl-&gt;<a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a0d8c0ecb03961d4915066dba9cdd979a">setOffset</a>( offset );
<a name="l00061"></a>00061   <span class="keywordflow">return</span> sl;
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ab6adcba1aaa4318dcb2dcac2c08bb467">00065</a> QString <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ab6adcba1aaa4318dcb2dcac2c08bb467">QgsSimpleFillSymbolLayerV2::layerType</a>()<span class="keyword"> const</span>
<a name="l00066"></a>00066 <span class="keyword"></span>{
<a name="l00067"></a>00067   <span class="keywordflow">return</span> <span class="stringliteral">&quot;SimpleFill&quot;</span>;
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ac48b505112f62d0ce89a517565fb3964">00070</a> <span class="keywordtype">void</span> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ac48b505112f62d0ce89a517565fb3964">QgsSimpleFillSymbolLayerV2::startRender</a>( <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072   <a class="code" href="classQgsSymbolLayerV2.html#a042b3eac41d39f58dd4b7d2126f646de">mColor</a>.setAlphaF( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a29fa7f8394884b290db8cfa6c67a9434" title="Get alpha transparency 1 for opaque, 0 for invisible.">alpha</a>() );
<a name="l00073"></a>00073   <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a8981a2b60a1a47df381d26782247632f">mBrush</a> = QBrush( <a class="code" href="classQgsSymbolLayerV2.html#a042b3eac41d39f58dd4b7d2126f646de">mColor</a>, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a807957f4a44edb719945da6c1ffca172">mBrushStyle</a> );
<a name="l00074"></a>00074 
<a name="l00075"></a>00075   <span class="comment">// scale brush content for printout</span>
<a name="l00076"></a>00076   <span class="keywordtype">double</span> <a class="code" href="qgssvgcache_8cpp.html#af017b0b421df0bf848537b65b89e34b5">rasterScaleFactor</a> = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a499f7c7cb3dad9ea71f0f3e83760fe0b">rasterScaleFactor</a>();
<a name="l00077"></a>00077   <span class="keywordflow">if</span> ( rasterScaleFactor != 1.0 )
<a name="l00078"></a>00078   {
<a name="l00079"></a>00079     <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a8981a2b60a1a47df381d26782247632f">mBrush</a>.setMatrix( QMatrix().scale( 1.0 / rasterScaleFactor, 1.0 / rasterScaleFactor ) );
<a name="l00080"></a>00080   }
<a name="l00081"></a>00081 
<a name="l00082"></a>00082   QColor selColor = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a250869300bc353d39df6c395a6cc8828">selectionColor</a>();
<a name="l00083"></a>00083   <span class="comment">// selColor.setAlphaF( context.alpha() );</span>
<a name="l00084"></a>00084   <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#acb5b9f78da9d5875fbfe9c75d0b01a1a">mSelBrush</a> = QBrush( selColor );
<a name="l00085"></a>00085   <span class="keywordflow">if</span> ( <a class="code" href="classQgsSymbolLayerV2.html#aebd49b57ff4a1c9aee8a6f804e47df9b">selectFillStyle</a> )
<a name="l00086"></a>00086     <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#acb5b9f78da9d5875fbfe9c75d0b01a1a">mSelBrush</a>.setStyle( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a807957f4a44edb719945da6c1ffca172">mBrushStyle</a> );
<a name="l00087"></a>00087   <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a91513a349d7a4c4ba407bfba5a4bba64">mBorderColor</a>.setAlphaF( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a29fa7f8394884b290db8cfa6c67a9434" title="Get alpha transparency 1 for opaque, 0 for invisible.">alpha</a>() );
<a name="l00088"></a>00088   <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ac7204f6a067b1f60191b0591bc7068b8">mPen</a> = QPen( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a91513a349d7a4c4ba407bfba5a4bba64">mBorderColor</a> );
<a name="l00089"></a>00089   <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ac7204f6a067b1f60191b0591bc7068b8">mPen</a>.setStyle( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a75143090d1bbc32a7e2884ed71776fb5">mBorderStyle</a> );
<a name="l00090"></a>00090   <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ac7204f6a067b1f60191b0591bc7068b8">mPen</a>.setWidthF( context.<a class="code" href="classQgsSymbolV2RenderContext.html#aec3d3c86d84fae975f35345667a5a695">outputLineWidth</a>( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a37880310ce5b8652e5cd1f432b09595e">mBorderWidth</a> ) );
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a><a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a59f7a82e84688bbd762bb502090c1721">00093</a> <span class="keywordtype">void</span> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a59f7a82e84688bbd762bb502090c1721">QgsSimpleFillSymbolLayerV2::stopRender</a>( <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095   Q_UNUSED( context );
<a name="l00096"></a>00096 }
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a907472062ee79023d56868428fffa903">00098</a> <span class="keywordtype">void</span> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a907472062ee79023d56868428fffa903">QgsSimpleFillSymbolLayerV2::renderPolygon</a>( <span class="keyword">const</span> QPolygonF&amp; points, QList&lt;QPolygonF&gt;* rings, <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100   QPainter* p = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a3acf9ad3fc76e62c90db63bf13d7e0fb">painter</a>();
<a name="l00101"></a>00101   <span class="keywordflow">if</span> ( !p )
<a name="l00102"></a>00102   {
<a name="l00103"></a>00103     <span class="keywordflow">return</span>;
<a name="l00104"></a>00104   }
<a name="l00105"></a>00105 
<a name="l00106"></a>00106   p-&gt;setBrush( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7339b8275a3500e3812d470ea87f6c00">selected</a>() ? <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#acb5b9f78da9d5875fbfe9c75d0b01a1a">mSelBrush</a> : <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a8981a2b60a1a47df381d26782247632f">mBrush</a> );
<a name="l00107"></a>00107   p-&gt;setPen( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ac7204f6a067b1f60191b0591bc7068b8">mPen</a> );
<a name="l00108"></a>00108 
<a name="l00109"></a>00109   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a50aff8189fd57bde63010d529fe67c32">mOffset</a>.isNull() )
<a name="l00110"></a>00110     p-&gt;translate( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a50aff8189fd57bde63010d529fe67c32">mOffset</a> );
<a name="l00111"></a>00111 
<a name="l00112"></a>00112   <a class="code" href="classQgsFillSymbolLayerV2.html#a95b74efba3ca5fd79897666e7070d922" title="Default method to render polygon.">_renderPolygon</a>( p, points, rings );
<a name="l00113"></a>00113 
<a name="l00114"></a>00114   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a50aff8189fd57bde63010d529fe67c32">mOffset</a>.isNull() )
<a name="l00115"></a>00115     p-&gt;translate( -<a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a50aff8189fd57bde63010d529fe67c32">mOffset</a> );
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00118"></a><a class="code" href="classQgsSimpleFillSymbolLayerV2.html#acd9b0fcb5999fa86c5c35442d154d56b">00118</a> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#acd9b0fcb5999fa86c5c35442d154d56b">QgsSimpleFillSymbolLayerV2::properties</a>()<span class="keyword"> const</span>
<a name="l00119"></a>00119 <span class="keyword"></span>{
<a name="l00120"></a>00120   <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> map;
<a name="l00121"></a>00121   map[<span class="stringliteral">&quot;color&quot;</span>] = <a class="code" href="classQgsSymbolLayerV2Utils.html#a2d71081dab2d4fc194cd0c5588e66cf1">QgsSymbolLayerV2Utils::encodeColor</a>( <a class="code" href="classQgsSymbolLayerV2.html#a042b3eac41d39f58dd4b7d2126f646de">mColor</a> );
<a name="l00122"></a>00122   map[<span class="stringliteral">&quot;style&quot;</span>] = <a class="code" href="classQgsSymbolLayerV2Utils.html#ab29594d9d687ab2981a26a3cfea9e86b">QgsSymbolLayerV2Utils::encodeBrushStyle</a>( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a807957f4a44edb719945da6c1ffca172">mBrushStyle</a> );
<a name="l00123"></a>00123   map[<span class="stringliteral">&quot;color_border&quot;</span>] = <a class="code" href="classQgsSymbolLayerV2Utils.html#a2d71081dab2d4fc194cd0c5588e66cf1">QgsSymbolLayerV2Utils::encodeColor</a>( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a91513a349d7a4c4ba407bfba5a4bba64">mBorderColor</a> );
<a name="l00124"></a>00124   map[<span class="stringliteral">&quot;style_border&quot;</span>] = <a class="code" href="classQgsSymbolLayerV2Utils.html#a9dfe67cf729b4711a4cc1d0636491b9f">QgsSymbolLayerV2Utils::encodePenStyle</a>( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a75143090d1bbc32a7e2884ed71776fb5">mBorderStyle</a> );
<a name="l00125"></a>00125   map[<span class="stringliteral">&quot;width_border&quot;</span>] = QString::number( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a37880310ce5b8652e5cd1f432b09595e">mBorderWidth</a> );
<a name="l00126"></a>00126   map[<span class="stringliteral">&quot;offset&quot;</span>] = <a class="code" href="classQgsSymbolLayerV2Utils.html#a8ed29d4fe064d67f7071647b53aeb340">QgsSymbolLayerV2Utils::encodePoint</a>( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a50aff8189fd57bde63010d529fe67c32">mOffset</a> );
<a name="l00127"></a>00127   <span class="keywordflow">return</span> map;
<a name="l00128"></a>00128 }
<a name="l00129"></a>00129 
<a name="l00130"></a><a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a8260916d90e08e683fbbd815d88ba59d">00130</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a8260916d90e08e683fbbd815d88ba59d">QgsSimpleFillSymbolLayerV2::clone</a>()<span class="keyword"> const</span>
<a name="l00131"></a>00131 <span class="keyword"></span>{
<a name="l00132"></a>00132   <a class="code" href="classQgsSimpleFillSymbolLayerV2.html">QgsSimpleFillSymbolLayerV2</a>* sl = <span class="keyword">new</span> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a3a8a1b7b87a927e9f43d1648e21dc1dd">QgsSimpleFillSymbolLayerV2</a>( <a class="code" href="classQgsSymbolLayerV2.html#a042b3eac41d39f58dd4b7d2126f646de">mColor</a>, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a807957f4a44edb719945da6c1ffca172">mBrushStyle</a>, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a91513a349d7a4c4ba407bfba5a4bba64">mBorderColor</a>, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a75143090d1bbc32a7e2884ed71776fb5">mBorderStyle</a>, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a37880310ce5b8652e5cd1f432b09595e">mBorderWidth</a> );
<a name="l00133"></a>00133   sl-&gt;<a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a0d8c0ecb03961d4915066dba9cdd979a">setOffset</a>( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a50aff8189fd57bde63010d529fe67c32">mOffset</a> );
<a name="l00134"></a>00134   <span class="keywordflow">return</span> sl;
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00137"></a><a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ac811c9f02212cb7fd421858f2ac266c0">00137</a> <span class="keywordtype">void</span> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ac811c9f02212cb7fd421858f2ac266c0">QgsSimpleFillSymbolLayerV2::toSld</a>( QDomDocument &amp;doc, QDomElement &amp;element, <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> props )<span class="keyword"> const</span>
<a name="l00138"></a>00138 <span class="keyword"></span>{
<a name="l00139"></a>00139   <span class="keywordflow">if</span> ( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a807957f4a44edb719945da6c1ffca172">mBrushStyle</a> == Qt::NoBrush &amp;&amp; <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a75143090d1bbc32a7e2884ed71776fb5">mBorderStyle</a> == Qt::NoPen )
<a name="l00140"></a>00140     <span class="keywordflow">return</span>;
<a name="l00141"></a>00141 
<a name="l00142"></a>00142   QDomElement symbolizerElem = doc.createElement( <span class="stringliteral">&quot;se:PolygonSymbolizer&quot;</span> );
<a name="l00143"></a>00143   <span class="keywordflow">if</span> ( !props.value( <span class="stringliteral">&quot;uom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ).isEmpty() )
<a name="l00144"></a>00144     symbolizerElem.setAttribute( <span class="stringliteral">&quot;uom&quot;</span>, props.value( <span class="stringliteral">&quot;uom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ) );
<a name="l00145"></a>00145   element.appendChild( symbolizerElem );
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <span class="comment">// &lt;Geometry&gt;</span>
<a name="l00148"></a>00148   <a class="code" href="classQgsSymbolLayerV2Utils.html#aa53bd59d50cb727c12380a482632395e">QgsSymbolLayerV2Utils::createGeometryElement</a>( doc, symbolizerElem, props.value( <span class="stringliteral">&quot;geom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ) );
<a name="l00149"></a>00149 
<a name="l00150"></a>00150   <span class="keywordflow">if</span> ( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a807957f4a44edb719945da6c1ffca172">mBrushStyle</a> != Qt::NoBrush )
<a name="l00151"></a>00151   {
<a name="l00152"></a>00152     <span class="comment">// &lt;Fill&gt;</span>
<a name="l00153"></a>00153     QDomElement fillElem = doc.createElement( <span class="stringliteral">&quot;se:Fill&quot;</span> );
<a name="l00154"></a>00154     symbolizerElem.appendChild( fillElem );
<a name="l00155"></a>00155     <a class="code" href="classQgsSymbolLayerV2Utils.html#afc0e7d9bff2d328382539ebb0f4d77d8">QgsSymbolLayerV2Utils::fillToSld</a>( doc, fillElem, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a807957f4a44edb719945da6c1ffca172">mBrushStyle</a>, <a class="code" href="classQgsSymbolLayerV2.html#a042b3eac41d39f58dd4b7d2126f646de">mColor</a> );
<a name="l00156"></a>00156   }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158   <span class="keywordflow">if</span> ( <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a75143090d1bbc32a7e2884ed71776fb5">mBorderStyle</a> != Qt::NoPen )
<a name="l00159"></a>00159   {
<a name="l00160"></a>00160     <span class="comment">// &lt;Stroke&gt;</span>
<a name="l00161"></a>00161     QDomElement strokeElem = doc.createElement( <span class="stringliteral">&quot;se:Stroke&quot;</span> );
<a name="l00162"></a>00162     symbolizerElem.appendChild( strokeElem );
<a name="l00163"></a>00163     <a class="code" href="classQgsSymbolLayerV2Utils.html#a451ca5a764f68ff75de1714cd61589a8">QgsSymbolLayerV2Utils::lineToSld</a>( doc, strokeElem, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a75143090d1bbc32a7e2884ed71776fb5">mBorderStyle</a>, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a91513a349d7a4c4ba407bfba5a4bba64">mBorderColor</a>, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a37880310ce5b8652e5cd1f432b09595e">mBorderWidth</a> );
<a name="l00164"></a>00164   }
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   <span class="comment">// &lt;se:Displacement&gt;</span>
<a name="l00167"></a>00167   <a class="code" href="classQgsSymbolLayerV2Utils.html#af636bf6786998e7df7b88f0b689f5d16">QgsSymbolLayerV2Utils::createDisplacementElement</a>( doc, symbolizerElem, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a50aff8189fd57bde63010d529fe67c32">mOffset</a> );
<a name="l00168"></a>00168 }
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a5352e734ad0037682454d4f1594bf858">00170</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a5352e734ad0037682454d4f1594bf858">QgsSimpleFillSymbolLayerV2::createFromSld</a>( QDomElement &amp;element )
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172   <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( <span class="stringliteral">&quot;Entered.&quot;</span> );
<a name="l00173"></a>00173 
<a name="l00174"></a>00174   QColor <a class="code" href="classQgsSymbolLayerV2.html#a692837dc473ba2b206f8015aca8ec387">color</a>, <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#aef351b6181af6e75e1514527605b992d">borderColor</a>;
<a name="l00175"></a>00175   Qt::BrushStyle fillStyle;
<a name="l00176"></a>00176   Qt::PenStyle <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#ae4df553babef47a5ed3897978c7ff1fa">borderStyle</a>;
<a name="l00177"></a>00177   <span class="keywordtype">double</span> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a8d8dd673772bfb3aeab3e2f46b4f7216">borderWidth</a>;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179   QDomElement fillElem = element.firstChildElement( <span class="stringliteral">&quot;Fill&quot;</span> );
<a name="l00180"></a>00180   <a class="code" href="classQgsSymbolLayerV2Utils.html#a17951a8a1892e8eb75b589caf5d0f8c3">QgsSymbolLayerV2Utils::fillFromSld</a>( fillElem, fillStyle, color );
<a name="l00181"></a>00181 
<a name="l00182"></a>00182   QDomElement strokeElem = element.firstChildElement( <span class="stringliteral">&quot;Stroke&quot;</span> );
<a name="l00183"></a>00183   <a class="code" href="classQgsSymbolLayerV2Utils.html#a3bd88c222c0728508e139cc397580636">QgsSymbolLayerV2Utils::lineFromSld</a>( strokeElem, borderStyle, borderColor, borderWidth );
<a name="l00184"></a>00184 
<a name="l00185"></a>00185   QPointF <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a5a1c93d3f3b7c4cdfce0f5225968058c">offset</a>;
<a name="l00186"></a>00186   <a class="code" href="classQgsSymbolLayerV2Utils.html#aa3dbeae36f4c73eb0dcc68181284582a">QgsSymbolLayerV2Utils::displacementFromSldElement</a>( element, offset );
<a name="l00187"></a>00187 
<a name="l00188"></a>00188   <a class="code" href="classQgsSimpleFillSymbolLayerV2.html">QgsSimpleFillSymbolLayerV2</a>* sl = <span class="keyword">new</span> <a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a3a8a1b7b87a927e9f43d1648e21dc1dd">QgsSimpleFillSymbolLayerV2</a>( color, fillStyle, borderColor, borderStyle, borderWidth );
<a name="l00189"></a>00189   sl-&gt;<a class="code" href="classQgsSimpleFillSymbolLayerV2.html#a0d8c0ecb03961d4915066dba9cdd979a">setOffset</a>( offset );
<a name="l00190"></a>00190   <span class="keywordflow">return</span> sl;
<a name="l00191"></a>00191 }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="comment">//QgsImageFillSymbolLayer</span>
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="classQgsImageFillSymbolLayer.html#a3303fe797191593acf34f4e8790c45d8">00196</a> <a class="code" href="classQgsImageFillSymbolLayer.html#a3303fe797191593acf34f4e8790c45d8">QgsImageFillSymbolLayer::QgsImageFillSymbolLayer</a>(): mOutlineWidth( 0.0 ), mOutline( 0 )
<a name="l00197"></a>00197 {
<a name="l00198"></a>00198   <a class="code" href="classQgsImageFillSymbolLayer.html#a46cdc4fbb82c144b0b9e3afccba5c475">setSubSymbol</a>( <span class="keyword">new</span> <a class="code" href="classQgsLineSymbolV2.html">QgsLineSymbolV2</a>() );
<a name="l00199"></a>00199 }
<a name="l00200"></a>00200 
<a name="l00201"></a><a class="code" href="classQgsImageFillSymbolLayer.html#ace8d16c8cae71f5ff2632408c4c7fb96">00201</a> <a class="code" href="classQgsImageFillSymbolLayer.html#ace8d16c8cae71f5ff2632408c4c7fb96">QgsImageFillSymbolLayer::~QgsImageFillSymbolLayer</a>()
<a name="l00202"></a>00202 {
<a name="l00203"></a>00203 }
<a name="l00204"></a>00204 
<a name="l00205"></a><a class="code" href="classQgsImageFillSymbolLayer.html#aa47c1a196eecb2016a723e8c4a208a3e">00205</a> <span class="keywordtype">void</span> <a class="code" href="classQgsImageFillSymbolLayer.html#aa47c1a196eecb2016a723e8c4a208a3e">QgsImageFillSymbolLayer::renderPolygon</a>( <span class="keyword">const</span> QPolygonF&amp; points, QList&lt;QPolygonF&gt;* rings, <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l00206"></a>00206 {
<a name="l00207"></a>00207   QPainter* p = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a3acf9ad3fc76e62c90db63bf13d7e0fb">painter</a>();
<a name="l00208"></a>00208   <span class="keywordflow">if</span> ( !p )
<a name="l00209"></a>00209   {
<a name="l00210"></a>00210     <span class="keywordflow">return</span>;
<a name="l00211"></a>00211   }
<a name="l00212"></a>00212   p-&gt;setPen( QPen( Qt::NoPen ) );
<a name="l00213"></a>00213   <span class="keywordflow">if</span> ( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7339b8275a3500e3812d470ea87f6c00">selected</a>() )
<a name="l00214"></a>00214   {
<a name="l00215"></a>00215     QColor selColor = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a250869300bc353d39df6c395a6cc8828">selectionColor</a>();
<a name="l00216"></a>00216     <span class="keywordflow">if</span> ( ! <a class="code" href="classQgsSymbolLayerV2.html#a02c0c289a9e91da74c0563baca71992e">selectionIsOpaque</a> )
<a name="l00217"></a>00217       selColor.setAlphaF( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a29fa7f8394884b290db8cfa6c67a9434" title="Get alpha transparency 1 for opaque, 0 for invisible.">alpha</a>() );
<a name="l00218"></a>00218     p-&gt;setBrush( QBrush( selColor ) );
<a name="l00219"></a>00219     <a class="code" href="classQgsFillSymbolLayerV2.html#a95b74efba3ca5fd79897666e7070d922" title="Default method to render polygon.">_renderPolygon</a>( p, points, rings );
<a name="l00220"></a>00220   }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222   <span class="keywordflow">if</span> ( <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsFillSymbolLayerV2.html#acccd5cf4eff0951a05e577cb916e5e04">mAngle</a>, 0.0 ) )
<a name="l00223"></a>00223   {
<a name="l00224"></a>00224     p-&gt;setBrush( <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a> );
<a name="l00225"></a>00225   }
<a name="l00226"></a>00226   <span class="keywordflow">else</span>
<a name="l00227"></a>00227   {
<a name="l00228"></a>00228     QTransform t = <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>.transform();
<a name="l00229"></a>00229     t.rotate( <a class="code" href="classQgsFillSymbolLayerV2.html#acccd5cf4eff0951a05e577cb916e5e04">mAngle</a> );
<a name="l00230"></a>00230     QBrush rotatedBrush = <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>;
<a name="l00231"></a>00231     rotatedBrush.setTransform( t );
<a name="l00232"></a>00232     p-&gt;setBrush( rotatedBrush );
<a name="l00233"></a>00233   }
<a name="l00234"></a>00234   <a class="code" href="classQgsFillSymbolLayerV2.html#a95b74efba3ca5fd79897666e7070d922" title="Default method to render polygon.">_renderPolygon</a>( p, points, rings );
<a name="l00235"></a>00235   <span class="keywordflow">if</span> ( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> )
<a name="l00236"></a>00236   {
<a name="l00237"></a>00237     <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>-&gt;<a class="code" href="classQgsLineSymbolV2.html#a56af6d17ca2a47d6524548de7c27bc07">renderPolyline</a>( points, context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>(), -1, <a class="code" href="classQgsSymbolLayerV2.html#ac74228a9e3001caded0b317eb7573eca">selectFillBorder</a> &amp;&amp; context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7339b8275a3500e3812d470ea87f6c00">selected</a>() );
<a name="l00238"></a>00238     <span class="keywordflow">if</span> ( rings )
<a name="l00239"></a>00239     {
<a name="l00240"></a>00240       QList&lt;QPolygonF&gt;::const_iterator ringIt = rings-&gt;constBegin();
<a name="l00241"></a>00241       <span class="keywordflow">for</span> ( ; ringIt != rings-&gt;constEnd(); ++ringIt )
<a name="l00242"></a>00242       {
<a name="l00243"></a>00243         <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>-&gt;<a class="code" href="classQgsLineSymbolV2.html#a56af6d17ca2a47d6524548de7c27bc07">renderPolyline</a>( *ringIt, context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>(), -1, <a class="code" href="classQgsSymbolLayerV2.html#ac74228a9e3001caded0b317eb7573eca">selectFillBorder</a> &amp;&amp; context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7339b8275a3500e3812d470ea87f6c00">selected</a>() );
<a name="l00244"></a>00244       }
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246   }
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a><a class="code" href="classQgsImageFillSymbolLayer.html#a46cdc4fbb82c144b0b9e3afccba5c475">00249</a> <span class="keywordtype">bool</span> <a class="code" href="classQgsImageFillSymbolLayer.html#a46cdc4fbb82c144b0b9e3afccba5c475">QgsImageFillSymbolLayer::setSubSymbol</a>( <a class="code" href="classQgsSymbolV2.html">QgsSymbolV2</a>* symbol )
<a name="l00250"></a>00250 {
<a name="l00251"></a>00251   <span class="keywordflow">if</span> ( !symbol ) <span class="comment">//unset current outline</span>
<a name="l00252"></a>00252   {
<a name="l00253"></a>00253     <span class="keyword">delete</span> <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>;
<a name="l00254"></a>00254     <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> = 0;
<a name="l00255"></a>00255     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00256"></a>00256   }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258   <span class="keywordflow">if</span> ( symbol-&gt;<a class="code" href="classQgsSymbolV2.html#aa582dfed1c81b5714a5e219d2612d171">type</a>() != <a class="code" href="classQgsSymbolV2.html#a5d1dc41b5e445d244383f02a237e95ddaad15218ce2c6269c707ae0dd9ba50481">QgsSymbolV2::Line</a> )
<a name="l00259"></a>00259   {
<a name="l00260"></a>00260     <span class="keyword">delete</span> symbol;
<a name="l00261"></a>00261     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00262"></a>00262   }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264   <a class="code" href="classQgsLineSymbolV2.html">QgsLineSymbolV2</a>* lineSymbol = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classQgsLineSymbolV2.html">QgsLineSymbolV2</a>*<span class="keyword">&gt;</span>( symbol );
<a name="l00265"></a>00265   <span class="keywordflow">if</span> ( lineSymbol )
<a name="l00266"></a>00266   {
<a name="l00267"></a>00267     <span class="keyword">delete</span> <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>;
<a name="l00268"></a>00268     <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> = lineSymbol;
<a name="l00269"></a>00269     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00270"></a>00270   }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272   <span class="keyword">delete</span> symbol;
<a name="l00273"></a>00273   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 <span class="comment">//QgsSVGFillSymbolLayer</span>
<a name="l00277"></a>00277 
<a name="l00278"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a1c7088c192f7da22c98a90ca97bdb409">00278</a> <a class="code" href="classQgsSVGFillSymbolLayer.html#a1c7088c192f7da22c98a90ca97bdb409">QgsSVGFillSymbolLayer::QgsSVGFillSymbolLayer</a>( <span class="keyword">const</span> QString&amp; svgFilePath, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> <a class="code" href="namespaceMathUtils.html#ad8c3e8d699ab12a55e6883baa6b65c6b" title="Calculates the angle between two segments (in 2 dimension, z-values are ignored)">angle</a> ): <a class="code" href="classQgsImageFillSymbolLayer.html" title="Base class for polygon renderers generating texture images.">QgsImageFillSymbolLayer</a>(), mPatternWidth( width )
<a name="l00279"></a>00279 {
<a name="l00280"></a>00280   <a class="code" href="classQgsSVGFillSymbolLayer.html#a89488438558c465cb10d74ae95dc1cd8">setSvgFilePath</a>( svgFilePath );
<a name="l00281"></a>00281   <a class="code" href="classQgsImageFillSymbolLayer.html#a0bda0327b326fe1275bbe985a1b7b414" title="Outline width.">mOutlineWidth</a> = 0.3;
<a name="l00282"></a>00282   <a class="code" href="classQgsFillSymbolLayerV2.html#acccd5cf4eff0951a05e577cb916e5e04">mAngle</a> = <a class="code" href="classQgsFillSymbolLayerV2.html#ab46dcc73dc9c60027259e7266a6b50ca">angle</a>;
<a name="l00283"></a>00283   <a class="code" href="classQgsSVGFillSymbolLayer.html#ad73566b84a7f9cb203e17d74e237b410">setDefaultSvgParams</a>();
<a name="l00284"></a>00284 }
<a name="l00285"></a>00285 
<a name="l00286"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a9ec56c99fe663fdecccb2dfa87c0641b">00286</a> <a class="code" href="classQgsSVGFillSymbolLayer.html#a1c7088c192f7da22c98a90ca97bdb409">QgsSVGFillSymbolLayer::QgsSVGFillSymbolLayer</a>( <span class="keyword">const</span> QByteArray&amp; svgData, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> <a class="code" href="namespaceMathUtils.html#ad8c3e8d699ab12a55e6883baa6b65c6b" title="Calculates the angle between two segments (in 2 dimension, z-values are ignored)">angle</a> ): <a class="code" href="classQgsImageFillSymbolLayer.html" title="Base class for polygon renderers generating texture images.">QgsImageFillSymbolLayer</a>(), mPatternWidth( width ),
<a name="l00287"></a>00287     mSvgData( svgData )
<a name="l00288"></a>00288 {
<a name="l00289"></a>00289   <a class="code" href="classQgsSVGFillSymbolLayer.html#a27479489deb21d0304e98ac15b3e4384" title="Helper function that gets the view box from the byte array.">storeViewBox</a>();
<a name="l00290"></a>00290   <a class="code" href="classQgsImageFillSymbolLayer.html#a0bda0327b326fe1275bbe985a1b7b414" title="Outline width.">mOutlineWidth</a> = 0.3;
<a name="l00291"></a>00291   <a class="code" href="classQgsFillSymbolLayerV2.html#acccd5cf4eff0951a05e577cb916e5e04">mAngle</a> = <a class="code" href="classQgsFillSymbolLayerV2.html#ab46dcc73dc9c60027259e7266a6b50ca">angle</a>;
<a name="l00292"></a>00292   <a class="code" href="classQgsImageFillSymbolLayer.html#a46cdc4fbb82c144b0b9e3afccba5c475">setSubSymbol</a>( <span class="keyword">new</span> <a class="code" href="classQgsLineSymbolV2.html">QgsLineSymbolV2</a>() );
<a name="l00293"></a>00293   <a class="code" href="classQgsSVGFillSymbolLayer.html#ad73566b84a7f9cb203e17d74e237b410">setDefaultSvgParams</a>();
<a name="l00294"></a>00294 }
<a name="l00295"></a>00295 
<a name="l00296"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a2d0aacdf800f4c54453bed2894a5238c">00296</a> <a class="code" href="classQgsSVGFillSymbolLayer.html#a2d0aacdf800f4c54453bed2894a5238c">QgsSVGFillSymbolLayer::~QgsSVGFillSymbolLayer</a>()
<a name="l00297"></a>00297 {
<a name="l00298"></a>00298   <span class="keyword">delete</span> <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>;
<a name="l00299"></a>00299 }
<a name="l00300"></a>00300 
<a name="l00301"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a89488438558c465cb10d74ae95dc1cd8">00301</a> <span class="keywordtype">void</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#a89488438558c465cb10d74ae95dc1cd8">QgsSVGFillSymbolLayer::setSvgFilePath</a>( <span class="keyword">const</span> QString&amp; svgPath )
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303   QFile svgFile( svgPath );
<a name="l00304"></a>00304   <span class="keywordflow">if</span> ( svgFile.open( QFile::ReadOnly ) )
<a name="l00305"></a>00305   {
<a name="l00306"></a>00306     <a class="code" href="classQgsSVGFillSymbolLayer.html#a4da7e5391ecfffa49582c9f24c259714" title="SVG data.">mSvgData</a> = svgFile.readAll();
<a name="l00307"></a>00307 
<a name="l00308"></a>00308     <a class="code" href="classQgsSVGFillSymbolLayer.html#a27479489deb21d0304e98ac15b3e4384" title="Helper function that gets the view box from the byte array.">storeViewBox</a>();
<a name="l00309"></a>00309   }
<a name="l00310"></a>00310   <a class="code" href="classQgsSVGFillSymbolLayer.html#aaedf7a2b2aa65d5af85ed2c43a7f6962" title="Path to the svg file (or empty if constructed directly from data)">mSvgFilePath</a> = svgPath;
<a name="l00311"></a>00311   <a class="code" href="classQgsSVGFillSymbolLayer.html#ad73566b84a7f9cb203e17d74e237b410">setDefaultSvgParams</a>();
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 
<a name="l00314"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a429453b4ea1e043f1acabf43f394f954">00314</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsSVGFillSymbolLayer.html#a429453b4ea1e043f1acabf43f394f954">QgsSVGFillSymbolLayer::create</a>( <span class="keyword">const</span> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a>&amp; properties )
<a name="l00315"></a>00315 {
<a name="l00316"></a>00316   QByteArray data;
<a name="l00317"></a>00317   <span class="keywordtype">double</span> width = 20;
<a name="l00318"></a>00318   QString <a class="code" href="classQgsSVGFillSymbolLayer.html#a07823c64d0327dac0e2d6ad7b85141c8">svgFilePath</a>;
<a name="l00319"></a>00319   <span class="keywordtype">double</span> <a class="code" href="classQgsFillSymbolLayerV2.html#ab46dcc73dc9c60027259e7266a6b50ca">angle</a> = 0.0;
<a name="l00320"></a>00320 
<a name="l00321"></a>00321   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;width&quot;</span> ) )
<a name="l00322"></a>00322   {
<a name="l00323"></a>00323     width = properties[<span class="stringliteral">&quot;width&quot;</span>].toDouble();
<a name="l00324"></a>00324   }
<a name="l00325"></a>00325   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;svgFile&quot;</span> ) )
<a name="l00326"></a>00326   {
<a name="l00327"></a>00327     QString svgName = properties[<span class="stringliteral">&quot;svgFile&quot;</span>];
<a name="l00328"></a>00328     QString savePath = <a class="code" href="classQgsSvgMarkerSymbolLayerV2.html#ada229da6bb5db51c2a574b5b91062e08" title="Get symbol&#39;s path from its name.">QgsSvgMarkerSymbolLayerV2::symbolNameToPath</a>( svgName );
<a name="l00329"></a>00329     svgFilePath = ( savePath.isEmpty() ? svgName : savePath );
<a name="l00330"></a>00330   }
<a name="l00331"></a>00331   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;angle&quot;</span> ) )
<a name="l00332"></a>00332   {
<a name="l00333"></a>00333     angle = properties[<span class="stringliteral">&quot;angle&quot;</span>].toDouble();
<a name="l00334"></a>00334   }
<a name="l00335"></a>00335 
<a name="l00336"></a>00336   <a class="code" href="classQgsSVGFillSymbolLayer.html" title="A class for svg fill patterns.">QgsSVGFillSymbolLayer</a>* symbolLayer = 0;
<a name="l00337"></a>00337   <span class="keywordflow">if</span> ( !svgFilePath.isEmpty() )
<a name="l00338"></a>00338   {
<a name="l00339"></a>00339     symbolLayer = <span class="keyword">new</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#a1c7088c192f7da22c98a90ca97bdb409">QgsSVGFillSymbolLayer</a>( svgFilePath, width, angle );
<a name="l00340"></a>00340   }
<a name="l00341"></a>00341   <span class="keywordflow">else</span>
<a name="l00342"></a>00342   {
<a name="l00343"></a>00343     <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;data&quot;</span> ) )
<a name="l00344"></a>00344     {
<a name="l00345"></a>00345       data = QByteArray::fromHex( properties[<span class="stringliteral">&quot;data&quot;</span>].toLocal8Bit() );
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347     symbolLayer = <span class="keyword">new</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#a1c7088c192f7da22c98a90ca97bdb409">QgsSVGFillSymbolLayer</a>( data, width, angle );
<a name="l00348"></a>00348   }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350   <span class="comment">//svg parameters</span>
<a name="l00351"></a>00351   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;svgFillColor&quot;</span> ) )
<a name="l00352"></a>00352   {
<a name="l00353"></a>00353     symbolLayer-&gt;<a class="code" href="classQgsSVGFillSymbolLayer.html#a516a7565c5686069db09ca15733b9750">setSvgFillColor</a>( QColor( properties[<span class="stringliteral">&quot;svgFillColor&quot;</span>] ) );
<a name="l00354"></a>00354   }
<a name="l00355"></a>00355   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;svgOutlineColor&quot;</span> ) )
<a name="l00356"></a>00356   {
<a name="l00357"></a>00357     symbolLayer-&gt;<a class="code" href="classQgsSVGFillSymbolLayer.html#afb1b852bd2ffbf1ca568c11baec90900">setSvgOutlineColor</a>( QColor( properties[<span class="stringliteral">&quot;svgOutlineColor&quot;</span>] ) );
<a name="l00358"></a>00358   }
<a name="l00359"></a>00359   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;svgOutlineWidth&quot;</span> ) )
<a name="l00360"></a>00360   {
<a name="l00361"></a>00361     symbolLayer-&gt;<a class="code" href="classQgsSVGFillSymbolLayer.html#a1fc3ce01376348b1845ce81feea59021">setSvgOutlineWidth</a>( properties[<span class="stringliteral">&quot;svgOutlineWidth&quot;</span>].toDouble() );
<a name="l00362"></a>00362   }
<a name="l00363"></a>00363 
<a name="l00364"></a>00364 
<a name="l00365"></a>00365   <span class="keywordflow">return</span> symbolLayer;
<a name="l00366"></a>00366 }
<a name="l00367"></a>00367 
<a name="l00368"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a06c827f94fa08d6db137ec119ad83df9">00368</a> QString <a class="code" href="classQgsSVGFillSymbolLayer.html#a06c827f94fa08d6db137ec119ad83df9">QgsSVGFillSymbolLayer::layerType</a>()<span class="keyword"> const</span>
<a name="l00369"></a>00369 <span class="keyword"></span>{
<a name="l00370"></a>00370   <span class="keywordflow">return</span> <span class="stringliteral">&quot;SVGFill&quot;</span>;
<a name="l00371"></a>00371 }
<a name="l00372"></a>00372 
<a name="l00373"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a08b10e3e3cdbf96b1b7ac9c58457c41b">00373</a> <span class="keywordtype">void</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#a08b10e3e3cdbf96b1b7ac9c58457c41b">QgsSVGFillSymbolLayer::startRender</a>( <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l00374"></a>00374 {
<a name="l00375"></a>00375   <span class="keywordflow">if</span> ( <a class="code" href="classQgsSVGFillSymbolLayer.html#a6b6c67caf2d1ed9c3235032044f9217b" title="SVG view box (to keep the aspect ratio.">mSvgViewBox</a>.isNull() )
<a name="l00376"></a>00376   {
<a name="l00377"></a>00377     <span class="keywordflow">return</span>;
<a name="l00378"></a>00378   }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380   <span class="keywordtype">int</span> <a class="code" href="qgssvgcache_8cpp.html#aba3c5d750d5dbd6e86c11ecaca62885e">size</a> = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a0abd301edb92a70755ccd288b589aec6">outputPixelSize</a>( <a class="code" href="classQgsSVGFillSymbolLayer.html#abe3b117941058a3bc4e2e254f03b5ca7" title="Width of the pattern (in QgsSymbolV2 output units)">mPatternWidth</a> );
<a name="l00381"></a>00381   <span class="keyword">const</span> QImage&amp; patternImage = <a class="code" href="classQgsSvgCache.html#a4903ea3275a2d0335227a9fba37bba66">QgsSvgCache::instance</a>()-&gt;<a class="code" href="classQgsSvgCache.html#a0ab9c72b226294a4e5b249c3b8d5aff7">svgAsImage</a>( <a class="code" href="classQgsSVGFillSymbolLayer.html#aaedf7a2b2aa65d5af85ed2c43a7f6962" title="Path to the svg file (or empty if constructed directly from data)">mSvgFilePath</a>, size, <a class="code" href="classQgsSVGFillSymbolLayer.html#a3031d784b930bb003f960dccd780fcd3">mSvgFillColor</a>, <a class="code" href="classQgsSVGFillSymbolLayer.html#af241dc3e3effc02007fed4b314801c6e">mSvgOutlineColor</a>, <a class="code" href="classQgsSVGFillSymbolLayer.html#aba08113e38f45171d951cf563b079577">mSvgOutlineWidth</a>,
<a name="l00382"></a>00382                                context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#af4b93052d1a48544b5cd7103a7596acb">scaleFactor</a>(), context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a499f7c7cb3dad9ea71f0f3e83760fe0b">rasterScaleFactor</a>() );
<a name="l00383"></a>00383   QTransform brushTransform;
<a name="l00384"></a>00384   brushTransform.scale( 1.0 / context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a499f7c7cb3dad9ea71f0f3e83760fe0b">rasterScaleFactor</a>(), 1.0 / context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a499f7c7cb3dad9ea71f0f3e83760fe0b">rasterScaleFactor</a>() );
<a name="l00385"></a>00385   <span class="keywordflow">if</span> ( !<a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a29fa7f8394884b290db8cfa6c67a9434" title="Get alpha transparency 1 for opaque, 0 for invisible.">alpha</a>(), 1.0 ) )
<a name="l00386"></a>00386   {
<a name="l00387"></a>00387     QImage transparentImage = patternImage.copy();
<a name="l00388"></a>00388     <a class="code" href="classQgsSymbolLayerV2Utils.html#acca307af6bd85500a8308b921589bfac" title="Multiplies opacity of image pixel values with a (global) transparency value.">QgsSymbolLayerV2Utils::multiplyImageOpacity</a>( &amp;transparentImage, context.<a class="code" href="classQgsSymbolV2RenderContext.html#a29fa7f8394884b290db8cfa6c67a9434" title="Get alpha transparency 1 for opaque, 0 for invisible.">alpha</a>() );
<a name="l00389"></a>00389     <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>.setTextureImage( transparentImage );
<a name="l00390"></a>00390   }
<a name="l00391"></a>00391   <span class="keywordflow">else</span>
<a name="l00392"></a>00392   {
<a name="l00393"></a>00393     <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>.setTextureImage( patternImage );
<a name="l00394"></a>00394   }
<a name="l00395"></a>00395   <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>.setTransform( brushTransform );
<a name="l00396"></a>00396 
<a name="l00397"></a>00397   <span class="keywordflow">if</span> ( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> )
<a name="l00398"></a>00398   {
<a name="l00399"></a>00399     <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ad21008f16311e5b103310c555085e795">startRender</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>() );
<a name="l00400"></a>00400   }
<a name="l00401"></a>00401 }
<a name="l00402"></a>00402 
<a name="l00403"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a36b4b8e11080b9eff3a2999c96bfbe99">00403</a> <span class="keywordtype">void</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#a36b4b8e11080b9eff3a2999c96bfbe99">QgsSVGFillSymbolLayer::stopRender</a>( <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l00404"></a>00404 {
<a name="l00405"></a>00405   <span class="keywordflow">if</span> ( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> )
<a name="l00406"></a>00406   {
<a name="l00407"></a>00407     <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ab70bbea2b61fb9e734766f265f6625df">stopRender</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>() );
<a name="l00408"></a>00408   }
<a name="l00409"></a>00409 }
<a name="l00410"></a>00410 
<a name="l00411"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a2337497961d4510cf002a1851c4e3627">00411</a> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> <a class="code" href="classQgsSVGFillSymbolLayer.html#a2337497961d4510cf002a1851c4e3627">QgsSVGFillSymbolLayer::properties</a>()<span class="keyword"> const</span>
<a name="l00412"></a>00412 <span class="keyword"></span>{
<a name="l00413"></a>00413   <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> map;
<a name="l00414"></a>00414   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsSVGFillSymbolLayer.html#aaedf7a2b2aa65d5af85ed2c43a7f6962" title="Path to the svg file (or empty if constructed directly from data)">mSvgFilePath</a>.isEmpty() )
<a name="l00415"></a>00415   {
<a name="l00416"></a>00416     map.insert( <span class="stringliteral">&quot;svgFile&quot;</span>, <a class="code" href="classQgsSvgMarkerSymbolLayerV2.html#ab7ae31239a87a2ea1748a4972ad65ecc" title="Get symbols&#39;s name from its path.">QgsSvgMarkerSymbolLayerV2::symbolPathToName</a>( <a class="code" href="classQgsSVGFillSymbolLayer.html#aaedf7a2b2aa65d5af85ed2c43a7f6962" title="Path to the svg file (or empty if constructed directly from data)">mSvgFilePath</a> ) );
<a name="l00417"></a>00417   }
<a name="l00418"></a>00418   <span class="keywordflow">else</span>
<a name="l00419"></a>00419   {
<a name="l00420"></a>00420     map.insert( <span class="stringliteral">&quot;data&quot;</span>, QString( <a class="code" href="classQgsSVGFillSymbolLayer.html#a4da7e5391ecfffa49582c9f24c259714" title="SVG data.">mSvgData</a>.toHex() ) );
<a name="l00421"></a>00421   }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423   map.insert( <span class="stringliteral">&quot;width&quot;</span>, QString::number( <a class="code" href="classQgsSVGFillSymbolLayer.html#abe3b117941058a3bc4e2e254f03b5ca7" title="Width of the pattern (in QgsSymbolV2 output units)">mPatternWidth</a> ) );
<a name="l00424"></a>00424   map.insert( <span class="stringliteral">&quot;angle&quot;</span>, QString::number( <a class="code" href="classQgsFillSymbolLayerV2.html#acccd5cf4eff0951a05e577cb916e5e04">mAngle</a> ) );
<a name="l00425"></a>00425 
<a name="l00426"></a>00426   <span class="comment">//svg parameters</span>
<a name="l00427"></a>00427   map.insert( <span class="stringliteral">&quot;svgFillColor&quot;</span>, <a class="code" href="classQgsSVGFillSymbolLayer.html#a3031d784b930bb003f960dccd780fcd3">mSvgFillColor</a>.name() );
<a name="l00428"></a>00428   map.insert( <span class="stringliteral">&quot;svgOutlineColor&quot;</span>, <a class="code" href="classQgsSVGFillSymbolLayer.html#af241dc3e3effc02007fed4b314801c6e">mSvgOutlineColor</a>.name() );
<a name="l00429"></a>00429   map.insert( <span class="stringliteral">&quot;svgOutlineWidth&quot;</span>, QString::number( <a class="code" href="classQgsSVGFillSymbolLayer.html#aba08113e38f45171d951cf563b079577">mSvgOutlineWidth</a> ) );
<a name="l00430"></a>00430 
<a name="l00431"></a>00431   <span class="keywordflow">return</span> map;
<a name="l00432"></a>00432 }
<a name="l00433"></a>00433 
<a name="l00434"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a1302880608ccb0b1883ec056cce7e5af">00434</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsSVGFillSymbolLayer.html#a1302880608ccb0b1883ec056cce7e5af">QgsSVGFillSymbolLayer::clone</a>()<span class="keyword"> const</span>
<a name="l00435"></a>00435 <span class="keyword"></span>{
<a name="l00436"></a>00436   <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* clonedLayer = 0;
<a name="l00437"></a>00437   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsSVGFillSymbolLayer.html#aaedf7a2b2aa65d5af85ed2c43a7f6962" title="Path to the svg file (or empty if constructed directly from data)">mSvgFilePath</a>.isEmpty() )
<a name="l00438"></a>00438   {
<a name="l00439"></a>00439     clonedLayer = <span class="keyword">new</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#a1c7088c192f7da22c98a90ca97bdb409">QgsSVGFillSymbolLayer</a>( <a class="code" href="classQgsSVGFillSymbolLayer.html#aaedf7a2b2aa65d5af85ed2c43a7f6962" title="Path to the svg file (or empty if constructed directly from data)">mSvgFilePath</a>, <a class="code" href="classQgsSVGFillSymbolLayer.html#abe3b117941058a3bc4e2e254f03b5ca7" title="Width of the pattern (in QgsSymbolV2 output units)">mPatternWidth</a>, <a class="code" href="classQgsFillSymbolLayerV2.html#acccd5cf4eff0951a05e577cb916e5e04">mAngle</a> );
<a name="l00440"></a>00440     <a class="code" href="classQgsSVGFillSymbolLayer.html" title="A class for svg fill patterns.">QgsSVGFillSymbolLayer</a>* sl = <span class="keyword">static_cast&lt;</span><a class="code" href="classQgsSVGFillSymbolLayer.html" title="A class for svg fill patterns.">QgsSVGFillSymbolLayer</a>*<span class="keyword">&gt;</span>( clonedLayer );
<a name="l00441"></a>00441     sl-&gt;<a class="code" href="classQgsSVGFillSymbolLayer.html#a516a7565c5686069db09ca15733b9750">setSvgFillColor</a>( <a class="code" href="classQgsSVGFillSymbolLayer.html#a3031d784b930bb003f960dccd780fcd3">mSvgFillColor</a> );
<a name="l00442"></a>00442     sl-&gt;<a class="code" href="classQgsSVGFillSymbolLayer.html#afb1b852bd2ffbf1ca568c11baec90900">setSvgOutlineColor</a>( <a class="code" href="classQgsSVGFillSymbolLayer.html#af241dc3e3effc02007fed4b314801c6e">mSvgOutlineColor</a> );
<a name="l00443"></a>00443     sl-&gt;<a class="code" href="classQgsSVGFillSymbolLayer.html#a1fc3ce01376348b1845ce81feea59021">setSvgOutlineWidth</a>( <a class="code" href="classQgsSVGFillSymbolLayer.html#aba08113e38f45171d951cf563b079577">mSvgOutlineWidth</a> );
<a name="l00444"></a>00444   }
<a name="l00445"></a>00445   <span class="keywordflow">else</span>
<a name="l00446"></a>00446   {
<a name="l00447"></a>00447     clonedLayer = <span class="keyword">new</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#a1c7088c192f7da22c98a90ca97bdb409">QgsSVGFillSymbolLayer</a>( <a class="code" href="classQgsSVGFillSymbolLayer.html#a4da7e5391ecfffa49582c9f24c259714" title="SVG data.">mSvgData</a>, <a class="code" href="classQgsSVGFillSymbolLayer.html#abe3b117941058a3bc4e2e254f03b5ca7" title="Width of the pattern (in QgsSymbolV2 output units)">mPatternWidth</a>, <a class="code" href="classQgsFillSymbolLayerV2.html#acccd5cf4eff0951a05e577cb916e5e04">mAngle</a> );
<a name="l00448"></a>00448   }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450   <span class="keywordflow">if</span> ( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> )
<a name="l00451"></a>00451   {
<a name="l00452"></a>00452     clonedLayer-&gt;<a class="code" href="classQgsSymbolLayerV2.html#a7c473878e17645082e8be7b7d2f3c6e4">setSubSymbol</a>( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>-&gt;<a class="code" href="classQgsLineSymbolV2.html#a00f5a9bdcb8b548f0d7df4ab51dd46fd">clone</a>() );
<a name="l00453"></a>00453   }
<a name="l00454"></a>00454   <span class="keywordflow">return</span> clonedLayer;
<a name="l00455"></a>00455 }
<a name="l00456"></a>00456 
<a name="l00457"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a0049268cdc5453044e4a413403889223">00457</a> <span class="keywordtype">void</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#a0049268cdc5453044e4a413403889223">QgsSVGFillSymbolLayer::toSld</a>( QDomDocument &amp;doc, QDomElement &amp;element, <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> props )<span class="keyword"> const</span>
<a name="l00458"></a>00458 <span class="keyword"></span>{
<a name="l00459"></a>00459   QDomElement symbolizerElem = doc.createElement( <span class="stringliteral">&quot;se:PolygonSymbolizer&quot;</span> );
<a name="l00460"></a>00460   <span class="keywordflow">if</span> ( !props.value( <span class="stringliteral">&quot;uom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ).isEmpty() )
<a name="l00461"></a>00461     symbolizerElem.setAttribute( <span class="stringliteral">&quot;uom&quot;</span>, props.value( <span class="stringliteral">&quot;uom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ) );
<a name="l00462"></a>00462   element.appendChild( symbolizerElem );
<a name="l00463"></a>00463 
<a name="l00464"></a>00464   <a class="code" href="classQgsSymbolLayerV2Utils.html#aa53bd59d50cb727c12380a482632395e">QgsSymbolLayerV2Utils::createGeometryElement</a>( doc, symbolizerElem, props.value( <span class="stringliteral">&quot;geom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ) );
<a name="l00465"></a>00465 
<a name="l00466"></a>00466   QDomElement fillElem = doc.createElement( <span class="stringliteral">&quot;se:Fill&quot;</span> );
<a name="l00467"></a>00467   symbolizerElem.appendChild( fillElem );
<a name="l00468"></a>00468 
<a name="l00469"></a>00469   QDomElement graphicFillElem = doc.createElement( <span class="stringliteral">&quot;se:GraphicFill&quot;</span> );
<a name="l00470"></a>00470   fillElem.appendChild( graphicFillElem );
<a name="l00471"></a>00471 
<a name="l00472"></a>00472   QDomElement graphicElem = doc.createElement( <span class="stringliteral">&quot;se:Graphic&quot;</span> );
<a name="l00473"></a>00473   graphicFillElem.appendChild( graphicElem );
<a name="l00474"></a>00474 
<a name="l00475"></a>00475   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsSVGFillSymbolLayer.html#aaedf7a2b2aa65d5af85ed2c43a7f6962" title="Path to the svg file (or empty if constructed directly from data)">mSvgFilePath</a>.isEmpty() )
<a name="l00476"></a>00476   {
<a name="l00477"></a>00477     <a class="code" href="classQgsSymbolLayerV2Utils.html#a65160043e7a3ba4e4f744e364c447343">QgsSymbolLayerV2Utils::externalGraphicToSld</a>( doc, graphicElem, <a class="code" href="classQgsSVGFillSymbolLayer.html#aaedf7a2b2aa65d5af85ed2c43a7f6962" title="Path to the svg file (or empty if constructed directly from data)">mSvgFilePath</a>, <span class="stringliteral">&quot;image/svg+xml&quot;</span>, <a class="code" href="classQgsSVGFillSymbolLayer.html#a3031d784b930bb003f960dccd780fcd3">mSvgFillColor</a>, <a class="code" href="classQgsSVGFillSymbolLayer.html#abe3b117941058a3bc4e2e254f03b5ca7" title="Width of the pattern (in QgsSymbolV2 output units)">mPatternWidth</a> );
<a name="l00478"></a>00478   }
<a name="l00479"></a>00479   <span class="keywordflow">else</span>
<a name="l00480"></a>00480   {
<a name="l00481"></a>00481     <span class="comment">// TODO: create svg from data</span>
<a name="l00482"></a>00482     <span class="comment">// &lt;se:InlineContent&gt;</span>
<a name="l00483"></a>00483     symbolizerElem.appendChild( doc.createComment( <span class="stringliteral">&quot;SVG from data not implemented yet&quot;</span> ) );
<a name="l00484"></a>00484   }
<a name="l00485"></a>00485 
<a name="l00486"></a>00486   <span class="keywordflow">if</span> ( <a class="code" href="classQgsSVGFillSymbolLayer.html#af241dc3e3effc02007fed4b314801c6e">mSvgOutlineColor</a>.isValid() || <a class="code" href="classQgsSVGFillSymbolLayer.html#aba08113e38f45171d951cf563b079577">mSvgOutlineWidth</a> &gt;= 0 )
<a name="l00487"></a>00487   {
<a name="l00488"></a>00488     <a class="code" href="classQgsSymbolLayerV2Utils.html#a451ca5a764f68ff75de1714cd61589a8">QgsSymbolLayerV2Utils::lineToSld</a>( doc, graphicElem, Qt::SolidLine, <a class="code" href="classQgsSVGFillSymbolLayer.html#af241dc3e3effc02007fed4b314801c6e">mSvgOutlineColor</a>, <a class="code" href="classQgsSVGFillSymbolLayer.html#aba08113e38f45171d951cf563b079577">mSvgOutlineWidth</a> );
<a name="l00489"></a>00489   }
<a name="l00490"></a>00490 
<a name="l00491"></a>00491   <span class="comment">// &lt;Rotation&gt;</span>
<a name="l00492"></a>00492   QString angleFunc;
<a name="l00493"></a>00493   <span class="keywordtype">bool</span> ok;
<a name="l00494"></a>00494   <span class="keywordtype">double</span> <a class="code" href="classQgsFillSymbolLayerV2.html#ab46dcc73dc9c60027259e7266a6b50ca">angle</a> = props.value( <span class="stringliteral">&quot;angle&quot;</span>, <span class="stringliteral">&quot;0&quot;</span> ).toDouble( &amp;ok );
<a name="l00495"></a>00495   <span class="keywordflow">if</span> ( !ok )
<a name="l00496"></a>00496   {
<a name="l00497"></a>00497     angleFunc = QString( <span class="stringliteral">&quot;%1 + %2&quot;</span> ).arg( props.value( <span class="stringliteral">&quot;angle&quot;</span>, <span class="stringliteral">&quot;0&quot;</span> ) ).arg( <a class="code" href="classQgsFillSymbolLayerV2.html#acccd5cf4eff0951a05e577cb916e5e04">mAngle</a> );
<a name="l00498"></a>00498   }
<a name="l00499"></a>00499   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( angle + <a class="code" href="classQgsFillSymbolLayerV2.html#acccd5cf4eff0951a05e577cb916e5e04">mAngle</a> != 0 )
<a name="l00500"></a>00500   {
<a name="l00501"></a>00501     angleFunc = QString::number( angle + <a class="code" href="classQgsFillSymbolLayerV2.html#acccd5cf4eff0951a05e577cb916e5e04">mAngle</a> );
<a name="l00502"></a>00502   }
<a name="l00503"></a>00503   <a class="code" href="classQgsSymbolLayerV2Utils.html#a2c170c5cb0180cd576b18876113c31d0">QgsSymbolLayerV2Utils::createRotationElement</a>( doc, graphicElem, angleFunc );
<a name="l00504"></a>00504 
<a name="l00505"></a>00505   <span class="keywordflow">if</span> ( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> )
<a name="l00506"></a>00506   {
<a name="l00507"></a>00507     <span class="comment">// the outline sub symbol should be stored within the Stroke element,</span>
<a name="l00508"></a>00508     <span class="comment">// but it will be stored in a separated LineSymbolizer because it could</span>
<a name="l00509"></a>00509     <span class="comment">// have more than one layer</span>
<a name="l00510"></a>00510     <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>-&gt;<a class="code" href="classQgsSymbolV2.html#a741dab3198725463a65b8482d5bfea04">toSld</a>( doc, element, props );
<a name="l00511"></a>00511   }
<a name="l00512"></a>00512 }
<a name="l00513"></a>00513 
<a name="l00514"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a5dda9a41e250f8b272c278da0176d906">00514</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsSVGFillSymbolLayer.html#a5dda9a41e250f8b272c278da0176d906">QgsSVGFillSymbolLayer::createFromSld</a>( QDomElement &amp;element )
<a name="l00515"></a>00515 {
<a name="l00516"></a>00516   <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( <span class="stringliteral">&quot;Entered.&quot;</span> );
<a name="l00517"></a>00517 
<a name="l00518"></a>00518   QString path, mimeType;
<a name="l00519"></a>00519   QColor fillColor, borderColor;
<a name="l00520"></a>00520   Qt::PenStyle penStyle;
<a name="l00521"></a>00521   <span class="keywordtype">double</span> <a class="code" href="qgssvgcache_8cpp.html#aba3c5d750d5dbd6e86c11ecaca62885e">size</a>, borderWidth;
<a name="l00522"></a>00522 
<a name="l00523"></a>00523   QDomElement fillElem = element.firstChildElement( <span class="stringliteral">&quot;Fill&quot;</span> );
<a name="l00524"></a>00524   <span class="keywordflow">if</span> ( fillElem.isNull() )
<a name="l00525"></a>00525     <span class="keywordflow">return</span> NULL;
<a name="l00526"></a>00526 
<a name="l00527"></a>00527   QDomElement graphicFillElem = fillElem.firstChildElement( <span class="stringliteral">&quot;GraphicFill&quot;</span> );
<a name="l00528"></a>00528   <span class="keywordflow">if</span> ( graphicFillElem.isNull() )
<a name="l00529"></a>00529     <span class="keywordflow">return</span> NULL;
<a name="l00530"></a>00530 
<a name="l00531"></a>00531   QDomElement graphicElem = graphicFillElem.firstChildElement( <span class="stringliteral">&quot;Graphic&quot;</span> );
<a name="l00532"></a>00532   <span class="keywordflow">if</span> ( graphicElem.isNull() )
<a name="l00533"></a>00533     <span class="keywordflow">return</span> NULL;
<a name="l00534"></a>00534 
<a name="l00535"></a>00535   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsSymbolLayerV2Utils.html#a6767913e1ba268d511c5dd75108d19a4">QgsSymbolLayerV2Utils::externalGraphicFromSld</a>( graphicElem, path, mimeType, fillColor, size ) )
<a name="l00536"></a>00536     <span class="keywordflow">return</span> NULL;
<a name="l00537"></a>00537 
<a name="l00538"></a>00538   <span class="keywordflow">if</span> ( mimeType != <span class="stringliteral">&quot;image/svg+xml&quot;</span> )
<a name="l00539"></a>00539     <span class="keywordflow">return</span> NULL;
<a name="l00540"></a>00540 
<a name="l00541"></a>00541   <a class="code" href="classQgsSymbolLayerV2Utils.html#a3bd88c222c0728508e139cc397580636">QgsSymbolLayerV2Utils::lineFromSld</a>( graphicElem, penStyle, borderColor, borderWidth );
<a name="l00542"></a>00542 
<a name="l00543"></a>00543   <span class="keywordtype">double</span> <a class="code" href="classQgsFillSymbolLayerV2.html#ab46dcc73dc9c60027259e7266a6b50ca">angle</a> = 0.0;
<a name="l00544"></a>00544   QString angleFunc;
<a name="l00545"></a>00545   <span class="keywordflow">if</span> ( <a class="code" href="classQgsSymbolLayerV2Utils.html#ae80d9580d6d4fc81110c9f2c561d8924">QgsSymbolLayerV2Utils::rotationFromSldElement</a>( graphicElem, angleFunc ) )
<a name="l00546"></a>00546   {
<a name="l00547"></a>00547     <span class="keywordtype">bool</span> ok;
<a name="l00548"></a>00548     <span class="keywordtype">double</span> d = angleFunc.toDouble( &amp;ok );
<a name="l00549"></a>00549     <span class="keywordflow">if</span> ( ok )
<a name="l00550"></a>00550       angle = d;
<a name="l00551"></a>00551   }
<a name="l00552"></a>00552 
<a name="l00553"></a>00553   <a class="code" href="classQgsSVGFillSymbolLayer.html" title="A class for svg fill patterns.">QgsSVGFillSymbolLayer</a>* sl = <span class="keyword">new</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#a1c7088c192f7da22c98a90ca97bdb409">QgsSVGFillSymbolLayer</a>( path, size, angle );
<a name="l00554"></a>00554   sl-&gt;<a class="code" href="classQgsSVGFillSymbolLayer.html#a516a7565c5686069db09ca15733b9750">setSvgFillColor</a>( fillColor );
<a name="l00555"></a>00555   sl-&gt;<a class="code" href="classQgsSVGFillSymbolLayer.html#afb1b852bd2ffbf1ca568c11baec90900">setSvgOutlineColor</a>( borderColor );
<a name="l00556"></a>00556   sl-&gt;<a class="code" href="classQgsSVGFillSymbolLayer.html#a1fc3ce01376348b1845ce81feea59021">setSvgOutlineWidth</a>( borderWidth );
<a name="l00557"></a>00557 
<a name="l00558"></a>00558   <span class="comment">// try to get the outline</span>
<a name="l00559"></a>00559   QDomElement strokeElem = element.firstChildElement( <span class="stringliteral">&quot;Stroke&quot;</span> );
<a name="l00560"></a>00560   <span class="keywordflow">if</span> ( !strokeElem.isNull() )
<a name="l00561"></a>00561   {
<a name="l00562"></a>00562     <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a> *l = <a class="code" href="classQgsSymbolLayerV2Utils.html#a011210967909eeb65b7a9769a0011f3f">QgsSymbolLayerV2Utils::createLineLayerFromSld</a>( strokeElem );
<a name="l00563"></a>00563     <span class="keywordflow">if</span> ( l )
<a name="l00564"></a>00564     {
<a name="l00565"></a>00565       <a class="code" href="qgssymbolv2_8h.html#abcf4e5696820a1c44827956f48787f1b">QgsSymbolLayerV2List</a> layers;
<a name="l00566"></a>00566       layers.append( l );
<a name="l00567"></a>00567       sl-&gt;<a class="code" href="classQgsImageFillSymbolLayer.html#a46cdc4fbb82c144b0b9e3afccba5c475">setSubSymbol</a>( <span class="keyword">new</span> <a class="code" href="classQgsLineSymbolV2.html">QgsLineSymbolV2</a>( layers ) );
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569   }
<a name="l00570"></a>00570 
<a name="l00571"></a>00571   <span class="keywordflow">return</span> sl;
<a name="l00572"></a>00572 }
<a name="l00573"></a>00573 
<a name="l00574"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#a27479489deb21d0304e98ac15b3e4384">00574</a> <span class="keywordtype">void</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#a27479489deb21d0304e98ac15b3e4384" title="Helper function that gets the view box from the byte array.">QgsSVGFillSymbolLayer::storeViewBox</a>()
<a name="l00575"></a>00575 {
<a name="l00576"></a>00576   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsSVGFillSymbolLayer.html#a4da7e5391ecfffa49582c9f24c259714" title="SVG data.">mSvgData</a>.isEmpty() )
<a name="l00577"></a>00577   {
<a name="l00578"></a>00578     QSvgRenderer r( <a class="code" href="classQgsSVGFillSymbolLayer.html#a4da7e5391ecfffa49582c9f24c259714" title="SVG data.">mSvgData</a> );
<a name="l00579"></a>00579     <span class="keywordflow">if</span> ( r.isValid() )
<a name="l00580"></a>00580     {
<a name="l00581"></a>00581       <a class="code" href="classQgsSVGFillSymbolLayer.html#a6b6c67caf2d1ed9c3235032044f9217b" title="SVG view box (to keep the aspect ratio.">mSvgViewBox</a> = r.viewBoxF();
<a name="l00582"></a>00582       <span class="keywordflow">return</span>;
<a name="l00583"></a>00583     }
<a name="l00584"></a>00584   }
<a name="l00585"></a>00585 
<a name="l00586"></a>00586   <a class="code" href="classQgsSVGFillSymbolLayer.html#a6b6c67caf2d1ed9c3235032044f9217b" title="SVG view box (to keep the aspect ratio.">mSvgViewBox</a> = QRectF();
<a name="l00587"></a>00587   <span class="keywordflow">return</span>;
<a name="l00588"></a>00588 }
<a name="l00589"></a>00589 
<a name="l00590"></a><a class="code" href="classQgsSVGFillSymbolLayer.html#ad73566b84a7f9cb203e17d74e237b410">00590</a> <span class="keywordtype">void</span> <a class="code" href="classQgsSVGFillSymbolLayer.html#ad73566b84a7f9cb203e17d74e237b410">QgsSVGFillSymbolLayer::setDefaultSvgParams</a>()
<a name="l00591"></a>00591 {
<a name="l00592"></a>00592   <span class="comment">//default values</span>
<a name="l00593"></a>00593   <a class="code" href="classQgsSVGFillSymbolLayer.html#a3031d784b930bb003f960dccd780fcd3">mSvgFillColor</a> = QColor( 0, 0, 0 );
<a name="l00594"></a>00594   <a class="code" href="classQgsSVGFillSymbolLayer.html#af241dc3e3effc02007fed4b314801c6e">mSvgOutlineColor</a> = QColor( 0, 0, 0 );
<a name="l00595"></a>00595   <a class="code" href="classQgsSVGFillSymbolLayer.html#aba08113e38f45171d951cf563b079577">mSvgOutlineWidth</a> = 0.3;
<a name="l00596"></a>00596 
<a name="l00597"></a>00597   <span class="keywordflow">if</span> ( <a class="code" href="classQgsSVGFillSymbolLayer.html#aaedf7a2b2aa65d5af85ed2c43a7f6962" title="Path to the svg file (or empty if constructed directly from data)">mSvgFilePath</a>.isEmpty() )
<a name="l00598"></a>00598   {
<a name="l00599"></a>00599     <span class="keywordflow">return</span>;
<a name="l00600"></a>00600   }
<a name="l00601"></a>00601 
<a name="l00602"></a>00602   <span class="keywordtype">bool</span> hasFillParam, hasOutlineParam, hasOutlineWidthParam;
<a name="l00603"></a>00603   QColor defaultFillColor, defaultOutlineColor;
<a name="l00604"></a>00604   <span class="keywordtype">double</span> defaultOutlineWidth;
<a name="l00605"></a>00605   <a class="code" href="classQgsSvgCache.html#a4903ea3275a2d0335227a9fba37bba66">QgsSvgCache::instance</a>()-&gt;<a class="code" href="classQgsSvgCache.html#a55c6d52e4975f8ecedd31e8ef07bea4d" title="Tests if an svg file contains parameters for fill, outline color, outline width.">containsParams</a>( <a class="code" href="classQgsSVGFillSymbolLayer.html#aaedf7a2b2aa65d5af85ed2c43a7f6962" title="Path to the svg file (or empty if constructed directly from data)">mSvgFilePath</a>, hasFillParam, defaultFillColor, hasOutlineParam, defaultOutlineColor, hasOutlineWidthParam,
<a name="l00606"></a>00606       defaultOutlineWidth );
<a name="l00607"></a>00607 
<a name="l00608"></a>00608   <span class="keywordflow">if</span> ( hasFillParam )
<a name="l00609"></a>00609   {
<a name="l00610"></a>00610     <a class="code" href="classQgsSVGFillSymbolLayer.html#a3031d784b930bb003f960dccd780fcd3">mSvgFillColor</a> = defaultFillColor;
<a name="l00611"></a>00611   }
<a name="l00612"></a>00612   <span class="keywordflow">if</span> ( hasOutlineParam )
<a name="l00613"></a>00613   {
<a name="l00614"></a>00614     <a class="code" href="classQgsSVGFillSymbolLayer.html#af241dc3e3effc02007fed4b314801c6e">mSvgOutlineColor</a> = defaultOutlineColor;
<a name="l00615"></a>00615   }
<a name="l00616"></a>00616   <span class="keywordflow">if</span> ( hasOutlineWidthParam )
<a name="l00617"></a>00617   {
<a name="l00618"></a>00618     <a class="code" href="classQgsSVGFillSymbolLayer.html#aba08113e38f45171d951cf563b079577">mSvgOutlineWidth</a> = defaultOutlineWidth;
<a name="l00619"></a>00619   }
<a name="l00620"></a>00620 }
<a name="l00621"></a>00621 
<a name="l00622"></a><a class="code" href="classQgsLinePatternFillSymbolLayer.html#ab7809cf95ea880e04b5f6252ba2db35b">00622</a> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ab7809cf95ea880e04b5f6252ba2db35b">QgsLinePatternFillSymbolLayer::QgsLinePatternFillSymbolLayer</a>(): <a class="code" href="classQgsImageFillSymbolLayer.html" title="Base class for polygon renderers generating texture images.">QgsImageFillSymbolLayer</a>()
<a name="l00623"></a>00623 {
<a name="l00624"></a>00624 }
<a name="l00625"></a>00625 
<a name="l00626"></a><a class="code" href="classQgsLinePatternFillSymbolLayer.html#a0403833a604336e472ce56df86ef27f5">00626</a> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a0403833a604336e472ce56df86ef27f5">QgsLinePatternFillSymbolLayer::~QgsLinePatternFillSymbolLayer</a>()
<a name="l00627"></a>00627 {
<a name="l00628"></a>00628 }
<a name="l00629"></a>00629 
<a name="l00630"></a><a class="code" href="classQgsLinePatternFillSymbolLayer.html#aa0b884fd1c9c3f3f729224c02958a058">00630</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsLinePatternFillSymbolLayer.html#aa0b884fd1c9c3f3f729224c02958a058">QgsLinePatternFillSymbolLayer::create</a>( <span class="keyword">const</span> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a>&amp; properties )
<a name="l00631"></a>00631 {
<a name="l00632"></a>00632   <a class="code" href="classQgsLinePatternFillSymbolLayer.html">QgsLinePatternFillSymbolLayer</a>* patternLayer = <span class="keyword">new</span> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ab7809cf95ea880e04b5f6252ba2db35b">QgsLinePatternFillSymbolLayer</a>();
<a name="l00633"></a>00633 
<a name="l00634"></a>00634   <span class="comment">//default values</span>
<a name="l00635"></a>00635   <span class="keywordtype">double</span> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a68f7a114cf2c9eefe35fb8297c8431a0">lineAngle</a> = 45;
<a name="l00636"></a>00636   <span class="keywordtype">double</span> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ae0f3d5365781fa49223328101c444810">distance</a> = 5;
<a name="l00637"></a>00637   <span class="keywordtype">double</span> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a717089c6edf691afce5769139ceeed50">lineWidth</a> = 0.5;
<a name="l00638"></a>00638   QColor <a class="code" href="classQgsLinePatternFillSymbolLayer.html#abdba0ed199f70183f44f7cd1ba238bde">color</a>( Qt::black );
<a name="l00639"></a>00639   <span class="keywordtype">double</span> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#adf87b28ee553703bb4ccc7a776c08910">offset</a> = 0.0;
<a name="l00640"></a>00640 
<a name="l00641"></a>00641   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;lineangle&quot;</span> ) )
<a name="l00642"></a>00642   {
<a name="l00643"></a>00643     lineAngle = properties[<span class="stringliteral">&quot;lineangle&quot;</span>].toDouble();
<a name="l00644"></a>00644   }
<a name="l00645"></a>00645   patternLayer-&gt;<a class="code" href="classQgsLinePatternFillSymbolLayer.html#a9d0a42c78b8aabe7d1029b339acd2d65">setLineAngle</a>( lineAngle );
<a name="l00646"></a>00646 
<a name="l00647"></a>00647   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;distance&quot;</span> ) )
<a name="l00648"></a>00648   {
<a name="l00649"></a>00649     distance = properties[<span class="stringliteral">&quot;distance&quot;</span>].toDouble();
<a name="l00650"></a>00650   }
<a name="l00651"></a>00651   patternLayer-&gt;<a class="code" href="classQgsLinePatternFillSymbolLayer.html#a790f59c6267a51a1dd9a23be1eb921c1">setDistance</a>( distance );
<a name="l00652"></a>00652 
<a name="l00653"></a>00653   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;linewidth&quot;</span> ) )
<a name="l00654"></a>00654   {
<a name="l00655"></a>00655     lineWidth = properties[<span class="stringliteral">&quot;linewidth&quot;</span>].toDouble();
<a name="l00656"></a>00656   }
<a name="l00657"></a>00657   patternLayer-&gt;<a class="code" href="classQgsLinePatternFillSymbolLayer.html#a63a81f7f6715a17f9aa28b941855ee07">setLineWidth</a>( lineWidth );
<a name="l00658"></a>00658 
<a name="l00659"></a>00659   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;color&quot;</span> ) )
<a name="l00660"></a>00660   {
<a name="l00661"></a>00661     color = <a class="code" href="classQgsSymbolLayerV2Utils.html#a942f2c54ef1be3c474313ff3739a9aa8">QgsSymbolLayerV2Utils::decodeColor</a>( properties[<span class="stringliteral">&quot;color&quot;</span>] );
<a name="l00662"></a>00662   }
<a name="l00663"></a>00663   patternLayer-&gt;<a class="code" href="classQgsLinePatternFillSymbolLayer.html#a5cf22418ec47c27768874b787896ab98">setColor</a>( color );
<a name="l00664"></a>00664 
<a name="l00665"></a>00665   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;offset&quot;</span> ) )
<a name="l00666"></a>00666   {
<a name="l00667"></a>00667     offset = properties[<span class="stringliteral">&quot;offset&quot;</span>].toDouble();
<a name="l00668"></a>00668   }
<a name="l00669"></a>00669   patternLayer-&gt;<a class="code" href="classQgsLinePatternFillSymbolLayer.html#abf5e308ecd1ed3367440dfcf81cb6572">setOffset</a>( offset );
<a name="l00670"></a>00670   <span class="keywordflow">return</span> patternLayer;
<a name="l00671"></a>00671 }
<a name="l00672"></a>00672 
<a name="l00673"></a><a class="code" href="classQgsLinePatternFillSymbolLayer.html#a16ba936db0e38b1baa7fb13b0e4f5426">00673</a> QString <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a16ba936db0e38b1baa7fb13b0e4f5426">QgsLinePatternFillSymbolLayer::layerType</a>()<span class="keyword"> const</span>
<a name="l00674"></a>00674 <span class="keyword"></span>{
<a name="l00675"></a>00675   <span class="keywordflow">return</span> <span class="stringliteral">&quot;LinePatternFill&quot;</span>;
<a name="l00676"></a>00676 }
<a name="l00677"></a>00677 
<a name="l00678"></a><a class="code" href="classQgsLinePatternFillSymbolLayer.html#a9e41395df0ba8b1a78f52a5c2af8c7dc">00678</a> <span class="keywordtype">void</span> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a9e41395df0ba8b1a78f52a5c2af8c7dc">QgsLinePatternFillSymbolLayer::startRender</a>( <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l00679"></a>00679 {
<a name="l00680"></a>00680   <span class="keywordtype">double</span> outlinePixelWidth = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a0abd301edb92a70755ccd288b589aec6">outputPixelSize</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#aad3e785f9e2949d9f845bd380e310956" title="Line width (in mm or map units)">mLineWidth</a> );
<a name="l00681"></a>00681   <span class="keywordtype">double</span> outputPixelDist = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a0abd301edb92a70755ccd288b589aec6">outputPixelSize</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#aa0c180a30deae355e8d95976e84521da" title="Distance (in mm or map units) between lines.">mDistance</a> );
<a name="l00682"></a>00682   <span class="keywordtype">double</span> outputPixelOffset = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a0abd301edb92a70755ccd288b589aec6">outputPixelSize</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a1d0bcdd9c580cc2dac54701887edfcac" title="Offset perpendicular to line direction.">mOffset</a> );
<a name="l00683"></a>00683 
<a name="l00684"></a>00684   <span class="comment">//create image</span>
<a name="l00685"></a>00685   <span class="keywordtype">int</span> height, width;
<a name="l00686"></a>00686   <span class="keywordflow">if</span> ( <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a>, 0 ) || <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a>, 360 ) || <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a>, 90 ) || <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a>, 180 ) || <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a>, 270 ) )
<a name="l00687"></a>00687   {
<a name="l00688"></a>00688     height = outputPixelDist;
<a name="l00689"></a>00689     width = height; <span class="comment">//width can be set to arbitrary value</span>
<a name="l00690"></a>00690   }
<a name="l00691"></a>00691   <span class="keywordflow">else</span>
<a name="l00692"></a>00692   {
<a name="l00693"></a>00693     height = qAbs( outputPixelDist / cos( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> * <a class="code" href="qgsdistancearea_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180 ) ); <span class="comment">//keep perpendicular distance between lines constant</span>
<a name="l00694"></a>00694     width = qAbs( height / tan( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> * <a class="code" href="qgsdistancearea_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180 ) );
<a name="l00695"></a>00695   }
<a name="l00696"></a>00696 
<a name="l00697"></a>00697   <span class="comment">//depending on the angle, we might need to render into a larger image and use a subset of it</span>
<a name="l00698"></a>00698   <span class="keywordtype">int</span> dx = 0;
<a name="l00699"></a>00699   <span class="keywordtype">int</span> dy = 0;
<a name="l00700"></a>00700 
<a name="l00701"></a>00701   QImage patternImage( width, height, QImage::Format_ARGB32 );
<a name="l00702"></a>00702   patternImage.fill( 0 );
<a name="l00703"></a>00703   QPainter p( &amp;patternImage );
<a name="l00704"></a>00704 
<a name="l00705"></a>00705   p.setRenderHint( QPainter::Antialiasing, <span class="keyword">true</span> );
<a name="l00706"></a>00706   QPen pen( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a4d96a8ba20c226696b3d34218cb48042">mColor</a> );
<a name="l00707"></a>00707   pen.setWidthF( outlinePixelWidth );
<a name="l00708"></a>00708   pen.setCapStyle( Qt::FlatCap );
<a name="l00709"></a>00709   p.setPen( pen );
<a name="l00710"></a>00710 
<a name="l00711"></a>00711   QPoint p1, p2, p3, p4, p5, p6;
<a name="l00712"></a>00712   <span class="keywordflow">if</span> ( <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a>, 0.0 ) || <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a>, 360.0 ) || <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a>, 180.0 ) )
<a name="l00713"></a>00713   {
<a name="l00714"></a>00714     p1 = QPoint( 0, height );
<a name="l00715"></a>00715     p2 = QPoint( width, height );
<a name="l00716"></a>00716     p3 = QPoint( 0, 0 );
<a name="l00717"></a>00717     p4 = QPoint( width, 0 );
<a name="l00718"></a>00718     p5 = QPoint( 0, 2 * height );
<a name="l00719"></a>00719     p6 = QPoint( width, 2 * height );
<a name="l00720"></a>00720   }
<a name="l00721"></a>00721   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a>, 90.0 ) || <a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a>, 270.0 ) )
<a name="l00722"></a>00722   {
<a name="l00723"></a>00723     p1 = QPoint( 0, height );
<a name="l00724"></a>00724     p2 = QPoint( 0, 0 );
<a name="l00725"></a>00725     p3 = QPoint( width, height );
<a name="l00726"></a>00726     p4 = QPoint( width, 0 );
<a name="l00727"></a>00727     p5 = QPoint( -width, height );
<a name="l00728"></a>00728     p6 = QPoint( -width, 0 );
<a name="l00729"></a>00729   }
<a name="l00730"></a>00730   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> &gt; 0 &amp;&amp; <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> &lt; 90 ) || ( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> &gt; 180 &amp;&amp; <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> &lt; 270 ) )
<a name="l00731"></a>00731   {
<a name="l00732"></a>00732     dx = outputPixelDist * cos(( 90 - <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> ) * <a class="code" href="qgsdistancearea_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.0 );
<a name="l00733"></a>00733     dy = outputPixelDist * sin(( 90 - <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> ) * <a class="code" href="qgsdistancearea_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.0 );
<a name="l00734"></a>00734     p1 = QPoint( 0, height );
<a name="l00735"></a>00735     p2 = QPoint( width, 0 );
<a name="l00736"></a>00736     p3 = QPoint( -dx, height - dy );
<a name="l00737"></a>00737     p4 = QPoint( width - dx, -dy ); <span class="comment">//p4 = QPoint( p3.x() + width, p3.y() - height );</span>
<a name="l00738"></a>00738     p5 = QPoint( dx, height + dy );
<a name="l00739"></a>00739     p6 = QPoint( width + dx, dy ); <span class="comment">//p6 = QPoint( p5.x() + width, p5.y() - height );</span>
<a name="l00740"></a>00740   }
<a name="l00741"></a>00741   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> &lt; 180 ) || ( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> &gt; 270 &amp;&amp; <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> &lt; 360 ) )
<a name="l00742"></a>00742   {
<a name="l00743"></a>00743     dy = outputPixelDist * cos(( 180 - <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> ) * <a class="code" href="qgsdistancearea_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180 );
<a name="l00744"></a>00744     dx = outputPixelDist * sin(( 180 - <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> ) * <a class="code" href="qgsdistancearea_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180 );
<a name="l00745"></a>00745     p1 = QPoint( width, height );
<a name="l00746"></a>00746     p2 = QPoint( 0, 0 );
<a name="l00747"></a>00747     p5 = QPoint( width + dx, height - dy );
<a name="l00748"></a>00748     p6 = QPoint( p5.x() - width, p5.y() - height ); <span class="comment">//p6 = QPoint( dx, -dy );</span>
<a name="l00749"></a>00749     p3 = QPoint( width - dx, height + dy );
<a name="l00750"></a>00750     p4 = QPoint( p3.x() - width, p3.y() - height ); <span class="comment">//p4 = QPoint( -dx, dy );</span>
<a name="l00751"></a>00751   }
<a name="l00752"></a>00752 
<a name="l00753"></a>00753   <span class="keywordflow">if</span> ( !<a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a1d0bcdd9c580cc2dac54701887edfcac" title="Offset perpendicular to line direction.">mOffset</a>, 0.0 ) ) <span class="comment">//shift everything</span>
<a name="l00754"></a>00754   {
<a name="l00755"></a>00755     QPointF tempPt;
<a name="l00756"></a>00756     tempPt = <a class="code" href="classQgsSymbolLayerV2Utils.html#ab17649cad5ff1e8ee2cf8495adfd835b" title="Returns a point on the line from startPoint to directionPoint that is a certain distance away from th...">QgsSymbolLayerV2Utils::pointOnLineWithDistance</a>( p1, p3, outputPixelDist + outputPixelOffset );
<a name="l00757"></a>00757     p3 = QPoint( tempPt.x(), tempPt.y() );
<a name="l00758"></a>00758     tempPt = <a class="code" href="classQgsSymbolLayerV2Utils.html#ab17649cad5ff1e8ee2cf8495adfd835b" title="Returns a point on the line from startPoint to directionPoint that is a certain distance away from th...">QgsSymbolLayerV2Utils::pointOnLineWithDistance</a>( p2, p4, outputPixelDist + outputPixelOffset );
<a name="l00759"></a>00759     p4 = QPoint( tempPt.x(), tempPt.y() );
<a name="l00760"></a>00760     tempPt = <a class="code" href="classQgsSymbolLayerV2Utils.html#ab17649cad5ff1e8ee2cf8495adfd835b" title="Returns a point on the line from startPoint to directionPoint that is a certain distance away from th...">QgsSymbolLayerV2Utils::pointOnLineWithDistance</a>( p1, p5, outputPixelDist - outputPixelOffset );
<a name="l00761"></a>00761     p5 = QPoint( tempPt.x(), tempPt.y() );
<a name="l00762"></a>00762     tempPt = <a class="code" href="classQgsSymbolLayerV2Utils.html#ab17649cad5ff1e8ee2cf8495adfd835b" title="Returns a point on the line from startPoint to directionPoint that is a certain distance away from th...">QgsSymbolLayerV2Utils::pointOnLineWithDistance</a>( p2, p6, outputPixelDist - outputPixelOffset );
<a name="l00763"></a>00763     p6 = QPoint( tempPt.x(), tempPt.y() );
<a name="l00764"></a>00764 
<a name="l00765"></a>00765     <span class="comment">//update p1, p2 last</span>
<a name="l00766"></a>00766     tempPt = <a class="code" href="classQgsSymbolLayerV2Utils.html#ab17649cad5ff1e8ee2cf8495adfd835b" title="Returns a point on the line from startPoint to directionPoint that is a certain distance away from th...">QgsSymbolLayerV2Utils::pointOnLineWithDistance</a>( p1, p3, outputPixelOffset ).toPoint();
<a name="l00767"></a>00767     p1 = QPoint( tempPt.x(), tempPt.y() );
<a name="l00768"></a>00768     tempPt = <a class="code" href="classQgsSymbolLayerV2Utils.html#ab17649cad5ff1e8ee2cf8495adfd835b" title="Returns a point on the line from startPoint to directionPoint that is a certain distance away from th...">QgsSymbolLayerV2Utils::pointOnLineWithDistance</a>( p2, p4, outputPixelOffset ).toPoint();
<a name="l00769"></a>00769     p2 = QPoint( tempPt.x(), tempPt.y() );;
<a name="l00770"></a>00770   }
<a name="l00771"></a>00771 
<a name="l00772"></a>00772   p.drawLine( p1, p2 );
<a name="l00773"></a>00773   p.drawLine( p3, p4 );
<a name="l00774"></a>00774   p.drawLine( p5, p6 );
<a name="l00775"></a>00775   p.end();
<a name="l00776"></a>00776 
<a name="l00777"></a>00777   <span class="comment">//set image to mBrush</span>
<a name="l00778"></a>00778   <span class="keywordflow">if</span> ( !<a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a29fa7f8394884b290db8cfa6c67a9434" title="Get alpha transparency 1 for opaque, 0 for invisible.">alpha</a>(), 1.0 ) )
<a name="l00779"></a>00779   {
<a name="l00780"></a>00780     QImage transparentImage = patternImage.copy();
<a name="l00781"></a>00781     <a class="code" href="classQgsSymbolLayerV2Utils.html#acca307af6bd85500a8308b921589bfac" title="Multiplies opacity of image pixel values with a (global) transparency value.">QgsSymbolLayerV2Utils::multiplyImageOpacity</a>( &amp;transparentImage, context.<a class="code" href="classQgsSymbolV2RenderContext.html#a29fa7f8394884b290db8cfa6c67a9434" title="Get alpha transparency 1 for opaque, 0 for invisible.">alpha</a>() );
<a name="l00782"></a>00782     <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>.setTextureImage( transparentImage );
<a name="l00783"></a>00783   }
<a name="l00784"></a>00784   <span class="keywordflow">else</span>
<a name="l00785"></a>00785   {
<a name="l00786"></a>00786     <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>.setTextureImage( patternImage );
<a name="l00787"></a>00787   }
<a name="l00788"></a>00788 
<a name="l00789"></a>00789   QTransform brushTransform;
<a name="l00790"></a>00790   brushTransform.scale( 1.0 / context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a499f7c7cb3dad9ea71f0f3e83760fe0b">rasterScaleFactor</a>(), 1.0 / context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a499f7c7cb3dad9ea71f0f3e83760fe0b">rasterScaleFactor</a>() );
<a name="l00791"></a>00791   <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>.setTransform( brushTransform );
<a name="l00792"></a>00792 
<a name="l00793"></a>00793   <span class="keywordflow">if</span> ( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> )
<a name="l00794"></a>00794   {
<a name="l00795"></a>00795     <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ad21008f16311e5b103310c555085e795">startRender</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>() );
<a name="l00796"></a>00796   }
<a name="l00797"></a>00797 }
<a name="l00798"></a>00798 
<a name="l00799"></a><a class="code" href="classQgsLinePatternFillSymbolLayer.html#afecb574a5b0240371781a55aa249821f">00799</a> <span class="keywordtype">void</span> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#afecb574a5b0240371781a55aa249821f">QgsLinePatternFillSymbolLayer::stopRender</a>( <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a> &amp; )
<a name="l00800"></a>00800 {
<a name="l00801"></a>00801 }
<a name="l00802"></a>00802 
<a name="l00803"></a><a class="code" href="classQgsLinePatternFillSymbolLayer.html#ac29cdd1a3a5653b329e788f7278c79c6">00803</a> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ac29cdd1a3a5653b329e788f7278c79c6">QgsLinePatternFillSymbolLayer::properties</a>()<span class="keyword"> const</span>
<a name="l00804"></a>00804 <span class="keyword"></span>{
<a name="l00805"></a>00805   <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> map;
<a name="l00806"></a>00806   map.insert( <span class="stringliteral">&quot;lineangle&quot;</span>, QString::number( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> ) );
<a name="l00807"></a>00807   map.insert( <span class="stringliteral">&quot;distance&quot;</span>, QString::number( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#aa0c180a30deae355e8d95976e84521da" title="Distance (in mm or map units) between lines.">mDistance</a> ) );
<a name="l00808"></a>00808   map.insert( <span class="stringliteral">&quot;linewidth&quot;</span>, QString::number( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#aad3e785f9e2949d9f845bd380e310956" title="Line width (in mm or map units)">mLineWidth</a> ) );
<a name="l00809"></a>00809   map.insert( <span class="stringliteral">&quot;color&quot;</span>, <a class="code" href="classQgsSymbolLayerV2Utils.html#a2d71081dab2d4fc194cd0c5588e66cf1">QgsSymbolLayerV2Utils::encodeColor</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a4d96a8ba20c226696b3d34218cb48042">mColor</a> ) );
<a name="l00810"></a>00810   map.insert( <span class="stringliteral">&quot;offset&quot;</span>, QString::number( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a1d0bcdd9c580cc2dac54701887edfcac" title="Offset perpendicular to line direction.">mOffset</a> ) );
<a name="l00811"></a>00811   <span class="keywordflow">return</span> map;
<a name="l00812"></a>00812 }
<a name="l00813"></a>00813 
<a name="l00814"></a><a class="code" href="classQgsLinePatternFillSymbolLayer.html#ab5c2c231a4402820858d9d46ae6f4907">00814</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ab5c2c231a4402820858d9d46ae6f4907">QgsLinePatternFillSymbolLayer::clone</a>()<span class="keyword"> const</span>
<a name="l00815"></a>00815 <span class="keyword"></span>{
<a name="l00816"></a>00816   <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* clonedLayer = <a class="code" href="classQgsLinePatternFillSymbolLayer.html#aa0b884fd1c9c3f3f729224c02958a058">QgsLinePatternFillSymbolLayer::create</a>( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ac29cdd1a3a5653b329e788f7278c79c6">properties</a>() );
<a name="l00817"></a>00817   <span class="keywordflow">if</span> ( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> )
<a name="l00818"></a>00818   {
<a name="l00819"></a>00819     clonedLayer-&gt;<a class="code" href="classQgsSymbolLayerV2.html#a7c473878e17645082e8be7b7d2f3c6e4">setSubSymbol</a>( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>-&gt;<a class="code" href="classQgsLineSymbolV2.html#a00f5a9bdcb8b548f0d7df4ab51dd46fd">clone</a>() );
<a name="l00820"></a>00820   }
<a name="l00821"></a>00821   <span class="keywordflow">return</span> clonedLayer;
<a name="l00822"></a>00822 }
<a name="l00823"></a>00823 
<a name="l00824"></a><a class="code" href="classQgsLinePatternFillSymbolLayer.html#a3fbdc1323f2711981140a07d78217e53">00824</a> <span class="keywordtype">void</span> <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a3fbdc1323f2711981140a07d78217e53">QgsLinePatternFillSymbolLayer::toSld</a>( QDomDocument &amp;doc, QDomElement &amp;element, <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> props )<span class="keyword"> const</span>
<a name="l00825"></a>00825 <span class="keyword"></span>{
<a name="l00826"></a>00826   QDomElement symbolizerElem = doc.createElement( <span class="stringliteral">&quot;se:PolygonSymbolizer&quot;</span> );
<a name="l00827"></a>00827   <span class="keywordflow">if</span> ( !props.value( <span class="stringliteral">&quot;uom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ).isEmpty() )
<a name="l00828"></a>00828     symbolizerElem.setAttribute( <span class="stringliteral">&quot;uom&quot;</span>, props.value( <span class="stringliteral">&quot;uom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ) );
<a name="l00829"></a>00829   element.appendChild( symbolizerElem );
<a name="l00830"></a>00830 
<a name="l00831"></a>00831   <span class="comment">// &lt;Geometry&gt;</span>
<a name="l00832"></a>00832   <a class="code" href="classQgsSymbolLayerV2Utils.html#aa53bd59d50cb727c12380a482632395e">QgsSymbolLayerV2Utils::createGeometryElement</a>( doc, symbolizerElem, props.value( <span class="stringliteral">&quot;geom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ) );
<a name="l00833"></a>00833 
<a name="l00834"></a>00834   QDomElement fillElem = doc.createElement( <span class="stringliteral">&quot;se:Fill&quot;</span> );
<a name="l00835"></a>00835   symbolizerElem.appendChild( fillElem );
<a name="l00836"></a>00836 
<a name="l00837"></a>00837   QDomElement graphicFillElem = doc.createElement( <span class="stringliteral">&quot;se:GraphicFill&quot;</span> );
<a name="l00838"></a>00838   fillElem.appendChild( graphicFillElem );
<a name="l00839"></a>00839 
<a name="l00840"></a>00840   QDomElement graphicElem = doc.createElement( <span class="stringliteral">&quot;se:Graphic&quot;</span> );
<a name="l00841"></a>00841   graphicFillElem.appendChild( graphicElem );
<a name="l00842"></a>00842 
<a name="l00843"></a>00843   <a class="code" href="classQgsSymbolLayerV2Utils.html#ae7f4d3bc466ba41079aaf087b7aff0d2">QgsSymbolLayerV2Utils::wellKnownMarkerToSld</a>( doc, graphicElem, <span class="stringliteral">&quot;horline&quot;</span>, QColor(), <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a4d96a8ba20c226696b3d34218cb48042">mColor</a>, <a class="code" href="classQgsLinePatternFillSymbolLayer.html#aad3e785f9e2949d9f845bd380e310956" title="Line width (in mm or map units)">mLineWidth</a>, <a class="code" href="classQgsLinePatternFillSymbolLayer.html#aa0c180a30deae355e8d95976e84521da" title="Distance (in mm or map units) between lines.">mDistance</a> );
<a name="l00844"></a>00844 
<a name="l00845"></a>00845   <span class="comment">// &lt;Rotation&gt;</span>
<a name="l00846"></a>00846   QString angleFunc;
<a name="l00847"></a>00847   <span class="keywordtype">bool</span> ok;
<a name="l00848"></a>00848   <span class="keywordtype">double</span> <a class="code" href="classQgsFillSymbolLayerV2.html#ab46dcc73dc9c60027259e7266a6b50ca">angle</a> = props.value( <span class="stringliteral">&quot;angle&quot;</span>, <span class="stringliteral">&quot;0&quot;</span> ).toDouble( &amp;ok );
<a name="l00849"></a>00849   <span class="keywordflow">if</span> ( !ok )
<a name="l00850"></a>00850   {
<a name="l00851"></a>00851     angleFunc = QString( <span class="stringliteral">&quot;%1 + %2&quot;</span> ).arg( props.value( <span class="stringliteral">&quot;angle&quot;</span>, <span class="stringliteral">&quot;0&quot;</span> ) ).arg( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> );
<a name="l00852"></a>00852   }
<a name="l00853"></a>00853   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( angle + <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> != 0 )
<a name="l00854"></a>00854   {
<a name="l00855"></a>00855     angleFunc = QString::number( angle + <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> );
<a name="l00856"></a>00856   }
<a name="l00857"></a>00857   <a class="code" href="classQgsSymbolLayerV2Utils.html#a2c170c5cb0180cd576b18876113c31d0">QgsSymbolLayerV2Utils::createRotationElement</a>( doc, graphicElem, angleFunc );
<a name="l00858"></a>00858 
<a name="l00859"></a>00859   <span class="comment">// &lt;se:Displacement&gt;</span>
<a name="l00860"></a>00860   QPointF lineOffset( qSin( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> ) * <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a1d0bcdd9c580cc2dac54701887edfcac" title="Offset perpendicular to line direction.">mOffset</a>, qCos( <a class="code" href="classQgsLinePatternFillSymbolLayer.html#ad000d9157d8d7a606b702639035016ea" title="Vector line angle in degrees (0 = horizontal, counterclockwise)">mLineAngle</a> ) * mOffset );
<a name="l00861"></a>00861   <a class="code" href="classQgsSymbolLayerV2Utils.html#af636bf6786998e7df7b88f0b689f5d16">QgsSymbolLayerV2Utils::createDisplacementElement</a>( doc, graphicElem, lineOffset );
<a name="l00862"></a>00862 }
<a name="l00863"></a>00863 
<a name="l00864"></a><a class="code" href="classQgsLinePatternFillSymbolLayer.html#a1d6bf203336f3eacb466e2df13747c7b">00864</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsLinePatternFillSymbolLayer.html#a1d6bf203336f3eacb466e2df13747c7b">QgsLinePatternFillSymbolLayer::createFromSld</a>( QDomElement &amp;element )
<a name="l00865"></a>00865 {
<a name="l00866"></a>00866   Q_UNUSED( element );
<a name="l00867"></a>00867   <span class="keywordflow">return</span> NULL;
<a name="l00868"></a>00868 }
<a name="l00869"></a>00869 
<a name="l00871"></a>00871 
<a name="l00872"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#aa2f9733922bf6bde0fcf0fa3440b3510">00872</a> <a class="code" href="classQgsPointPatternFillSymbolLayer.html#aa2f9733922bf6bde0fcf0fa3440b3510">QgsPointPatternFillSymbolLayer::QgsPointPatternFillSymbolLayer</a>(): <a class="code" href="classQgsImageFillSymbolLayer.html" title="Base class for polygon renderers generating texture images.">QgsImageFillSymbolLayer</a>(), mMarkerSymbol( 0 ), mDistanceX( 15 ),
<a name="l00873"></a>00873     mDistanceY( 15 ), mDisplacementX( 0 ), mDisplacementY( 0 )
<a name="l00874"></a>00874 {
<a name="l00875"></a>00875   <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a5a66c4e2e1725dc7fd4b246d1a44f154">mDistanceX</a> = 15;
<a name="l00876"></a>00876   <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a102f29997a1a8ce13662f94e1fa05b95">mDistanceY</a> = 15;
<a name="l00877"></a>00877   <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a9b1b1e32fb4d0d2111e4b9d12803d79b">mDisplacementX</a> = 0;
<a name="l00878"></a>00878   <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a67b7e1c5792bc473afefd6d3ee8334f7">mDisplacementY</a> = 0;
<a name="l00879"></a>00879   <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a791f8c9e3ecd85c5bb439af977bf79da">setSubSymbol</a>( <span class="keyword">new</span> <a class="code" href="classQgsMarkerSymbolV2.html">QgsMarkerSymbolV2</a>() );
<a name="l00880"></a>00880   <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a791f8c9e3ecd85c5bb439af977bf79da">QgsImageFillSymbolLayer::setSubSymbol</a>( 0 ); <span class="comment">//no outline</span>
<a name="l00881"></a>00881 }
<a name="l00882"></a>00882 
<a name="l00883"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#a14bc2edb0877bee459567b36d5f20640">00883</a> <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a14bc2edb0877bee459567b36d5f20640">QgsPointPatternFillSymbolLayer::~QgsPointPatternFillSymbolLayer</a>()
<a name="l00884"></a>00884 {
<a name="l00885"></a>00885 }
<a name="l00886"></a>00886 
<a name="l00887"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#a9df0e4b95304765898fc93df0b743556">00887</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a9df0e4b95304765898fc93df0b743556">QgsPointPatternFillSymbolLayer::create</a>( <span class="keyword">const</span> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a>&amp; properties )
<a name="l00888"></a>00888 {
<a name="l00889"></a>00889   <a class="code" href="classQgsPointPatternFillSymbolLayer.html">QgsPointPatternFillSymbolLayer</a>* layer = <span class="keyword">new</span> <a class="code" href="classQgsPointPatternFillSymbolLayer.html#aa2f9733922bf6bde0fcf0fa3440b3510">QgsPointPatternFillSymbolLayer</a>();
<a name="l00890"></a>00890   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;distance_x&quot;</span> ) )
<a name="l00891"></a>00891   {
<a name="l00892"></a>00892     layer-&gt;<a class="code" href="classQgsPointPatternFillSymbolLayer.html#abeef5b46de55e8d2c0243990264768f5">setDistanceX</a>( properties[<span class="stringliteral">&quot;distance_x&quot;</span>].toDouble() );
<a name="l00893"></a>00893   }
<a name="l00894"></a>00894   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;distance_y&quot;</span> ) )
<a name="l00895"></a>00895   {
<a name="l00896"></a>00896     layer-&gt;<a class="code" href="classQgsPointPatternFillSymbolLayer.html#ab64b8e9f546182c3c0e611c34a42c244">setDistanceY</a>( properties[<span class="stringliteral">&quot;distance_y&quot;</span>].toDouble() );
<a name="l00897"></a>00897   }
<a name="l00898"></a>00898   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;displacement_x&quot;</span> ) )
<a name="l00899"></a>00899   {
<a name="l00900"></a>00900     layer-&gt;<a class="code" href="classQgsPointPatternFillSymbolLayer.html#a048a1873ea53a812db1a004bacefe304">setDisplacementX</a>( properties[<span class="stringliteral">&quot;displacement_x&quot;</span>].toDouble() );
<a name="l00901"></a>00901   }
<a name="l00902"></a>00902   <span class="keywordflow">if</span> ( properties.contains( <span class="stringliteral">&quot;displacement_y&quot;</span> ) )
<a name="l00903"></a>00903   {
<a name="l00904"></a>00904     layer-&gt;<a class="code" href="classQgsPointPatternFillSymbolLayer.html#a67f5c9bb6c4507d37dead95035430c40">setDisplacementY</a>( properties[<span class="stringliteral">&quot;displacement_y&quot;</span>].toDouble() );
<a name="l00905"></a>00905   }
<a name="l00906"></a>00906   <span class="keywordflow">return</span> layer;
<a name="l00907"></a>00907 }
<a name="l00908"></a>00908 
<a name="l00909"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6796ed27aec8789d0967ec2c108c947d">00909</a> QString <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6796ed27aec8789d0967ec2c108c947d">QgsPointPatternFillSymbolLayer::layerType</a>()<span class="keyword"> const</span>
<a name="l00910"></a>00910 <span class="keyword"></span>{
<a name="l00911"></a>00911   <span class="keywordflow">return</span> <span class="stringliteral">&quot;PointPatternFill&quot;</span>;
<a name="l00912"></a>00912 }
<a name="l00913"></a>00913 
<a name="l00914"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#a1820282670a563328119acd2c99f9c3d">00914</a> <span class="keywordtype">void</span> <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a1820282670a563328119acd2c99f9c3d">QgsPointPatternFillSymbolLayer::startRender</a>( <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l00915"></a>00915 {
<a name="l00916"></a>00916   <span class="comment">//render 3 rows and columns in one go to easily incorporate displacement</span>
<a name="l00917"></a>00917   <span class="keywordtype">double</span> width = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a0abd301edb92a70755ccd288b589aec6">outputPixelSize</a>( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a5a66c4e2e1725dc7fd4b246d1a44f154">mDistanceX</a> ) * 2.0;
<a name="l00918"></a>00918   <span class="keywordtype">double</span> height = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a0abd301edb92a70755ccd288b589aec6">outputPixelSize</a>( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a102f29997a1a8ce13662f94e1fa05b95">mDistanceY</a> ) * 2.0;
<a name="l00919"></a>00919 
<a name="l00920"></a>00920   QImage patternImage( width, height, QImage::Format_ARGB32 );
<a name="l00921"></a>00921   patternImage.fill( 0 );
<a name="l00922"></a>00922 
<a name="l00923"></a>00923   <span class="keywordflow">if</span> ( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a> )
<a name="l00924"></a>00924   {
<a name="l00925"></a>00925     QPainter p( &amp;patternImage );
<a name="l00926"></a>00926 
<a name="l00927"></a>00927     <span class="comment">//marker rendering needs context for drawing on patternImage</span>
<a name="l00928"></a>00928     <a class="code" href="classQgsRenderContext.html" title="Contains information about the context of a rendering operation.">QgsRenderContext</a> pointRenderContext;
<a name="l00929"></a>00929     pointRenderContext.<a class="code" href="classQgsRenderContext.html#abe42574149f534251692dc3f3212bafa">setPainter</a>( &amp;p );
<a name="l00930"></a>00930     pointRenderContext.<a class="code" href="classQgsRenderContext.html#a054725b49ba62bbe41b26285712379b8">setRasterScaleFactor</a>( 1.0 );
<a name="l00931"></a>00931     pointRenderContext.<a class="code" href="classQgsRenderContext.html#a22162d18b545e59518c8fa9ce72a3b37">setScaleFactor</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#af4b93052d1a48544b5cd7103a7596acb">scaleFactor</a>() * context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a499f7c7cb3dad9ea71f0f3e83760fe0b">rasterScaleFactor</a>() );
<a name="l00932"></a>00932     <a class="code" href="classQgsMapToPixel.html" title="Perform transforms between map coordinates and device coordinates.">QgsMapToPixel</a> mtp( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#abe5b3cb445070d6f5343132d6c347e65">mapToPixel</a>().<a class="code" href="classQgsMapToPixel.html#ad8c374aa5e47057d4c2f45a5ced78bd0" title="Return current map units per pixel.">mapUnitsPerPixel</a>() / context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a499f7c7cb3dad9ea71f0f3e83760fe0b">rasterScaleFactor</a>() );
<a name="l00933"></a>00933     pointRenderContext.<a class="code" href="classQgsRenderContext.html#aa46d0bf874f116bc9d6e7f21a216a5d7">setMapToPixel</a>( mtp );
<a name="l00934"></a>00934     pointRenderContext.<a class="code" href="classQgsRenderContext.html#a036a2f284730d968e7afb08fe895fa15" title="Added in QGIS v1.5.">setForceVectorOutput</a>( <span class="keyword">false</span> );
<a name="l00935"></a>00935 
<a name="l00936"></a>00936     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ab7507bfcdaeca7242bf502602e8ada2e">setOutputUnit</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#aed0197ecde31035db53569b1e8be838f">outputUnit</a>() );
<a name="l00937"></a>00937     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ad21008f16311e5b103310c555085e795">startRender</a>( pointRenderContext );
<a name="l00938"></a>00938 
<a name="l00939"></a>00939     <span class="comment">//render corner points</span>
<a name="l00940"></a>00940     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#a6237c61df96f213f9d2080de00dde17a">renderPoint</a>( QPointF( 0, 0 ), context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), pointRenderContext );
<a name="l00941"></a>00941     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#a6237c61df96f213f9d2080de00dde17a">renderPoint</a>( QPointF( width, 0 ), context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), pointRenderContext );
<a name="l00942"></a>00942     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#a6237c61df96f213f9d2080de00dde17a">renderPoint</a>( QPointF( 0, height ), context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), pointRenderContext );
<a name="l00943"></a>00943     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#a6237c61df96f213f9d2080de00dde17a">renderPoint</a>( QPointF( width, height ), context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), pointRenderContext );
<a name="l00944"></a>00944 
<a name="l00945"></a>00945     <span class="comment">//render displaced points</span>
<a name="l00946"></a>00946     <span class="keywordtype">double</span> displacementPixelX = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a0abd301edb92a70755ccd288b589aec6">outputPixelSize</a>( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a9b1b1e32fb4d0d2111e4b9d12803d79b">mDisplacementX</a> );
<a name="l00947"></a>00947     <span class="keywordtype">double</span> displacementPixelY = context.<a class="code" href="classQgsSymbolV2RenderContext.html#a0abd301edb92a70755ccd288b589aec6">outputPixelSize</a>( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a67b7e1c5792bc473afefd6d3ee8334f7">mDisplacementY</a> );
<a name="l00948"></a>00948     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#a6237c61df96f213f9d2080de00dde17a">renderPoint</a>( QPointF( width / 2.0, -displacementPixelY ), context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), pointRenderContext );
<a name="l00949"></a>00949     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#a6237c61df96f213f9d2080de00dde17a">renderPoint</a>( QPointF( displacementPixelX, height / 2.0 ), context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), pointRenderContext );
<a name="l00950"></a>00950     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#a6237c61df96f213f9d2080de00dde17a">renderPoint</a>( QPointF( width / 2.0 + displacementPixelX, height / 2.0 - displacementPixelY ), context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), pointRenderContext );
<a name="l00951"></a>00951     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#a6237c61df96f213f9d2080de00dde17a">renderPoint</a>( QPointF( width + displacementPixelX, height / 2.0 ), context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), pointRenderContext );
<a name="l00952"></a>00952     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#a6237c61df96f213f9d2080de00dde17a">renderPoint</a>( QPointF( width / 2.0, height - displacementPixelY ), context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), pointRenderContext );
<a name="l00953"></a>00953 
<a name="l00954"></a>00954     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ab70bbea2b61fb9e734766f265f6625df">stopRender</a>( pointRenderContext );
<a name="l00955"></a>00955   }
<a name="l00956"></a>00956 
<a name="l00957"></a>00957   <span class="keywordflow">if</span> ( !<a class="code" href="qgis_8h.html#a14039c8aa54bda84192e28ecb298ed20">doubleNear</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a29fa7f8394884b290db8cfa6c67a9434" title="Get alpha transparency 1 for opaque, 0 for invisible.">alpha</a>(), 1.0 ) )
<a name="l00958"></a>00958   {
<a name="l00959"></a>00959     QImage transparentImage = patternImage.copy();
<a name="l00960"></a>00960     <a class="code" href="classQgsSymbolLayerV2Utils.html#acca307af6bd85500a8308b921589bfac" title="Multiplies opacity of image pixel values with a (global) transparency value.">QgsSymbolLayerV2Utils::multiplyImageOpacity</a>( &amp;transparentImage, context.<a class="code" href="classQgsSymbolV2RenderContext.html#a29fa7f8394884b290db8cfa6c67a9434" title="Get alpha transparency 1 for opaque, 0 for invisible.">alpha</a>() );
<a name="l00961"></a>00961     <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>.setTextureImage( transparentImage );
<a name="l00962"></a>00962   }
<a name="l00963"></a>00963   <span class="keywordflow">else</span>
<a name="l00964"></a>00964   {
<a name="l00965"></a>00965     <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>.setTextureImage( patternImage );
<a name="l00966"></a>00966   }
<a name="l00967"></a>00967   QTransform brushTransform;
<a name="l00968"></a>00968   brushTransform.scale( 1.0 / context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a499f7c7cb3dad9ea71f0f3e83760fe0b">rasterScaleFactor</a>(), 1.0 / context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>().<a class="code" href="classQgsRenderContext.html#a499f7c7cb3dad9ea71f0f3e83760fe0b">rasterScaleFactor</a>() );
<a name="l00969"></a>00969   <a class="code" href="classQgsImageFillSymbolLayer.html#ac3469a2f4bcdff5a6602c530659f7420">mBrush</a>.setTransform( brushTransform );
<a name="l00970"></a>00970 
<a name="l00971"></a>00971   <span class="keywordflow">if</span> ( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> )
<a name="l00972"></a>00972   {
<a name="l00973"></a>00973     <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ad21008f16311e5b103310c555085e795">startRender</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>() );
<a name="l00974"></a>00974   }
<a name="l00975"></a>00975 }
<a name="l00976"></a>00976 
<a name="l00977"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#a02a21ae1be965f12102dde4027539b0e">00977</a> <span class="keywordtype">void</span> <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a02a21ae1be965f12102dde4027539b0e">QgsPointPatternFillSymbolLayer::stopRender</a>( <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l00978"></a>00978 {
<a name="l00979"></a>00979   <span class="keywordflow">if</span> ( <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a> )
<a name="l00980"></a>00980   {
<a name="l00981"></a>00981     <a class="code" href="classQgsImageFillSymbolLayer.html#a0bf9cd72402d215f85b20ad0285398ab" title="Custom outline.">mOutline</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ab70bbea2b61fb9e734766f265f6625df">stopRender</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>() );
<a name="l00982"></a>00982   }
<a name="l00983"></a>00983 }
<a name="l00984"></a>00984 
<a name="l00985"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#a5278665ea32cc19877d17f6a20af04a3">00985</a> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a5278665ea32cc19877d17f6a20af04a3">QgsPointPatternFillSymbolLayer::properties</a>()<span class="keyword"> const</span>
<a name="l00986"></a>00986 <span class="keyword"></span>{
<a name="l00987"></a>00987   <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> propertyMap;
<a name="l00988"></a>00988   propertyMap[<span class="stringliteral">&quot;distance_x&quot;</span>] = QString::number( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a5a66c4e2e1725dc7fd4b246d1a44f154">mDistanceX</a> );
<a name="l00989"></a>00989   propertyMap[<span class="stringliteral">&quot;distance_y&quot;</span>] = QString::number( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a102f29997a1a8ce13662f94e1fa05b95">mDistanceY</a> );
<a name="l00990"></a>00990   propertyMap[<span class="stringliteral">&quot;displacement_x&quot;</span>] = QString::number( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a9b1b1e32fb4d0d2111e4b9d12803d79b">mDisplacementX</a> );
<a name="l00991"></a>00991   propertyMap[<span class="stringliteral">&quot;displacement_y&quot;</span>] = QString::number( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a67b7e1c5792bc473afefd6d3ee8334f7">mDisplacementY</a> );
<a name="l00992"></a>00992   <span class="keywordflow">return</span> propertyMap;
<a name="l00993"></a>00993 }
<a name="l00994"></a>00994 
<a name="l00995"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#a90875d9a6f5f42c0e5484f41b4e7539a">00995</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a90875d9a6f5f42c0e5484f41b4e7539a">QgsPointPatternFillSymbolLayer::clone</a>()<span class="keyword"> const</span>
<a name="l00996"></a>00996 <span class="keyword"></span>{
<a name="l00997"></a>00997   <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* clonedLayer = <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a9df0e4b95304765898fc93df0b743556">QgsPointPatternFillSymbolLayer::create</a>( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a5278665ea32cc19877d17f6a20af04a3">properties</a>() );
<a name="l00998"></a>00998   <span class="keywordflow">if</span> ( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a> )
<a name="l00999"></a>00999   {
<a name="l01000"></a>01000     clonedLayer-&gt;<a class="code" href="classQgsSymbolLayerV2.html#a7c473878e17645082e8be7b7d2f3c6e4">setSubSymbol</a>( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#ad1afc202ea3e92c66cbc0210ef78a75e">clone</a>() );
<a name="l01001"></a>01001   }
<a name="l01002"></a>01002   <span class="keywordflow">return</span> clonedLayer;
<a name="l01003"></a>01003 }
<a name="l01004"></a>01004 
<a name="l01005"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#ab5f555f0904e916ee4aff6d5a6e15a3f">01005</a> <span class="keywordtype">void</span> <a class="code" href="classQgsPointPatternFillSymbolLayer.html#ab5f555f0904e916ee4aff6d5a6e15a3f">QgsPointPatternFillSymbolLayer::toSld</a>( QDomDocument &amp;doc, QDomElement &amp;element, <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> props )<span class="keyword"> const</span>
<a name="l01006"></a>01006 <span class="keyword"></span>{
<a name="l01007"></a>01007   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsSymbolV2.html#a45a4281959125392c456b44e1cebc8f3">symbolLayerCount</a>(); i++ )
<a name="l01008"></a>01008   {
<a name="l01009"></a>01009     QDomElement symbolizerElem = doc.createElement( <span class="stringliteral">&quot;se:PolygonSymbolizer&quot;</span> );
<a name="l01010"></a>01010     <span class="keywordflow">if</span> ( !props.value( <span class="stringliteral">&quot;uom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ).isEmpty() )
<a name="l01011"></a>01011       symbolizerElem.setAttribute( <span class="stringliteral">&quot;uom&quot;</span>, props.value( <span class="stringliteral">&quot;uom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ) );
<a name="l01012"></a>01012     element.appendChild( symbolizerElem );
<a name="l01013"></a>01013 
<a name="l01014"></a>01014     <span class="comment">// &lt;Geometry&gt;</span>
<a name="l01015"></a>01015     <a class="code" href="classQgsSymbolLayerV2Utils.html#aa53bd59d50cb727c12380a482632395e">QgsSymbolLayerV2Utils::createGeometryElement</a>( doc, symbolizerElem, props.value( <span class="stringliteral">&quot;geom&quot;</span>, <span class="stringliteral">&quot;&quot;</span> ) );
<a name="l01016"></a>01016 
<a name="l01017"></a>01017     QDomElement fillElem = doc.createElement( <span class="stringliteral">&quot;se:Fill&quot;</span> );
<a name="l01018"></a>01018     symbolizerElem.appendChild( fillElem );
<a name="l01019"></a>01019 
<a name="l01020"></a>01020     QDomElement graphicFillElem = doc.createElement( <span class="stringliteral">&quot;se:GraphicFill&quot;</span> );
<a name="l01021"></a>01021     fillElem.appendChild( graphicFillElem );
<a name="l01022"></a>01022 
<a name="l01023"></a>01023     <span class="comment">// store distanceX, distanceY, displacementX, displacementY in a &lt;VendorOption&gt;</span>
<a name="l01024"></a>01024     QString dist =  <a class="code" href="classQgsSymbolLayerV2Utils.html#a8ed29d4fe064d67f7071647b53aeb340">QgsSymbolLayerV2Utils::encodePoint</a>( QPointF( <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a5a66c4e2e1725dc7fd4b246d1a44f154">mDistanceX</a>, <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a102f29997a1a8ce13662f94e1fa05b95">mDistanceY</a> ) );
<a name="l01025"></a>01025     QDomElement distanceElem = <a class="code" href="classQgsSymbolLayerV2Utils.html#aa60e1e0aab4c55f593415a0da1419252">QgsSymbolLayerV2Utils::createVendorOptionElement</a>( doc, <span class="stringliteral">&quot;distance&quot;</span>, dist );
<a name="l01026"></a>01026     symbolizerElem.appendChild( distanceElem );
<a name="l01027"></a>01027 
<a name="l01028"></a>01028     <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a> *layer = <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>-&gt;<a class="code" href="classQgsSymbolV2.html#af7d0f51d232383934958eef6736ea23d">symbolLayer</a>( i );
<a name="l01029"></a>01029     <a class="code" href="classQgsMarkerSymbolLayerV2.html">QgsMarkerSymbolLayerV2</a> *markerLayer = <span class="keyword">static_cast&lt;</span><a class="code" href="classQgsMarkerSymbolLayerV2.html">QgsMarkerSymbolLayerV2</a> *<span class="keyword">&gt;</span>( layer );
<a name="l01030"></a>01030     <span class="keywordflow">if</span> ( !markerLayer )
<a name="l01031"></a>01031     {
<a name="l01032"></a>01032       QString errorMsg = QString( <span class="stringliteral">&quot;MarkerSymbolLayerV2 expected, %1 found. Skip it.&quot;</span> ).arg( layer-&gt;<a class="code" href="classQgsSymbolLayerV2.html#a649469c389d39326aab49fbe842d4598">layerType</a>() );
<a name="l01033"></a>01033       graphicFillElem.appendChild( doc.createComment( errorMsg ) );
<a name="l01034"></a>01034     }
<a name="l01035"></a>01035     <span class="keywordflow">else</span>
<a name="l01036"></a>01036     {
<a name="l01037"></a>01037       markerLayer-&gt;<a class="code" href="classQgsMarkerSymbolLayerV2.html#a4d3b5ae1ac7814f9477f9e3707ac8c09">writeSldMarker</a>( doc, graphicFillElem, props );
<a name="l01038"></a>01038     }
<a name="l01039"></a>01039   }
<a name="l01040"></a>01040 }
<a name="l01041"></a>01041 
<a name="l01042"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#a8aec694972102518442be7db5c9a4370">01042</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a8aec694972102518442be7db5c9a4370">QgsPointPatternFillSymbolLayer::createFromSld</a>( QDomElement &amp;element )
<a name="l01043"></a>01043 {
<a name="l01044"></a>01044   Q_UNUSED( element );
<a name="l01045"></a>01045   <span class="keywordflow">return</span> NULL;
<a name="l01046"></a>01046 }
<a name="l01047"></a>01047 
<a name="l01048"></a><a class="code" href="classQgsPointPatternFillSymbolLayer.html#a791f8c9e3ecd85c5bb439af977bf79da">01048</a> <span class="keywordtype">bool</span> <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a791f8c9e3ecd85c5bb439af977bf79da">QgsPointPatternFillSymbolLayer::setSubSymbol</a>( <a class="code" href="classQgsSymbolV2.html">QgsSymbolV2</a>* symbol )
<a name="l01049"></a>01049 {
<a name="l01050"></a>01050   <span class="keywordflow">if</span> ( !symbol )
<a name="l01051"></a>01051   {
<a name="l01052"></a>01052     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01053"></a>01053   }
<a name="l01054"></a>01054 
<a name="l01055"></a>01055   <span class="keywordflow">if</span> ( symbol-&gt;<a class="code" href="classQgsSymbolV2.html#aa582dfed1c81b5714a5e219d2612d171">type</a>() == <a class="code" href="classQgsSymbolV2.html#a5d1dc41b5e445d244383f02a237e95dda20de105177cc62462d5d9c9e4e63a791">QgsSymbolV2::Marker</a> )
<a name="l01056"></a>01056   {
<a name="l01057"></a>01057     <a class="code" href="classQgsMarkerSymbolV2.html">QgsMarkerSymbolV2</a>* markerSymbol = <span class="keyword">static_cast&lt;</span><a class="code" href="classQgsMarkerSymbolV2.html">QgsMarkerSymbolV2</a>*<span class="keyword">&gt;</span>( symbol );
<a name="l01058"></a>01058     <span class="keyword">delete</span> <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a>;
<a name="l01059"></a>01059     <a class="code" href="classQgsPointPatternFillSymbolLayer.html#a6a84b6c0c919c4ff7d2d818d23fd0f7b">mMarkerSymbol</a> = markerSymbol;
<a name="l01060"></a>01060   }
<a name="l01061"></a>01061   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01062"></a>01062 }
<a name="l01063"></a>01063 
<a name="l01065"></a>01065 
<a name="l01066"></a>01066 
<a name="l01067"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad5a0bddb2c2e11803fc23f57eb6a54d6">01067</a> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad5a0bddb2c2e11803fc23f57eb6a54d6">QgsCentroidFillSymbolLayerV2::QgsCentroidFillSymbolLayerV2</a>()
<a name="l01068"></a>01068 {
<a name="l01069"></a>01069   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a> = NULL;
<a name="l01070"></a>01070   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a38755ad7c30fb785c8b7eb0c834911a4">setSubSymbol</a>( <span class="keyword">new</span> <a class="code" href="classQgsMarkerSymbolV2.html">QgsMarkerSymbolV2</a>() );
<a name="l01071"></a>01071 }
<a name="l01072"></a>01072 
<a name="l01073"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ac8bbefa7c89518da7cab0635920fc91a">01073</a> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ac8bbefa7c89518da7cab0635920fc91a">QgsCentroidFillSymbolLayerV2::~QgsCentroidFillSymbolLayerV2</a>()
<a name="l01074"></a>01074 {
<a name="l01075"></a>01075   <span class="keyword">delete</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>;
<a name="l01076"></a>01076 }
<a name="l01077"></a>01077 
<a name="l01078"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a0bb802f97a5b63df770e582430b3a159">01078</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a0bb802f97a5b63df770e582430b3a159">QgsCentroidFillSymbolLayerV2::create</a>( <span class="keyword">const</span> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a>&amp; <span class="comment">/*properties*/</span> )
<a name="l01079"></a>01079 {
<a name="l01080"></a>01080   <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad5a0bddb2c2e11803fc23f57eb6a54d6">QgsCentroidFillSymbolLayerV2</a>();
<a name="l01081"></a>01081 }
<a name="l01082"></a>01082 
<a name="l01083"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a6dd39d0c0104f21260cc2240496ed8fb">01083</a> QString <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a6dd39d0c0104f21260cc2240496ed8fb">QgsCentroidFillSymbolLayerV2::layerType</a>()<span class="keyword"> const</span>
<a name="l01084"></a>01084 <span class="keyword"></span>{
<a name="l01085"></a>01085   <span class="keywordflow">return</span> <span class="stringliteral">&quot;CentroidFill&quot;</span>;
<a name="l01086"></a>01086 }
<a name="l01087"></a>01087 
<a name="l01088"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a01e3f22046849c9102a1cc4b692b4e18">01088</a> <span class="keywordtype">void</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a01e3f22046849c9102a1cc4b692b4e18">QgsCentroidFillSymbolLayerV2::setColor</a>( <span class="keyword">const</span> QColor&amp; color )
<a name="l01089"></a>01089 {
<a name="l01090"></a>01090   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>-&gt;<a class="code" href="classQgsSymbolV2.html#aa2c7db61d4234bddf3aa62f294ad6818">setColor</a>( color );
<a name="l01091"></a>01091   <a class="code" href="classQgsSymbolLayerV2.html#a042b3eac41d39f58dd4b7d2126f646de">mColor</a> = <a class="code" href="classQgsSymbolLayerV2.html#a692837dc473ba2b206f8015aca8ec387">color</a>;
<a name="l01092"></a>01092 }
<a name="l01093"></a>01093 
<a name="l01094"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#acf05cb46fde26952789e25dd712f8f4b">01094</a> <span class="keywordtype">void</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#acf05cb46fde26952789e25dd712f8f4b">QgsCentroidFillSymbolLayerV2::startRender</a>( <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l01095"></a>01095 {
<a name="l01096"></a>01096   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>-&gt;<a class="code" href="classQgsSymbolV2.html#a63f3806411733b2d2b7f7f438e558f74" title="Set alpha transparency 1 for opaque, 0 for invisible.">setAlpha</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a29fa7f8394884b290db8cfa6c67a9434" title="Get alpha transparency 1 for opaque, 0 for invisible.">alpha</a>() );
<a name="l01097"></a>01097   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ab7507bfcdaeca7242bf502602e8ada2e">setOutputUnit</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#aed0197ecde31035db53569b1e8be838f">outputUnit</a>() );
<a name="l01098"></a>01098 
<a name="l01099"></a>01099   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ad21008f16311e5b103310c555085e795">startRender</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>() );
<a name="l01100"></a>01100 }
<a name="l01101"></a>01101 
<a name="l01102"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a3a83741f94911eeb36790568e53c6ddd">01102</a> <span class="keywordtype">void</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a3a83741f94911eeb36790568e53c6ddd">QgsCentroidFillSymbolLayerV2::stopRender</a>( <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l01103"></a>01103 {
<a name="l01104"></a>01104   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>-&gt;<a class="code" href="classQgsSymbolV2.html#ab70bbea2b61fb9e734766f265f6625df">stopRender</a>( context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>() );
<a name="l01105"></a>01105 }
<a name="l01106"></a>01106 
<a name="l01107"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a64f6a9859b8eaa0ea981aceff748dae4">01107</a> <span class="keywordtype">void</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a64f6a9859b8eaa0ea981aceff748dae4">QgsCentroidFillSymbolLayerV2::renderPolygon</a>( <span class="keyword">const</span> QPolygonF&amp; points, QList&lt;QPolygonF&gt;* rings, <a class="code" href="classQgsSymbolV2RenderContext.html">QgsSymbolV2RenderContext</a>&amp; context )
<a name="l01108"></a>01108 {
<a name="l01109"></a>01109   Q_UNUSED( rings );
<a name="l01110"></a>01110 
<a name="l01111"></a>01111   <span class="comment">// calculate centroid</span>
<a name="l01112"></a>01112   <span class="keywordtype">double</span> cx = 0, cy = 0;
<a name="l01113"></a>01113   <span class="keywordtype">double</span> area, sum = 0;
<a name="l01114"></a>01114   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = points.count() - 1, j = 0; j &lt; points.count(); i = j++ )
<a name="l01115"></a>01115   {
<a name="l01116"></a>01116     <span class="keyword">const</span> QPointF&amp; p1 = points[i];
<a name="l01117"></a>01117     <span class="keyword">const</span> QPointF&amp; p2 = points[j];
<a name="l01118"></a>01118     area = p1.x() * p2.y() - p1.y() * p2.x();
<a name="l01119"></a>01119     sum += area;
<a name="l01120"></a>01120     cx += ( p1.x() + p2.x() ) * area;
<a name="l01121"></a>01121     cy += ( p1.y() + p2.y() ) * area;
<a name="l01122"></a>01122   }
<a name="l01123"></a>01123   sum *= 3.0;
<a name="l01124"></a>01124   cx /= sum;
<a name="l01125"></a>01125   cy /= sum;
<a name="l01126"></a>01126 
<a name="l01127"></a>01127   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#a6237c61df96f213f9d2080de00dde17a">renderPoint</a>( QPointF( cx, cy ), context.<a class="code" href="classQgsSymbolV2RenderContext.html#aa1f340714f6dab713e7be50536dcf1f2">feature</a>(), context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7486624cf40ad812a12493a0cfb538e9">renderContext</a>(), -1, context.<a class="code" href="classQgsSymbolV2RenderContext.html#a7339b8275a3500e3812d470ea87f6c00">selected</a>() );
<a name="l01128"></a>01128 }
<a name="l01129"></a>01129 
<a name="l01130"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a9fcd1f3b0a57dac790c7a2ef7ce27eaf">01130</a> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a9fcd1f3b0a57dac790c7a2ef7ce27eaf">QgsCentroidFillSymbolLayerV2::properties</a>()<span class="keyword"> const</span>
<a name="l01131"></a>01131 <span class="keyword"></span>{
<a name="l01132"></a>01132   <span class="keywordflow">return</span> <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a>();
<a name="l01133"></a>01133 }
<a name="l01134"></a>01134 
<a name="l01135"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a82a2b2624b7df5dce3f43abaf4beb669">01135</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a82a2b2624b7df5dce3f43abaf4beb669">QgsCentroidFillSymbolLayerV2::clone</a>()<span class="keyword"> const</span>
<a name="l01136"></a>01136 <span class="keyword"></span>{
<a name="l01137"></a>01137   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html">QgsCentroidFillSymbolLayerV2</a>* x = <span class="keyword">new</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad5a0bddb2c2e11803fc23f57eb6a54d6">QgsCentroidFillSymbolLayerV2</a>();
<a name="l01138"></a>01138   x-&gt;<a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a38755ad7c30fb785c8b7eb0c834911a4">setSubSymbol</a>( <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>-&gt;<a class="code" href="classQgsMarkerSymbolV2.html#ad1afc202ea3e92c66cbc0210ef78a75e">clone</a>() );
<a name="l01139"></a>01139   <span class="keywordflow">return</span> x;
<a name="l01140"></a>01140 }
<a name="l01141"></a>01141 
<a name="l01142"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a4d8ce83a3fffc785e8d6bc7ef806d6cb">01142</a> <span class="keywordtype">void</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a4d8ce83a3fffc785e8d6bc7ef806d6cb">QgsCentroidFillSymbolLayerV2::toSld</a>( QDomDocument &amp;doc, QDomElement &amp;element, <a class="code" href="qgsrendererv2_8h.html#ab13d4e9821da606b92748097c691b9dd">QgsStringMap</a> props )<span class="keyword"> const</span>
<a name="l01143"></a>01143 <span class="keyword"></span>{
<a name="l01144"></a>01144   <span class="comment">// SLD 1.0 specs says: &quot;if a line, polygon, or raster geometry is</span>
<a name="l01145"></a>01145   <span class="comment">// used with PointSymbolizer, then the semantic is to use the centroid</span>
<a name="l01146"></a>01146   <span class="comment">// of the geometry, or any similar representative point.</span>
<a name="l01147"></a>01147   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>-&gt;<a class="code" href="classQgsSymbolV2.html#a741dab3198725463a65b8482d5bfea04">toSld</a>( doc, element, props );
<a name="l01148"></a>01148 }
<a name="l01149"></a>01149 
<a name="l01150"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#adffe9a842d30145027d9a8f0ea0ff1e1">01150</a> <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a>* <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#adffe9a842d30145027d9a8f0ea0ff1e1">QgsCentroidFillSymbolLayerV2::createFromSld</a>( QDomElement &amp;element )
<a name="l01151"></a>01151 {
<a name="l01152"></a>01152   <a class="code" href="qgslogger_8h.html#ab273942cfb1b76ef0a5dafe6ed64fe23">QgsDebugMsg</a>( <span class="stringliteral">&quot;Entered.&quot;</span> );
<a name="l01153"></a>01153 
<a name="l01154"></a>01154   <a class="code" href="classQgsSymbolLayerV2.html">QgsSymbolLayerV2</a> *l = <a class="code" href="classQgsSymbolLayerV2Utils.html#ae8056e47913c4d888ac7aa9952dee7c4">QgsSymbolLayerV2Utils::createMarkerLayerFromSld</a>( element );
<a name="l01155"></a>01155   <span class="keywordflow">if</span> ( !l )
<a name="l01156"></a>01156     <span class="keywordflow">return</span> NULL;
<a name="l01157"></a>01157 
<a name="l01158"></a>01158   <a class="code" href="qgssymbolv2_8h.html#abcf4e5696820a1c44827956f48787f1b">QgsSymbolLayerV2List</a> layers;
<a name="l01159"></a>01159   layers.append( l );
<a name="l01160"></a>01160   <a class="code" href="classQgsMarkerSymbolV2.html">QgsMarkerSymbolV2</a> *marker = <span class="keyword">new</span> <a class="code" href="classQgsMarkerSymbolV2.html">QgsMarkerSymbolV2</a>( layers );
<a name="l01161"></a>01161 
<a name="l01162"></a>01162   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html">QgsCentroidFillSymbolLayerV2</a>* x = <span class="keyword">new</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad5a0bddb2c2e11803fc23f57eb6a54d6">QgsCentroidFillSymbolLayerV2</a>();
<a name="l01163"></a>01163   x-&gt;<a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a38755ad7c30fb785c8b7eb0c834911a4">setSubSymbol</a>( marker );
<a name="l01164"></a>01164   <span class="keywordflow">return</span> x;
<a name="l01165"></a>01165 }
<a name="l01166"></a>01166 
<a name="l01167"></a>01167 
<a name="l01168"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a880ea647fae0d1b2bb7394403a8a5169">01168</a> <a class="code" href="classQgsSymbolV2.html">QgsSymbolV2</a>* <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a880ea647fae0d1b2bb7394403a8a5169">QgsCentroidFillSymbolLayerV2::subSymbol</a>()
<a name="l01169"></a>01169 {
<a name="l01170"></a>01170   <span class="keywordflow">return</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>;
<a name="l01171"></a>01171 }
<a name="l01172"></a>01172 
<a name="l01173"></a><a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a38755ad7c30fb785c8b7eb0c834911a4">01173</a> <span class="keywordtype">bool</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#a38755ad7c30fb785c8b7eb0c834911a4">QgsCentroidFillSymbolLayerV2::setSubSymbol</a>( <a class="code" href="classQgsSymbolV2.html">QgsSymbolV2</a>* symbol )
<a name="l01174"></a>01174 {
<a name="l01175"></a>01175   <span class="keywordflow">if</span> ( symbol == NULL || symbol-&gt;<a class="code" href="classQgsSymbolV2.html#aa582dfed1c81b5714a5e219d2612d171">type</a>() != <a class="code" href="classQgsSymbolV2.html#a5d1dc41b5e445d244383f02a237e95dda20de105177cc62462d5d9c9e4e63a791">QgsSymbolV2::Marker</a> )
<a name="l01176"></a>01176   {
<a name="l01177"></a>01177     <span class="keyword">delete</span> symbol;
<a name="l01178"></a>01178     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01179"></a>01179   }
<a name="l01180"></a>01180 
<a name="l01181"></a>01181   <span class="keyword">delete</span> <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>;
<a name="l01182"></a>01182   <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="classQgsMarkerSymbolV2.html">QgsMarkerSymbolV2</a>*<span class="keyword">&gt;</span>( symbol );
<a name="l01183"></a>01183   <a class="code" href="classQgsSymbolLayerV2.html#a042b3eac41d39f58dd4b7d2126f646de">mColor</a> = <a class="code" href="classQgsCentroidFillSymbolLayerV2.html#ad38d3198ff42ff9649fe088b6c7211bd">mMarker</a>-&gt;<a class="code" href="classQgsSymbolV2.html#a8709dd76e13ec842f71c452c318156d0">color</a>();
<a name="l01184"></a>01184   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01185"></a>01185 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 19 2012 23:22:41 for Quantum GIS API Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
