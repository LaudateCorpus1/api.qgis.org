<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Quantum GIS API Documentation: src/gui/qgsexpressionbuilderwidget.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Quantum GIS API Documentation
   &#160;<span id="projectnumber">1.8</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">src/gui/qgsexpressionbuilderwidget.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="qgsexpressionbuilderwidget_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">    qgisexpressionbuilderwidget.cpp - A genric expression string builder widget.</span>
<a name="l00003"></a>00003 <span class="comment">     --------------------------------------</span>
<a name="l00004"></a>00004 <span class="comment">    Date                 :  29-May-2011</span>
<a name="l00005"></a>00005 <span class="comment">    Copyright            : (C) 2011 by Nathan Woodrow</span>
<a name="l00006"></a>00006 <span class="comment">    Email                : woodrow.nathan at gmail dot com</span>
<a name="l00007"></a>00007 <span class="comment"> ***************************************************************************</span>
<a name="l00008"></a>00008 <span class="comment"> *                                                                         *</span>
<a name="l00009"></a>00009 <span class="comment"> *   This program is free software; you can redistribute it and/or modify  *</span>
<a name="l00010"></a>00010 <span class="comment"> *   it under the terms of the GNU General Public License as published by  *</span>
<a name="l00011"></a>00011 <span class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</span>
<a name="l00012"></a>00012 <span class="comment"> *   (at your option) any later version.                                   *</span>
<a name="l00013"></a>00013 <span class="comment"> *                                                                         *</span>
<a name="l00014"></a>00014 <span class="comment"> ***************************************************************************/</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="qgsexpressionbuilderwidget_8h.html">qgsexpressionbuilderwidget.h</a>&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;<a class="code" href="qgslogger_8h.html">qgslogger.h</a>&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="qgsexpression_8h.html">qgsexpression.h</a>&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="qgsmessageviewer_8h.html">qgsmessageviewer.h</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="qgsapplication_8h.html">qgsapplication.h</a>&quot;</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;QSettings&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;QMenu&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;QFile&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;QTextStream&gt;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a5e237b08d7f6c8ffd07a5797dc94a84a">00027</a> <a class="code" href="classQgsExpressionBuilderWidget.html#a5e237b08d7f6c8ffd07a5797dc94a84a">QgsExpressionBuilderWidget::QgsExpressionBuilderWidget</a>( QWidget *parent )
<a name="l00028"></a>00028     : QWidget( parent )
<a name="l00029"></a>00029 {
<a name="l00030"></a>00030   setupUi( <span class="keyword">this</span> );
<a name="l00031"></a>00031 
<a name="l00032"></a>00032   mValueGroupBox-&gt;hide();
<a name="l00033"></a>00033   <span class="comment">// The open and save button are for future.</span>
<a name="l00034"></a>00034   btnOpen-&gt;hide();
<a name="l00035"></a>00035   btnSave-&gt;hide();
<a name="l00036"></a>00036   <a class="code" href="classQgsExpressionBuilderWidget.html#aaf16cc54c383df2996f0783a6f008170">highlighter</a> = <span class="keyword">new</span> <a class="code" href="classQgsExpressionHighlighter.html">QgsExpressionHighlighter</a>( txtExpressionString-&gt;document() );
<a name="l00037"></a>00037 
<a name="l00038"></a>00038   <a class="code" href="classQgsExpressionBuilderWidget.html#a2c0e4e144b6b18e35a7564ad3b59f3e1">mModel</a> = <span class="keyword">new</span> QStandardItemModel( );
<a name="l00039"></a>00039   <a class="code" href="classQgsExpressionBuilderWidget.html#ae98fa0f8c02e3499fb347914371fd7bf">mProxyModel</a> = <span class="keyword">new</span> <a class="code" href="classQgsExpressionItemSearchProxy.html" title="Search proxy used to filter the QgsExpressionBuilderWidget tree.">QgsExpressionItemSearchProxy</a>();
<a name="l00040"></a>00040   <a class="code" href="classQgsExpressionBuilderWidget.html#ae98fa0f8c02e3499fb347914371fd7bf">mProxyModel</a>-&gt;setSourceModel( mModel );
<a name="l00041"></a>00041   expressionTree-&gt;setModel( <a class="code" href="classQgsExpressionBuilderWidget.html#ae98fa0f8c02e3499fb347914371fd7bf">mProxyModel</a> );
<a name="l00042"></a>00042 
<a name="l00043"></a>00043   expressionTree-&gt;setContextMenuPolicy( Qt::CustomContextMenu );
<a name="l00044"></a>00044   connect( <span class="keyword">this</span>, SIGNAL( <a class="code" href="classQgsExpressionBuilderWidget.html#a6dd6397f9f66e9c26a1c88258d8c5053" title="Emited when the user changes the expression in the widget.">expressionParsed</a>( <span class="keywordtype">bool</span> ) ), <span class="keyword">this</span>, SLOT( <a class="code" href="classQgsExpressionBuilderWidget.html#a26cd4d989e073e3f54fcd321a4e01081">setExpressionState</a>( <span class="keywordtype">bool</span> ) ) );
<a name="l00045"></a>00045   connect( expressionTree, SIGNAL( customContextMenuRequested( <span class="keyword">const</span> QPoint &amp; ) ), <span class="keyword">this</span>, SLOT( <a class="code" href="classQgsExpressionBuilderWidget.html#ac9f5cf10a8184c5a9d39191a6bb00a54">showContextMenu</a>( <span class="keyword">const</span> QPoint &amp; ) ) );
<a name="l00046"></a>00046   connect( expressionTree-&gt;selectionModel(), SIGNAL( <a class="code" href="classQgsExpressionBuilderWidget.html#a03dc1ccc093eacd052a969ca64181a7c">currentChanged</a>( <span class="keyword">const</span> QModelIndex &amp;, <span class="keyword">const</span> QModelIndex &amp; ) ),
<a name="l00047"></a>00047            <span class="keyword">this</span>, SLOT( <a class="code" href="classQgsExpressionBuilderWidget.html#a03dc1ccc093eacd052a969ca64181a7c">currentChanged</a>( <span class="keyword">const</span> QModelIndex &amp;, <span class="keyword">const</span> QModelIndex &amp; ) ) );
<a name="l00048"></a>00048 
<a name="l00049"></a>00049   <span class="keywordflow">foreach</span>( QPushButton* button, mOperatorsGroupBox-&gt;findChildren&lt;QPushButton *&gt;() )
<a name="l00050"></a>00050   {
<a name="l00051"></a>00051     connect( button, SIGNAL( pressed() ), <span class="keyword">this</span>, SLOT( <a class="code" href="classQgsExpressionBuilderWidget.html#aacd3891209856dc0a1caf9b92f967b98">operatorButtonClicked</a>() ) );
<a name="l00052"></a>00052   }
<a name="l00053"></a>00053 
<a name="l00054"></a>00054   <span class="comment">// TODO Can we move this stuff to QgsExpression, like the functions?</span>
<a name="l00055"></a>00055   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;+&quot;</span>, <span class="stringliteral">&quot; + &quot;</span> );
<a name="l00056"></a>00056   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;-&quot;</span>, <span class="stringliteral">&quot; -&quot;</span> );
<a name="l00057"></a>00057   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;*&quot;</span>, <span class="stringliteral">&quot; * &quot;</span> );
<a name="l00058"></a>00058   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot; / &quot;</span> );
<a name="l00059"></a>00059   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;%&quot;</span>, <span class="stringliteral">&quot; % &quot;</span> );
<a name="l00060"></a>00060   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;^&quot;</span>, <span class="stringliteral">&quot; ^ &quot;</span> );
<a name="l00061"></a>00061   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;=&quot;</span>, <span class="stringliteral">&quot; = &quot;</span> );
<a name="l00062"></a>00062   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;&gt;&quot;</span>, <span class="stringliteral">&quot; &gt; &quot;</span> );
<a name="l00063"></a>00063   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;&lt;&quot;</span>, <span class="stringliteral">&quot; &lt; &quot;</span> );
<a name="l00064"></a>00064   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;&lt;&gt;&quot;</span>, <span class="stringliteral">&quot; &lt;&gt; &quot;</span> );
<a name="l00065"></a>00065   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;&lt;=&quot;</span>, <span class="stringliteral">&quot; &lt;= &quot;</span> );
<a name="l00066"></a>00066   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;&gt;=&quot;</span>, <span class="stringliteral">&quot; &gt;= &quot;</span> );
<a name="l00067"></a>00067   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;||&quot;</span>, <span class="stringliteral">&quot; || &quot;</span>,
<a name="l00068"></a>00068                 QString( <span class="stringliteral">&quot;&lt;b&gt;|| %1&lt;/b&gt;&lt;br&gt;&lt;i&gt;%2&lt;/i&gt;&lt;br&gt;&lt;i&gt;%3:&lt;/i&gt;%4&quot;</span> )
<a name="l00069"></a>00069                 .arg( tr( <span class="stringliteral">&quot;(String Concatenation)&quot;</span> ) )
<a name="l00070"></a>00070                 .arg( tr( <span class="stringliteral">&quot;Joins two values together into a string&quot;</span> ) )
<a name="l00071"></a>00071                 .arg( tr( <span class="stringliteral">&quot;Usage&quot;</span> ) )
<a name="l00072"></a>00072                 .arg( tr( <span class="stringliteral">&quot;&#39;Dia&#39; || Diameter&quot;</span> ) ) );
<a name="l00073"></a>00073   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;LIKE&quot;</span>, <span class="stringliteral">&quot; LIKE &quot;</span> );
<a name="l00074"></a>00074   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;ILIKE&quot;</span>, <span class="stringliteral">&quot; ILIKE &quot;</span> );
<a name="l00075"></a>00075   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;IS&quot;</span>, <span class="stringliteral">&quot; IS NOT &quot;</span> );
<a name="l00076"></a>00076   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;OR&quot;</span>, <span class="stringliteral">&quot; OR &quot;</span> );
<a name="l00077"></a>00077   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;AND&quot;</span>, <span class="stringliteral">&quot; AND &quot;</span> );
<a name="l00078"></a>00078   <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Operators&quot;</span> ), <span class="stringliteral">&quot;NOT&quot;</span>, <span class="stringliteral">&quot; NOT &quot;</span> );
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 
<a name="l00081"></a>00081   <span class="comment">// Load the functions from the QgsExpression class</span>
<a name="l00082"></a>00082   <span class="keywordtype">int</span> count = <a class="code" href="classQgsExpression.html#a290e46c4bfcb4af3ab0ac944cdf927a2" title="Returns the number of functions defined in the parser.">QgsExpression::functionCount</a>();
<a name="l00083"></a>00083   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; count; i++ )
<a name="l00084"></a>00084   {
<a name="l00085"></a>00085     <a class="code" href="structQgsExpression_1_1FunctionDef.html">QgsExpression::FunctionDef</a> func = <a class="code" href="classQgsExpression.html#a9884a8648fb0386790521c439271d009">QgsExpression::BuiltinFunctions</a>()[i];
<a name="l00086"></a>00086     QString name = func.<a class="code" href="structQgsExpression_1_1FunctionDef.html#ab51cecaeba8153755c1247d2cc46aa31" title="The name of the function.">mName</a>;
<a name="l00087"></a>00087     <span class="keywordflow">if</span> ( func.<a class="code" href="structQgsExpression_1_1FunctionDef.html#ad47610e848dc3d9dd98a0480c7dea0a3" title="The number of parameters this function takes.">mParams</a> &gt;= 1 )
<a name="l00088"></a>00088       name += <span class="stringliteral">&quot;(&quot;</span>;
<a name="l00089"></a>00089     <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( func.<a class="code" href="structQgsExpression_1_1FunctionDef.html#ab5e979bfa740fd476aab74380150820c" title="The group the function belongs to.">mGroup</a>, func.<a class="code" href="structQgsExpression_1_1FunctionDef.html#ab51cecaeba8153755c1247d2cc46aa31" title="The name of the function.">mName</a>, <span class="stringliteral">&quot; &quot;</span> + name + <span class="stringliteral">&quot; &quot;</span> );
<a name="l00090"></a>00090   };
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="classQgsExpressionBuilderWidget.html#aa5c7ac6890a11bb9afe4a52867a2b72c">00094</a> <a class="code" href="classQgsExpressionBuilderWidget.html#aa5c7ac6890a11bb9afe4a52867a2b72c">QgsExpressionBuilderWidget::~QgsExpressionBuilderWidget</a>()
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 }
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="classQgsExpressionBuilderWidget.html#ad8545f46b8b8c9c5d3d3b9163c9b4b1c">00099</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#ad8545f46b8b8c9c5d3d3b9163c9b4b1c" title="Sets layer in order to get the fields and values.">QgsExpressionBuilderWidget::setLayer</a>( <a class="code" href="classQgsVectorLayer.html" title="Vector layer backed by a data source provider.">QgsVectorLayer</a> *layer )
<a name="l00100"></a>00100 {
<a name="l00101"></a>00101   <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a> = layer;
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a03dc1ccc093eacd052a969ca64181a7c">00104</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a03dc1ccc093eacd052a969ca64181a7c">QgsExpressionBuilderWidget::currentChanged</a>( <span class="keyword">const</span> QModelIndex &amp;index, <span class="keyword">const</span> QModelIndex &amp; )
<a name="l00105"></a>00105 {
<a name="l00106"></a>00106   <span class="comment">// Get the item</span>
<a name="l00107"></a>00107   QModelIndex idx = <a class="code" href="classQgsExpressionBuilderWidget.html#ae98fa0f8c02e3499fb347914371fd7bf">mProxyModel</a>-&gt;mapToSource( index );
<a name="l00108"></a>00108   <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>* item = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>*<span class="keyword">&gt;</span>( <a class="code" href="classQgsExpressionBuilderWidget.html#a2c0e4e144b6b18e35a7564ad3b59f3e1">mModel</a>-&gt;itemFromIndex( idx ) );
<a name="l00109"></a>00109   <span class="keywordflow">if</span> ( item == 0 )
<a name="l00110"></a>00110     <span class="keywordflow">return</span>;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112   <span class="comment">// Loading field values are handled with a</span>
<a name="l00113"></a>00113   <span class="comment">// right click so we just show the help.</span>
<a name="l00114"></a>00114   <span class="keywordflow">if</span> ( item-&gt;<a class="code" href="classQgsExpressionItem.html#a006072deea0407e1f29bbba649c56582" title="Get the type of expression item eg header, field, ExpressionNode.">getItemType</a>() != <a class="code" href="classQgsExpressionItem.html#aeee688fef288ad8707828f9aa18dc176a6c782b5176b599eb0dcb358071bc76e4">QgsExpressionItem::Field</a> )
<a name="l00115"></a>00115   {
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     mValueGroupBox-&gt;hide();
<a name="l00118"></a>00118     mValueListWidget-&gt;clear();
<a name="l00119"></a>00119   }
<a name="l00120"></a>00120   <span class="comment">// Show the help for the current item.</span>
<a name="l00121"></a>00121   QString help = <a class="code" href="classQgsExpressionBuilderWidget.html#a208bf12630f12ee9a39cd6d100a4527c">loadFunctionHelp</a>( item );
<a name="l00122"></a>00122   txtHelpText-&gt;setText( help );
<a name="l00123"></a>00123   txtHelpText-&gt;setToolTip( txtHelpText-&gt;toPlainText() );
<a name="l00124"></a>00124 }
<a name="l00125"></a>00125 
<a name="l00126"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a51c45a5d5dab53a17ca317eab278ac3d">00126</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a51c45a5d5dab53a17ca317eab278ac3d">QgsExpressionBuilderWidget::on_expressionTree_doubleClicked</a>( <span class="keyword">const</span> QModelIndex &amp;index )
<a name="l00127"></a>00127 {
<a name="l00128"></a>00128   QModelIndex idx = <a class="code" href="classQgsExpressionBuilderWidget.html#ae98fa0f8c02e3499fb347914371fd7bf">mProxyModel</a>-&gt;mapToSource( index );
<a name="l00129"></a>00129   <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>* item = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>*<span class="keyword">&gt;</span>( <a class="code" href="classQgsExpressionBuilderWidget.html#a2c0e4e144b6b18e35a7564ad3b59f3e1">mModel</a>-&gt;itemFromIndex( idx ) );
<a name="l00130"></a>00130   <span class="keywordflow">if</span> ( item == 0 )
<a name="l00131"></a>00131     <span class="keywordflow">return</span>;
<a name="l00132"></a>00132 
<a name="l00133"></a>00133   <span class="comment">// Don&#39;t handle the double click it we are on a header node.</span>
<a name="l00134"></a>00134   <span class="keywordflow">if</span> ( item-&gt;<a class="code" href="classQgsExpressionItem.html#a006072deea0407e1f29bbba649c56582" title="Get the type of expression item eg header, field, ExpressionNode.">getItemType</a>() == <a class="code" href="classQgsExpressionItem.html#aeee688fef288ad8707828f9aa18dc176a6faca05f7fe1b6cb1e9da62d4340d37d">QgsExpressionItem::Header</a> )
<a name="l00135"></a>00135     <span class="keywordflow">return</span>;
<a name="l00136"></a>00136 
<a name="l00137"></a>00137   <span class="comment">// Insert the expression text.</span>
<a name="l00138"></a>00138   txtExpressionString-&gt;insertPlainText( item-&gt;<a class="code" href="classQgsExpressionItem.html#a3f560e9b173996b0db33281976250fc2">getExpressionText</a>() );
<a name="l00139"></a>00139 }
<a name="l00140"></a>00140 
<a name="l00141"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a3c1e3720692e5d26406d0259d686c448">00141</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a3c1e3720692e5d26406d0259d686c448" title="Loads all the field names from the layer.">QgsExpressionBuilderWidget::loadFieldNames</a>()
<a name="l00142"></a>00142 {
<a name="l00143"></a>00143   <span class="comment">// TODO We should really return a error the user of the widget that</span>
<a name="l00144"></a>00144   <span class="comment">// the there is no layer set.</span>
<a name="l00145"></a>00145   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a> )
<a name="l00146"></a>00146     <span class="keywordflow">return</span>;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148   <span class="keyword">const</span> <a class="code" href="qgsfield_8h.html#aacd5afec301c03ed9499abb2bad2554b">QgsFieldMap</a> fieldMap = <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a>-&gt;<a class="code" href="classQgsVectorLayer.html#ad7fab6c5b64e1657edafadc11d64b13f" title="returns field list in the to-be-committed state">pendingFields</a>();
<a name="l00149"></a>00149   <a class="code" href="classQgsExpressionBuilderWidget.html#a3c1e3720692e5d26406d0259d686c448" title="Loads all the field names from the layer.">loadFieldNames</a>( fieldMap );
<a name="l00150"></a>00150 }
<a name="l00151"></a>00151 
<a name="l00152"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a7d0b0d912f9fcc80e9ec1ec52bfad3a8">00152</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a3c1e3720692e5d26406d0259d686c448" title="Loads all the field names from the layer.">QgsExpressionBuilderWidget::loadFieldNames</a>( <a class="code" href="qgsfield_8h.html#aacd5afec301c03ed9499abb2bad2554b">QgsFieldMap</a> fields )
<a name="l00153"></a>00153 {
<a name="l00154"></a>00154   <span class="keywordflow">if</span> ( fields.isEmpty() )
<a name="l00155"></a>00155     <span class="keywordflow">return</span>;
<a name="l00156"></a>00156 
<a name="l00157"></a>00157   QStringList fieldNames;
<a name="l00158"></a>00158   <span class="keywordflow">foreach</span>( <a class="code" href="classQgsField.html" title="Encapsulate a field in an attribute table or data source.">QgsField</a> field, fields )
<a name="l00159"></a>00159   {
<a name="l00160"></a>00160     QString fieldName = field.<a class="code" href="classQgsField.html#a2dcacb700d636742d4f12a211622113b" title="Gets the name of the field.">name</a>();
<a name="l00161"></a>00161     fieldNames &lt;&lt; fieldName;
<a name="l00162"></a>00162     <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">registerItem</a>( tr( <span class="stringliteral">&quot;Fields and Values&quot;</span> ), fieldName, <span class="stringliteral">&quot; \&quot;&quot;</span> + fieldName + <span class="stringliteral">&quot;\&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="classQgsExpressionItem.html#aeee688fef288ad8707828f9aa18dc176a6c782b5176b599eb0dcb358071bc76e4">QgsExpressionItem::Field</a> );
<a name="l00163"></a>00163   }
<a name="l00164"></a>00164   <a class="code" href="classQgsExpressionBuilderWidget.html#aaf16cc54c383df2996f0783a6f008170">highlighter</a>-&gt;<a class="code" href="classQgsExpressionHighlighter.html#ae23ad09b8339abcfd0a383c91de4296e">addFields</a>( fieldNames );
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a><a class="code" href="classQgsExpressionBuilderWidget.html#aa5c2be49803b2da8fe7a2e29e0a3857a">00167</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#aa5c2be49803b2da8fe7a2e29e0a3857a">QgsExpressionBuilderWidget::fillFieldValues</a>( <span class="keywordtype">int</span> fieldIndex, <span class="keywordtype">int</span> countLimit )
<a name="l00168"></a>00168 {
<a name="l00169"></a>00169   <span class="comment">// TODO We should really return a error the user of the widget that</span>
<a name="l00170"></a>00170   <span class="comment">// the there is no layer set.</span>
<a name="l00171"></a>00171   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a> )
<a name="l00172"></a>00172     <span class="keywordflow">return</span>;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174   <span class="comment">// TODO We should thread this so that we don&#39;t hold the user up if the layer is massive.</span>
<a name="l00175"></a>00175   mValueListWidget-&gt;clear();
<a name="l00176"></a>00176   mValueListWidget-&gt;setUpdatesEnabled( <span class="keyword">false</span> );
<a name="l00177"></a>00177   mValueListWidget-&gt;blockSignals( <span class="keyword">true</span> );
<a name="l00178"></a>00178 
<a name="l00179"></a>00179   QList&lt;QVariant&gt; values;
<a name="l00180"></a>00180   <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a>-&gt;<a class="code" href="classQgsVectorLayer.html#a78af08bb3cb4b927f52ee40a8534e880" title="Returns unique values for column.">uniqueValues</a>( fieldIndex, values, countLimit );
<a name="l00181"></a>00181   <span class="keywordflow">foreach</span>( QVariant value, values )
<a name="l00182"></a>00182   {
<a name="l00183"></a>00183     <span class="keywordflow">if</span> ( value.isNull() )
<a name="l00184"></a>00184       mValueListWidget-&gt;addItem( <span class="stringliteral">&quot;NULL&quot;</span> );
<a name="l00185"></a>00185     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( value.type() == QVariant::Int || value.type() == QVariant::Double || value.type() == QVariant::LongLong )
<a name="l00186"></a>00186       mValueListWidget-&gt;addItem( value.toString() );
<a name="l00187"></a>00187     <span class="keywordflow">else</span>
<a name="l00188"></a>00188       mValueListWidget-&gt;addItem( <span class="stringliteral">&quot;&#39;&quot;</span> + value.toString().replace( <span class="stringliteral">&quot;&#39;&quot;</span>, <span class="stringliteral">&quot;&#39;&#39;&quot;</span> ) + <span class="stringliteral">&quot;&#39;&quot;</span> );
<a name="l00189"></a>00189   }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191   mValueListWidget-&gt;setUpdatesEnabled( <span class="keyword">true</span> );
<a name="l00192"></a>00192   mValueListWidget-&gt;blockSignals( <span class="keyword">false</span> );
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00195"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069">00195</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a33e31ccdf85d7d6b32f4b0072fd0a069" title="Registers a node item for the expression builder.">QgsExpressionBuilderWidget::registerItem</a>( QString group,
<a name="l00196"></a>00196     QString label,
<a name="l00197"></a>00197     QString expressionText,
<a name="l00198"></a>00198     QString helpText,
<a name="l00199"></a>00199     <a class="code" href="classQgsExpressionItem.html#aeee688fef288ad8707828f9aa18dc176">QgsExpressionItem::ItemType</a> type )
<a name="l00200"></a>00200 {
<a name="l00201"></a>00201   <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>* item = <span class="keyword">new</span> <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>( label, expressionText, helpText, type );
<a name="l00202"></a>00202   <span class="comment">// Look up the group and insert the new function.</span>
<a name="l00203"></a>00203   <span class="keywordflow">if</span> ( <a class="code" href="classQgsExpressionBuilderWidget.html#a451017d68f261dc693965c65f17fd49f">mExpressionGroups</a>.contains( group ) )
<a name="l00204"></a>00204   {
<a name="l00205"></a>00205     <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>* groupNode = <a class="code" href="classQgsExpressionBuilderWidget.html#a451017d68f261dc693965c65f17fd49f">mExpressionGroups</a>.value( group );
<a name="l00206"></a>00206     groupNode-&gt;appendRow( item );
<a name="l00207"></a>00207   }
<a name="l00208"></a>00208   <span class="keywordflow">else</span>
<a name="l00209"></a>00209   {
<a name="l00210"></a>00210     <span class="comment">// If the group doesn&#39;t exist yet we make it first.</span>
<a name="l00211"></a>00211     <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>* newgroupNode = <span class="keyword">new</span> <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>( group, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="classQgsExpressionItem.html#aeee688fef288ad8707828f9aa18dc176a6faca05f7fe1b6cb1e9da62d4340d37d">QgsExpressionItem::Header</a> );
<a name="l00212"></a>00212     newgroupNode-&gt;appendRow( item );
<a name="l00213"></a>00213     <a class="code" href="classQgsExpressionBuilderWidget.html#a2c0e4e144b6b18e35a7564ad3b59f3e1">mModel</a>-&gt;appendRow( newgroupNode );
<a name="l00214"></a>00214     <a class="code" href="classQgsExpressionBuilderWidget.html#a451017d68f261dc693965c65f17fd49f">mExpressionGroups</a>.insert( group , newgroupNode );
<a name="l00215"></a>00215   }
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a462f675962ade79626cb195657a69c1e">00218</a> <span class="keywordtype">bool</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a462f675962ade79626cb195657a69c1e">QgsExpressionBuilderWidget::isExpressionValid</a>()
<a name="l00219"></a>00219 {
<a name="l00220"></a>00220   <span class="keywordflow">return</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a28c45fcf3c4651c0d7ff61b75a939afe">mExpressionValid</a>;
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a1a42cdbb6631050a9843345e14475e47">00223</a> QString <a class="code" href="classQgsExpressionBuilderWidget.html#a1a42cdbb6631050a9843345e14475e47" title="Gets the expression string that has been set in the expression area.">QgsExpressionBuilderWidget::expressionText</a>()
<a name="l00224"></a>00224 {
<a name="l00225"></a>00225   <span class="keywordflow">return</span> txtExpressionString-&gt;toPlainText();
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 
<a name="l00228"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a46a7269dbef8ca09801635aa7103406c">00228</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a46a7269dbef8ca09801635aa7103406c" title="Sets the expression string for the widget.">QgsExpressionBuilderWidget::setExpressionText</a>( <span class="keyword">const</span> QString&amp; expression )
<a name="l00229"></a>00229 {
<a name="l00230"></a>00230   txtExpressionString-&gt;setPlainText( expression );
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00233"></a><a class="code" href="classQgsExpressionBuilderWidget.html#ab188559a7fcc617f105148152aa49b85">00233</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#ab188559a7fcc617f105148152aa49b85">QgsExpressionBuilderWidget::on_txtExpressionString_textChanged</a>()
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235   QString text = txtExpressionString-&gt;toPlainText();
<a name="l00236"></a>00236 
<a name="l00237"></a>00237   <span class="comment">// If the string is empty the expression will still &quot;fail&quot; although</span>
<a name="l00238"></a>00238   <span class="comment">// we don&#39;t show the user an error as it will be confusing.</span>
<a name="l00239"></a>00239   <span class="keywordflow">if</span> ( text.isEmpty() )
<a name="l00240"></a>00240   {
<a name="l00241"></a>00241     lblPreview-&gt;setText( <span class="stringliteral">&quot;&quot;</span> );
<a name="l00242"></a>00242     lblPreview-&gt;setStyleSheet( <span class="stringliteral">&quot;&quot;</span> );
<a name="l00243"></a>00243     txtExpressionString-&gt;setToolTip( <span class="stringliteral">&quot;&quot;</span> );
<a name="l00244"></a>00244     lblPreview-&gt;setToolTip( <span class="stringliteral">&quot;&quot;</span> );
<a name="l00245"></a>00245     emit <a class="code" href="classQgsExpressionBuilderWidget.html#a6dd6397f9f66e9c26a1c88258d8c5053" title="Emited when the user changes the expression in the widget.">expressionParsed</a>( <span class="keyword">false</span> );
<a name="l00246"></a>00246     <span class="keywordflow">return</span>;
<a name="l00247"></a>00247   }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249   <a class="code" href="classQgsExpression.html" title="Class for parsing and evaluation of expressions (formerly called &quot;search strings&quot;).">QgsExpression</a> exp( text );
<a name="l00250"></a>00250 
<a name="l00251"></a>00251   <span class="comment">// TODO We could do this without a layer.</span>
<a name="l00252"></a>00252   <span class="comment">// Maybe just calling exp.evaluate()?</span>
<a name="l00253"></a>00253   <span class="keywordflow">if</span> ( <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a> )
<a name="l00254"></a>00254   {
<a name="l00255"></a>00255     <span class="keywordflow">if</span> ( !<a class="code" href="classQgsExpressionBuilderWidget.html#ab15e74624f5b4c0f3bb370be6997f44f">mFeature</a>.<a class="code" href="classQgsFeature.html#adb079cb8d0e5f57fcc8242a293ad2af6" title="Return the validity of this feature.">isValid</a>() )
<a name="l00256"></a>00256     {
<a name="l00257"></a>00257       <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a>-&gt;<a class="code" href="classQgsVectorLayer.html#aceacc5e071f1d1764dacc0b7fffbba05" title="Select features found within the search rectangle (in layer&#39;s coordinates)">select</a>( <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a>-&gt;<a class="code" href="classQgsVectorLayer.html#a34a108c859c2b36e1db810e44e66d3ee" title="returns list of attributes">pendingAllAttributesList</a>(), <a class="code" href="classQgsRectangle.html" title="A rectangle specified with double values.">QgsRectangle</a>(), <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a>-&gt;<a class="code" href="classQgsVectorLayer.html#a0c6711ef5b047f27f99c4463d5390e59" title="Returns point, line or polygon.">geometryType</a>() != <a class="code" href="classQGis.html#a09947eb19394302eeeed44d3e81dd74ba7459e7b46aff1e6c346b5aa6c22ad3ff">QGis::NoGeometry</a> &amp;&amp; exp.<a class="code" href="classQgsExpression.html#a457ea260f8f9a79f2b6db67b9e9fd17e" title="Returns true if the expression uses feature geometry for some computation.">needsGeometry</a>() );
<a name="l00258"></a>00258       <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a>-&gt;<a class="code" href="classQgsVectorLayer.html#a084f8ed91fb514b7424617f08ce3bd86" title="fetch a feature (after select)">nextFeature</a>( <a class="code" href="classQgsExpressionBuilderWidget.html#ab15e74624f5b4c0f3bb370be6997f44f">mFeature</a> );
<a name="l00259"></a>00259     }
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <span class="keywordflow">if</span> ( <a class="code" href="classQgsExpressionBuilderWidget.html#ab15e74624f5b4c0f3bb370be6997f44f">mFeature</a>.<a class="code" href="classQgsFeature.html#adb079cb8d0e5f57fcc8242a293ad2af6" title="Return the validity of this feature.">isValid</a>() )
<a name="l00262"></a>00262     {
<a name="l00263"></a>00263       QVariant value = exp.<a class="code" href="classQgsExpression.html#a3aa14b9feb0eb42e4a6e48739681e0b1" title="Evaluate the feature and return the result.">evaluate</a>( &amp;<a class="code" href="classQgsExpressionBuilderWidget.html#ab15e74624f5b4c0f3bb370be6997f44f">mFeature</a>, <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a>-&gt;<a class="code" href="classQgsVectorLayer.html#ad7fab6c5b64e1657edafadc11d64b13f" title="returns field list in the to-be-committed state">pendingFields</a>() );
<a name="l00264"></a>00264       <span class="keywordflow">if</span> ( !exp.<a class="code" href="classQgsExpression.html#a82a80f9777e587047a2b3cb4a04b1435" title="Returns true if an error occurred when evaluating last input.">hasEvalError</a>() )
<a name="l00265"></a>00265         lblPreview-&gt;setText( value.toString() );
<a name="l00266"></a>00266     }
<a name="l00267"></a>00267     <span class="keywordflow">else</span>
<a name="l00268"></a>00268     {
<a name="l00269"></a>00269       <span class="comment">// The feature is invalid because we don&#39;t have one but that doesn&#39;t mean user can&#39;t</span>
<a name="l00270"></a>00270       <span class="comment">// build a expression string.  They just get no preview.</span>
<a name="l00271"></a>00271       lblPreview-&gt;setText( <span class="stringliteral">&quot;&quot;</span> );
<a name="l00272"></a>00272     }
<a name="l00273"></a>00273   }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275   <span class="keywordflow">if</span> ( exp.<a class="code" href="classQgsExpression.html#a81e6963c6083a622817b7df453ca44fc" title="Returns true if an error occurred when parsing the input expression.">hasParserError</a>() || exp.<a class="code" href="classQgsExpression.html#a82a80f9777e587047a2b3cb4a04b1435" title="Returns true if an error occurred when evaluating last input.">hasEvalError</a>() )
<a name="l00276"></a>00276   {
<a name="l00277"></a>00277     QString tooltip = QString( <span class="stringliteral">&quot;&lt;b&gt;%1:&lt;/b&gt;&lt;br&gt;%2&quot;</span> ).arg( tr( <span class="stringliteral">&quot;Parser Error&quot;</span> ) ).arg( exp.<a class="code" href="classQgsExpression.html#a5c7c937d778db1cc1c829601f6e878a0" title="Returns parser error.">parserErrorString</a>() );
<a name="l00278"></a>00278     <span class="keywordflow">if</span> ( exp.<a class="code" href="classQgsExpression.html#a82a80f9777e587047a2b3cb4a04b1435" title="Returns true if an error occurred when evaluating last input.">hasEvalError</a>() )
<a name="l00279"></a>00279       tooltip += QString( <span class="stringliteral">&quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;%1:&lt;/b&gt;&lt;br&gt;%2&quot;</span> ).arg( tr( <span class="stringliteral">&quot;Eval Error&quot;</span> ) ).arg( exp.<a class="code" href="classQgsExpression.html#a5852a785d6a231a2ee380dc7a747e960" title="Returns evaluation error.">evalErrorString</a>() );
<a name="l00280"></a>00280 
<a name="l00281"></a>00281     lblPreview-&gt;setText( tr( <span class="stringliteral">&quot;Expression is invalid &lt;a href=&quot;</span><span class="stringliteral">&quot;more&quot;</span><span class="stringliteral">&quot;&gt;(more info)&lt;/a&gt;&quot;</span> ) );
<a name="l00282"></a>00282     lblPreview-&gt;setStyleSheet( <span class="stringliteral">&quot;color: rgba(255, 6, 10,  255);&quot;</span> );
<a name="l00283"></a>00283     txtExpressionString-&gt;setToolTip( tooltip );
<a name="l00284"></a>00284     lblPreview-&gt;setToolTip( tooltip );
<a name="l00285"></a>00285     emit <a class="code" href="classQgsExpressionBuilderWidget.html#a6dd6397f9f66e9c26a1c88258d8c5053" title="Emited when the user changes the expression in the widget.">expressionParsed</a>( <span class="keyword">false</span> );
<a name="l00286"></a>00286     <span class="keywordflow">return</span>;
<a name="l00287"></a>00287   }
<a name="l00288"></a>00288   <span class="keywordflow">else</span>
<a name="l00289"></a>00289   {
<a name="l00290"></a>00290     lblPreview-&gt;setStyleSheet( <span class="stringliteral">&quot;&quot;</span> );
<a name="l00291"></a>00291     txtExpressionString-&gt;setToolTip( <span class="stringliteral">&quot;&quot;</span> );
<a name="l00292"></a>00292     lblPreview-&gt;setToolTip( <span class="stringliteral">&quot;&quot;</span> );
<a name="l00293"></a>00293     emit <a class="code" href="classQgsExpressionBuilderWidget.html#a6dd6397f9f66e9c26a1c88258d8c5053" title="Emited when the user changes the expression in the widget.">expressionParsed</a>( <span class="keyword">true</span> );
<a name="l00294"></a>00294   }
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00297"></a><a class="code" href="classQgsExpressionBuilderWidget.html#acd53c6e3c52c4c501e94936288777aed">00297</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#acd53c6e3c52c4c501e94936288777aed">QgsExpressionBuilderWidget::on_txtSearchEdit_textChanged</a>()
<a name="l00298"></a>00298 {
<a name="l00299"></a>00299   <a class="code" href="classQgsExpressionBuilderWidget.html#ae98fa0f8c02e3499fb347914371fd7bf">mProxyModel</a>-&gt;setFilterWildcard( txtSearchEdit-&gt;text() );
<a name="l00300"></a>00300   <span class="keywordflow">if</span> ( txtSearchEdit-&gt;text().isEmpty() )
<a name="l00301"></a>00301     expressionTree-&gt;collapseAll();
<a name="l00302"></a>00302   <span class="keywordflow">else</span>
<a name="l00303"></a>00303     expressionTree-&gt;expandAll();
<a name="l00304"></a>00304 }
<a name="l00305"></a>00305 
<a name="l00306"></a><a class="code" href="classQgsExpressionBuilderWidget.html#aca21197fccfa1e9fc8f1ab4781904827">00306</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#aca21197fccfa1e9fc8f1ab4781904827">QgsExpressionBuilderWidget::on_lblPreview_linkActivated</a>( QString link )
<a name="l00307"></a>00307 {
<a name="l00308"></a>00308   Q_UNUSED( link );
<a name="l00309"></a>00309   <a class="code" href="classQgsMessageViewer.html" title="A generic message view for displaying QGIS messages.">QgsMessageViewer</a> * mv = <span class="keyword">new</span> <a class="code" href="classQgsMessageViewer.html" title="A generic message view for displaying QGIS messages.">QgsMessageViewer</a>( <span class="keyword">this</span> );
<a name="l00310"></a>00310   mv-&gt;setWindowTitle( tr( <span class="stringliteral">&quot;More info on expression error&quot;</span> ) );
<a name="l00311"></a>00311   mv-&gt;<a class="code" href="classQgsMessageViewer.html#a6d438eb7b960550dd8f059bd170a5ede">setMessageAsHtml</a>( txtExpressionString-&gt;toolTip() );
<a name="l00312"></a>00312   mv-&gt;exec();
<a name="l00313"></a>00313 }
<a name="l00314"></a>00314 
<a name="l00315"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a28f3dec2374832a3db0b7c24f56841cd">00315</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a28f3dec2374832a3db0b7c24f56841cd">QgsExpressionBuilderWidget::on_mValueListWidget_itemDoubleClicked</a>( QListWidgetItem *item )
<a name="l00316"></a>00316 {
<a name="l00317"></a>00317   txtExpressionString-&gt;insertPlainText( <span class="stringliteral">&quot; &quot;</span> + item-&gt;text() + <span class="stringliteral">&quot; &quot;</span> );
<a name="l00318"></a>00318 }
<a name="l00319"></a>00319 
<a name="l00320"></a><a class="code" href="classQgsExpressionBuilderWidget.html#aacd3891209856dc0a1caf9b92f967b98">00320</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#aacd3891209856dc0a1caf9b92f967b98">QgsExpressionBuilderWidget::operatorButtonClicked</a>()
<a name="l00321"></a>00321 {
<a name="l00322"></a>00322   QPushButton* button = <span class="keyword">dynamic_cast&lt;</span>QPushButton*<span class="keyword">&gt;</span>( sender() );
<a name="l00323"></a>00323   txtExpressionString-&gt;insertPlainText( <span class="stringliteral">&quot; &quot;</span> + button-&gt;text() + <span class="stringliteral">&quot; &quot;</span> );
<a name="l00324"></a>00324 }
<a name="l00325"></a>00325 
<a name="l00326"></a><a class="code" href="classQgsExpressionBuilderWidget.html#ac9f5cf10a8184c5a9d39191a6bb00a54">00326</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#ac9f5cf10a8184c5a9d39191a6bb00a54">QgsExpressionBuilderWidget::showContextMenu</a>( <span class="keyword">const</span> QPoint &amp; pt )
<a name="l00327"></a>00327 {
<a name="l00328"></a>00328   QModelIndex idx = expressionTree-&gt;indexAt( pt );
<a name="l00329"></a>00329   idx = <a class="code" href="classQgsExpressionBuilderWidget.html#ae98fa0f8c02e3499fb347914371fd7bf">mProxyModel</a>-&gt;mapToSource( idx );
<a name="l00330"></a>00330   <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>* item = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>*<span class="keyword">&gt;</span>( <a class="code" href="classQgsExpressionBuilderWidget.html#a2c0e4e144b6b18e35a7564ad3b59f3e1">mModel</a>-&gt;itemFromIndex( idx ) );
<a name="l00331"></a>00331   <span class="keywordflow">if</span> ( !item )
<a name="l00332"></a>00332     <span class="keywordflow">return</span>;
<a name="l00333"></a>00333 
<a name="l00334"></a>00334   <span class="keywordflow">if</span> ( item-&gt;<a class="code" href="classQgsExpressionItem.html#a006072deea0407e1f29bbba649c56582" title="Get the type of expression item eg header, field, ExpressionNode.">getItemType</a>() == <a class="code" href="classQgsExpressionItem.html#aeee688fef288ad8707828f9aa18dc176a6c782b5176b599eb0dcb358071bc76e4">QgsExpressionItem::Field</a> )
<a name="l00335"></a>00335   {
<a name="l00336"></a>00336     QMenu* menu = <span class="keyword">new</span> QMenu( <span class="keyword">this</span> );
<a name="l00337"></a>00337     menu-&gt;addAction( tr( <span class="stringliteral">&quot;Load top 10 unique values&quot;</span> ), <span class="keyword">this</span>, SLOT( <a class="code" href="classQgsExpressionBuilderWidget.html#a10a9c1038cece65b0ddf90a0a45f1813">loadSampleValues</a>() ) );
<a name="l00338"></a>00338     menu-&gt;addAction( tr( <span class="stringliteral">&quot;Load all unique values&quot;</span> ), <span class="keyword">this</span>, SLOT( <a class="code" href="classQgsExpressionBuilderWidget.html#ad97a065e1c5407367f3b84b83234701e">loadAllValues</a>() ) );
<a name="l00339"></a>00339     menu-&gt;popup( expressionTree-&gt;mapToGlobal( pt ) );
<a name="l00340"></a>00340   }
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 
<a name="l00343"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a10a9c1038cece65b0ddf90a0a45f1813">00343</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a10a9c1038cece65b0ddf90a0a45f1813">QgsExpressionBuilderWidget::loadSampleValues</a>()
<a name="l00344"></a>00344 {
<a name="l00345"></a>00345   QModelIndex idx = <a class="code" href="classQgsExpressionBuilderWidget.html#ae98fa0f8c02e3499fb347914371fd7bf">mProxyModel</a>-&gt;mapToSource( expressionTree-&gt;currentIndex() );
<a name="l00346"></a>00346   <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>* item = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>*<span class="keyword">&gt;</span>( <a class="code" href="classQgsExpressionBuilderWidget.html#a2c0e4e144b6b18e35a7564ad3b59f3e1">mModel</a>-&gt;itemFromIndex( idx ) );
<a name="l00347"></a>00347   <span class="comment">// TODO We should really return a error the user of the widget that</span>
<a name="l00348"></a>00348   <span class="comment">// the there is no layer set.</span>
<a name="l00349"></a>00349   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a> )
<a name="l00350"></a>00350     <span class="keywordflow">return</span>;
<a name="l00351"></a>00351 
<a name="l00352"></a>00352   mValueGroupBox-&gt;show();
<a name="l00353"></a>00353   <span class="keywordtype">int</span> fieldIndex = <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a>-&gt;<a class="code" href="classQgsVectorLayer.html#a59ce270a9e6a773c5bf1ee47c841d078" title="Returns the index of a field name or -1 if the field does not exist.">fieldNameIndex</a>( item-&gt;text() );
<a name="l00354"></a>00354   <a class="code" href="classQgsExpressionBuilderWidget.html#aa5c2be49803b2da8fe7a2e29e0a3857a">fillFieldValues</a>( fieldIndex, 10 );
<a name="l00355"></a>00355 }
<a name="l00356"></a>00356 
<a name="l00357"></a><a class="code" href="classQgsExpressionBuilderWidget.html#ad97a065e1c5407367f3b84b83234701e">00357</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#ad97a065e1c5407367f3b84b83234701e">QgsExpressionBuilderWidget::loadAllValues</a>()
<a name="l00358"></a>00358 {
<a name="l00359"></a>00359   QModelIndex idx = <a class="code" href="classQgsExpressionBuilderWidget.html#ae98fa0f8c02e3499fb347914371fd7bf">mProxyModel</a>-&gt;mapToSource( expressionTree-&gt;currentIndex() );
<a name="l00360"></a>00360   <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>* item = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>*<span class="keyword">&gt;</span>( <a class="code" href="classQgsExpressionBuilderWidget.html#a2c0e4e144b6b18e35a7564ad3b59f3e1">mModel</a>-&gt;itemFromIndex( idx ) );
<a name="l00361"></a>00361   <span class="comment">// TODO We should really return a error the user of the widget that</span>
<a name="l00362"></a>00362   <span class="comment">// the there is no layer set.</span>
<a name="l00363"></a>00363   <span class="keywordflow">if</span> ( !<a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a> )
<a name="l00364"></a>00364     <span class="keywordflow">return</span>;
<a name="l00365"></a>00365 
<a name="l00366"></a>00366   mValueGroupBox-&gt;show();
<a name="l00367"></a>00367   <span class="keywordtype">int</span> fieldIndex = <a class="code" href="classQgsExpressionBuilderWidget.html#ae84cb1f4d6981b830bce1b9a214cbfc5">mLayer</a>-&gt;<a class="code" href="classQgsVectorLayer.html#a59ce270a9e6a773c5bf1ee47c841d078" title="Returns the index of a field name or -1 if the field does not exist.">fieldNameIndex</a>( item-&gt;text() );
<a name="l00368"></a>00368   <a class="code" href="classQgsExpressionBuilderWidget.html#aa5c2be49803b2da8fe7a2e29e0a3857a">fillFieldValues</a>( fieldIndex, -1 );
<a name="l00369"></a>00369 }
<a name="l00370"></a>00370 
<a name="l00371"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a26cd4d989e073e3f54fcd321a4e01081">00371</a> <span class="keywordtype">void</span> <a class="code" href="classQgsExpressionBuilderWidget.html#a26cd4d989e073e3f54fcd321a4e01081">QgsExpressionBuilderWidget::setExpressionState</a>( <span class="keywordtype">bool</span> state )
<a name="l00372"></a>00372 {
<a name="l00373"></a>00373   <a class="code" href="classQgsExpressionBuilderWidget.html#a28c45fcf3c4651c0d7ff61b75a939afe">mExpressionValid</a> = state;
<a name="l00374"></a>00374 }
<a name="l00375"></a>00375 
<a name="l00376"></a><a class="code" href="classQgsExpressionBuilderWidget.html#a208bf12630f12ee9a39cd6d100a4527c">00376</a> QString <a class="code" href="classQgsExpressionBuilderWidget.html#a208bf12630f12ee9a39cd6d100a4527c">QgsExpressionBuilderWidget::loadFunctionHelp</a>( <a class="code" href="classQgsExpressionItem.html" title="An expression item that can be used in the QgsExpressionBuilderWidget tree.">QgsExpressionItem</a>* functionName )
<a name="l00377"></a>00377 {
<a name="l00378"></a>00378   <span class="keywordflow">if</span> ( functionName == NULL )
<a name="l00379"></a>00379     <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00380"></a>00380 
<a name="l00381"></a>00381   <span class="comment">// set up the path to the help file</span>
<a name="l00382"></a>00382   QString helpFilesPath = <a class="code" href="classQgsApplication.html#ae8ee73fb4f3e9d0b8a4e9b450814a2e1" title="Returns the common root path of all application data directories.">QgsApplication::pkgDataPath</a>() + <span class="stringliteral">&quot;/resources/function_help/&quot;</span>;
<a name="l00383"></a>00383   <span class="comment">/*</span>
<a name="l00384"></a>00384 <span class="comment">   * determine the locale and create the file name from</span>
<a name="l00385"></a>00385 <span class="comment">   * the context id</span>
<a name="l00386"></a>00386 <span class="comment">   */</span>
<a name="l00387"></a>00387   QString lang = QLocale::system().name();
<a name="l00388"></a>00388 
<a name="l00389"></a>00389   QSettings settings;
<a name="l00390"></a>00390   <span class="keywordflow">if</span> ( settings.value( <span class="stringliteral">&quot;locale/overrideFlag&quot;</span>, <span class="keyword">false</span> ).toBool() )
<a name="l00391"></a>00391   {
<a name="l00392"></a>00392     QLocale l( settings.value( <span class="stringliteral">&quot;locale/userLocale&quot;</span>, <span class="stringliteral">&quot;en_US&quot;</span> ).toString() );
<a name="l00393"></a>00393     lang = l.name();
<a name="l00394"></a>00394   }
<a name="l00395"></a>00395   <span class="comment">/*</span>
<a name="l00396"></a>00396 <span class="comment">   * If the language isn&#39;t set on the system, assume en_US,</span>
<a name="l00397"></a>00397 <span class="comment">   * otherwise we get the banner at the top of the help file</span>
<a name="l00398"></a>00398 <span class="comment">   * saying it isn&#39;t available in &quot;your&quot; language. Some systems</span>
<a name="l00399"></a>00399 <span class="comment">   * may be installed without the LANG environment being set.</span>
<a name="l00400"></a>00400 <span class="comment">   */</span>
<a name="l00401"></a>00401   <span class="keywordflow">if</span> ( lang.length() == 0 || lang == <span class="stringliteral">&quot;C&quot;</span> || lang.startsWith( <span class="stringliteral">&quot;en_&quot;</span> ) )
<a name="l00402"></a>00402   {
<a name="l00403"></a>00403     lang = <span class="stringliteral">&quot;en_US&quot;</span>;
<a name="l00404"></a>00404   }
<a name="l00405"></a>00405 
<a name="l00406"></a>00406   QString name = functionName-&gt;text();
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   <span class="keywordflow">if</span> ( functionName-&gt;<a class="code" href="classQgsExpressionItem.html#a006072deea0407e1f29bbba649c56582" title="Get the type of expression item eg header, field, ExpressionNode.">getItemType</a>() == <a class="code" href="classQgsExpressionItem.html#aeee688fef288ad8707828f9aa18dc176a6c782b5176b599eb0dcb358071bc76e4">QgsExpressionItem::Field</a> )
<a name="l00409"></a>00409     name = <span class="stringliteral">&quot;Field&quot;</span>;
<a name="l00410"></a>00410 
<a name="l00411"></a>00411   QString fullHelpPath = helpFilesPath + name + <span class="stringliteral">&quot;-&quot;</span> + lang;
<a name="l00412"></a>00412   <span class="comment">// get the help content and title from the localized file</span>
<a name="l00413"></a>00413   QString helpContents;
<a name="l00414"></a>00414   QFile <a class="code" href="qgssvgcache_8cpp.html#a0e09ef09634c9ff8c49d989b80771a34">file</a>( fullHelpPath );
<a name="l00415"></a>00415 
<a name="l00416"></a>00416   QString missingError = tr( <span class="stringliteral">&quot;&lt;h3&gt;Oops! QGIS can&#39;t find help for this function.&lt;/h3&gt;&quot;</span>
<a name="l00417"></a>00417                              <span class="stringliteral">&quot;The help file for %1 was not found.&lt;br&gt;&quot;</span>
<a name="l00418"></a>00418                            ).arg( Qt::escape( name ) );
<a name="l00419"></a>00419 
<a name="l00420"></a>00420   <span class="keywordflow">if</span> ( !lang.startsWith( <span class="stringliteral">&quot;en_&quot;</span> ) )
<a name="l00421"></a>00421   {
<a name="l00422"></a>00422     <span class="comment">// try en_US version if localized version is unavailable</span>
<a name="l00423"></a>00423     <span class="keywordflow">if</span> ( !file.exists() )
<a name="l00424"></a>00424     {
<a name="l00425"></a>00425       helpContents = tr( <span class="stringliteral">&quot;(Showing English version as there was no help available in your language (%1). If you would like to create it, contact the QGIS translation team).&lt;br&gt;&quot;</span> ).arg( lang );
<a name="l00426"></a>00426 
<a name="l00427"></a>00427       missingError += tr( <span class="stringliteral">&quot;It was neither available in your language (%1) nor English.&quot;</span> ).arg( lang );
<a name="l00428"></a>00428 
<a name="l00429"></a>00429       <span class="comment">// try en_US next</span>
<a name="l00430"></a>00430       fullHelpPath = helpFilesPath + functionName-&gt;text() + <span class="stringliteral">&quot;-en_US&quot;</span>;
<a name="l00431"></a>00431       file.setFileName( fullHelpPath );
<a name="l00432"></a>00432     }
<a name="l00433"></a>00433   }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435   missingError += tr( <span class="stringliteral">&quot;&lt;br&gt;If you would like to create it, contact the QGIS development team.&quot;</span> );
<a name="l00436"></a>00436 
<a name="l00437"></a>00437   <span class="keywordflow">if</span> ( !file.open( QIODevice::ReadOnly | QIODevice::Text ) )
<a name="l00438"></a>00438   {
<a name="l00439"></a>00439     helpContents = missingError;
<a name="l00440"></a>00440   }
<a name="l00441"></a>00441   <span class="keywordflow">else</span>
<a name="l00442"></a>00442   {
<a name="l00443"></a>00443     QTextStream in( &amp;file );
<a name="l00444"></a>00444     in.setCodec( <span class="stringliteral">&quot;UTF-8&quot;</span> ); <span class="comment">// Help files must be in Utf-8</span>
<a name="l00445"></a>00445     <span class="keywordflow">while</span> ( !in.atEnd() )
<a name="l00446"></a>00446     {
<a name="l00447"></a>00447       QString line = in.readLine();
<a name="l00448"></a>00448       helpContents += line;
<a name="l00449"></a>00449     }
<a name="l00450"></a>00450   }
<a name="l00451"></a>00451 
<a name="l00452"></a>00452   file.close();
<a name="l00453"></a>00453 
<a name="l00454"></a>00454   <span class="comment">// Set the browser text to the help contents</span>
<a name="l00455"></a>00455   QString myStyle = <a class="code" href="classQgsApplication.html#a068414fb0e585e9203446adc03167e7b" title="get a standard css style sheet for reports.">QgsApplication::reportStyleSheet</a>();
<a name="l00456"></a>00456   helpContents = <span class="stringliteral">&quot;&lt;head&gt;&lt;style&gt;&quot;</span> + myStyle + <span class="stringliteral">&quot;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&quot;</span> + helpContents + <span class="stringliteral">&quot;&lt;/body&gt;&quot;</span>;
<a name="l00457"></a>00457   <span class="keywordflow">return</span> helpContents;
<a name="l00458"></a>00458 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 19 2012 23:22:42 for Quantum GIS API Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
